##############################################################################
#                                                                            #
# IAR 8051 C-Compiler V5.20A/386                                             #
# Front End V4.20N                                       19/Sep/104  17:59:49 #
# Global Optimizer V1.04E                                                    #
#                                                                            #
#       Target option =  8051                                                #
#       Memory model  =  large                                               #
#       Source file   =  phoneans.c                                          #
#       List file     =  release\list\phoneans.lst                           #
#       Object file   =  release\obj\phoneans.r03                            #
#       Command line  =  PhoneAns.c -S -ml -v0 -e -K -u -s9 -RHIGHCODE -gA   #
#                        -IC:\IAR\EW\8051\inc\ -ORelease\Obj\                #
#                        -LRelease\List\ -q -i -t8 -x                        #
#                                                                            #
#                                             (c) Copyright IAR Systems 1996 #
##############################################################################

   \   0000                    NAME    phoneans(18)
   \   0000                    RSEG    HIGHCODE(0)
   \   0000                    RSEG    CSTR(0)
   \   0000                    RSEG    X_UDATA(0)
   \   0000                    PUBLIC  AskQuestionMsg
   \   0000                    $DEFFN  AskQuestionMsg(0,0,7,0,32768,0,0,0),SetupUpQLabels,PlayFile,StartTimer,
   \   0000                            DecodeReceivedDTMF,GotoLabel,LogMessage,GotoLabel,LogMessage,GotoLabel,
   \   0000                            LogMessage,GotoLabel,LogMessage,GotoLabel,LogMessage,GotoLabel,LogMessage,
   \   0000                            GotoLabel,LogMessage,GotoLabel,LogMessage,GotoLabel,LogMessage,GotoLabel,
   \   0000                            LogMessage,GotoLabel,LogMessage,GotoLabel,LogMessage,GotoLabel,LogMessage,
   \   0000                            GotoLabel,TimedOut,SendStringEOLRS232,GotoLabel,KillTimer
   \   0000                    EXTERN  BuildCallerList
   \   0000                    $DEFFN  BuildCallerList(32768,0,0,0)
   \   0000                    PUBLIC  CategoryHit
   \   0000                    $DEFFN  CategoryHit(0,0,17,0,32768,0,4,0),myStr2Int,myStr2Int,myStr2Int
   \   0000                    EXTERN  ClearDisp
   \   0000                    $DEFFN  ClearDisp(32768,0,0,0)
   \   0000                    PUBLIC  CorrectDate
   \   0000                    $DEFFN  CorrectDate(0,0,1,0,32768,0,1,0)
   \   0000                    EXTERN  CreateDateString2
   \   0000                    $DEFFN  CreateDateString2(32768,0,6,0)
   \   0000                    EXTERN  CreateLog
   \   0000                    $DEFFN  CreateLog(32768,0,0,0)
   \   0000                    PUBLIC  CreateMemoFileName
   \   0000                    $DEFFN  CreateMemoFileName(0,0,10,0,32768,0,5,0),myInt2DecStr,myStrCpy
   \   0000                    EXTERN  CreateTimeString
   \   0000                    $DEFFN  CreateTimeString(32768,0,6,0)
   \   0000                    PUBLIC  CreateUniqueFilename
   \   0000                    $DEFFN  CreateUniqueFilename(0,0,14,0,32768,0,3,0),GetTimeNow,GetDateNow,
   \   0000                            fopen,fclose
   \   0000                    EXTERN  DecodeReceivedDTMF
   \   0000                    $DEFFN  DecodeReceivedDTMF(32768,0,0,0)
   \   0000                    EXTERN  DispEraseQuest
   \   0000                    $DEFFN  DispEraseQuest(32768,0,0,0)
   \   0000                    EXTERN  DispInfoBox
   \   0000                    $DEFFN  DispInfoBox(32768,0,6,0)
   \   0000                    EXTERN  DispMemUsage
   \   0000                    $DEFFN  DispMemUsage(32768,0,0,0)
   \   0000                    EXTERN  DispMemoScreen
   \   0000                    $DEFFN  DispMemoScreen(32768,0,0,0)
   \   0000                    EXTERN  DispOptionsMenu
   \   0000                    $DEFFN  DispOptionsMenu(32768,0,2,0)
   \   0000                    EXTERN  DispSetTimeDate
   \   0000                    $DEFFN  DispSetTimeDate(32768,0,6,0)
   \   0000                    EXTERN  DispSetTimeDateHead
   \   0000                    $DEFFN  DispSetTimeDateHead(32768,0,0,0)
   \   0000                    EXTERN  DisplayMenu
   \   0000                    $DEFFN  DisplayMenu(32768,0,3,0)
   \   0000                    PUBLIC  EnterCode
   \   0000                    $DEFFN  EnterCode(0,0,29,0,32768,0,0,0),SetupUpQLabels,PlayFile,ResetDTMFIndex,
   \   0000                            StartTimer,DecodeReceivedDTMF,SendRS232,TimedOut,GetNextDTMF,myStrCmpNoCase,
   \   0000                            GotoLabel,LogMessage,GotoLabel,LogMessage,GotoLabel,GotoLabel,LogMessage,
   \   0000                            GotoLabel,KillTimer
   \   0000                    EXTERN  EraseDynamic
   \   0000                    $DEFFN  EraseDynamic(32768,0,0,0)
   \   0000                    EXTERN  FillDispBuffer
   \   0000                    $DEFFN  FillDispBuffer(32768,0,0,0)
   \   0000                    EXTERN  GetDateNow
   \   0000                    $DEFFN  GetDateNow(32768,0,3,0)
   \   0000                    EXTERN  GetNextDTMF
   \   0000                    $DEFFN  GetNextDTMF(32768,0,0,0)
   \   0000                    EXTERN  GetTimeNow
   \   0000                    $DEFFN  GetTimeNow(32768,0,3,0)
   \   0000                    EXTERN  GotoLabel
   \   0000                    $DEFFN  GotoLabel(32768,0,3,0)
   \   0000                    PUBLIC  InitializePhoneAns
   \   0000                    $DEFFN  InitializePhoneAns(0,0,2,0,32768,0,0,0),ReadPhoneBookFile
   \   0000                    PUBLIC  IntitializeMemo
   \   0000                    $DEFFN  IntitializeMemo(0,0,21,0,32768,0,0,0),CreateMemoFileName,fopen,
   \   0000                            fclose
   \   0000                    EXTERN  KeyboardOn
   \   0000                    $DEFFN  KeyboardOn(32768,0,0,0)
   \   0000                    EXTERN  KillTimer
   \   0000                    $DEFFN  KillTimer(32768,0,1,0)
   \   0000                    PUBLIC  LabelCopy
   \   0000                    $DEFFN  LabelCopy(0,0,1,0,32768,0,6,0)
   \   0000                    EXTERN  LogCursorAt
   \   0000                    $DEFFN  LogCursorAt(32768,0,3,0)
   \   0000                    EXTERN  LogMessage
   \   0000                    $DEFFN  LogMessage(32768,0,6,0)
   \   0000                    PUBLIC  LookUpCaller
   \   0000                    $DEFFN  LookUpCaller(0,9,2,0,32768,0,9,0)
   \   0000                    EXTERN  OptionCursorAt
   \   0000                    $DEFFN  OptionCursorAt(32768,0,2,0)
   \   0000                    PUBLIC  PBSpace
   \   0000                    EXTERN  PhoneInVolume
   \   0000                    $DEFFN  PhoneInVolume(32768,0,1,0)
   \   0000                    EXTERN  PlayFile
   \   0000                    $DEFFN  PlayFile(32768,0,3,0)
   \   0000                    PUBLIC  PlayMemo
   \   0000                    $DEFFN  PlayMemo(0,0,17,0,32768,0,0,0),CreateMemoFileName,DispInfoBox,
   \   0000                            SpeakerVolume,PhoneInVolume,PlayFile,SpeakerVolume,PhoneInVolume
   \   0000                    EXTERN  PlayNewMessages
   \   0000                    $DEFFN  PlayNewMessages(32768,0,0,0)
   \   0000                    EXTERN  PlayThisCall
   \   0000                    $DEFFN  PlayThisCall(32768,0,2,0)
   \   0000                    EXTERN  ReadCalenderByte
   \   0000                    $DEFFN  ReadCalenderByte(32768,0,4,0)
   \   0000                    PUBLIC  ReadPhoneBookFile
   \   0000                    $DEFFN  ReadPhoneBookFile(0,0,12,0,32768,0,0,0),SendStringEOLRS232,DispInfoBox,
   \   0000                            fopen,fgetc,fgetc,fgetc,fclose
   \   0000                    EXTERN  RecMicFile
   \   0000                    $DEFFN  RecMicFile(32768,0,3,0)
   \   0000                    EXTERN  RecPhoneFile
   \   0000                    $DEFFN  RecPhoneFile(32768,0,3,0)
   \   0000                    PUBLIC  RecordCallerMessage
   \   0000                    $DEFFN  RecordCallerMessage(0,0,17,0,32768,0,0,0),SetupUpQLabels,CreateUniqueFilename,
   \   0000                            RecPhoneFile,LogMessage,WriteCalenderByte,LogMessage,GotoLabel,GotoLabel
   \   0000                    PUBLIC  RecordMemo
   \   0000                    $DEFFN  RecordMemo(0,0,17,0,32768,0,0,0),CreateMemoFileName,DispInfoBox,
   \   0000                            DisplayMenu,SpeakerVolume,PhoneInVolume,PlayFile,SpeakerVolume,PhoneInVolume,
   \   0000                            RecMicFile
   \   0000                    EXTERN  ResetDTMFIndex
   \   0000                    $DEFFN  ResetDTMFIndex(32768,0,0,0)
   \   0000                    EXTERN  SendRS232
   \   0000                    $DEFFN  SendRS232(32768,0,1,0)
   \   0000                    EXTERN  SendStringEOLRS232
   \   0000                    $DEFFN  SendStringEOLRS232(32768,0,3,0)
   \   0000                    PUBLIC  SetupUpQLabels
   \   0000                    $DEFFN  SetupUpQLabels(0,0,6,0,32768,0,0,0),LabelCopy,LabelCopy,LabelCopy,
   \   0000                            LabelCopy,LabelCopy,LabelCopy,LabelCopy,LabelCopy,LabelCopy,LabelCopy,
   \   0000                            LabelCopy,LabelCopy,LabelCopy,LabelCopy,LabelCopy,LabelCopy,LabelCopy,
   \   0000                            myStr2Int
   \   0000                    EXTERN  SpeakerVolume
   \   0000                    $DEFFN  SpeakerVolume(32768,0,1,0)
   \   0000                    EXTERN  StartTimer
   \   0000                    $DEFFN  StartTimer(32768,0,2,0)
   \   0000                    EXTERN  TimedOut
   \   0000                    $DEFFN  TimedOut(32768,0,1,0)
   \   0000                    PUBLIC  WaitForCall
   \   0000                    $DEFFN  WaitForCall(0,0,75,0,32768,0,0,0),PhoneInVolume,SendStringEOLRS232,
   \   0000                            ClearDisp,DispInfoBox,BuildCallerList,ReadCalenderByte,ReadCalenderByte,
   \   0000                            WriteCalenderByte,WriteCalenderByte,WriteCalenderByte,CreateLog,SetupUpQLabels,
   \   0000                            KeyboardOn,ReadCalenderByte,ReadCalenderByte,ReadCalenderByte,SendStringEOLRS232,
   \   0000                            ClearDisp,FillDispBuffer,LogCursorAt,DispMemUsage,DisplayMenu,ResetDTMFIndex,
   \   0000                            PlayThisCall,ResetDTMFIndex,LogCursorAt,LogCursorAt,LogCursorAt,DispOptionsMenu,
   \   0000                            OptionCursorAt,DisplayMenu,PlayNewMessages,WriteCalenderByte,WriteCalenderByte,
   \   0000                            WriteCalenderByte,ResetDTMFIndex,FillDispBuffer,LogCursorAt,DisplayMenu,
   \   0000                            DisplayMenu,OptionCursorAt,WriteCalenderByte,DispOptionsMenu,OptionCursorAt,
   \   0000                            DispMemoScreen,DisplayMenu,GetDateNow,GetTimeNow,DispSetTimeDateHead,
   \   0000                            DisplayMenu,DispSetTimeDate,WriteCalenderByte,DispOptionsMenu,OptionCursorAt,
   \   0000                            DispEraseQuest,WriteCalenderByte,DispOptionsMenu,OptionCursorAt,WriteCalenderByte,
   \   0000                            WriteCalenderByte,DispOptionsMenu,OptionCursorAt,LogCursorAt,DisplayMenu,
   \   0000                            DispSetTimeDate,CorrectDate,DispSetTimeDate,CorrectDate,DispSetTimeDate,
   \   0000                            CorrectDate,DispSetTimeDate,DispSetTimeDate,DispSetTimeDate,CorrectDate,
   \   0000                            DispSetTimeDate,CorrectDate,DispSetTimeDate,CorrectDate,DispSetTimeDate,
   \   0000                            DispSetTimeDate,DispSetTimeDate,WriteCalenderByte,WriteCalenderByte,
   \   0000                            WriteCalenderByte,WriteCalenderByte,WriteCalenderByte,WriteCalenderByte,
   \   0000                            DispOptionsMenu,OptionCursorAt,DisplayMenu,DispOptionsMenu,OptionCursorAt,
   \   0000                            DisplayMenu,DispInfoBox,EraseDynamic,WriteCalenderByte,WriteCalenderByte,
   \   0000                            fopen,fclose,DispOptionsMenu,OptionCursorAt,DisplayMenu,CreateLog,DispInfoBox,
   \   0000                            BuildCallerList,ReadCalenderByte,ReadCalenderByte,ClearDisp,FillDispBuffer,
   \   0000                            LogCursorAt,DispMemUsage,DisplayMenu,DispOptionsMenu,OptionCursorAt,
   \   0000                            DisplayMenu,DispOptionsMenu,OptionCursorAt,DisplayMenu,PlayMemo,DispMemoScreen,
   \   0000                            DisplayMenu,RecordMemo,DispMemoScreen,DispMemUsage,DisplayMenu,DispOptionsMenu,
   \   0000                            OptionCursorAt,DisplayMenu,StartTimer,DecodeReceivedDTMF,TimedOut,KillTimer,
   \   0000                            GetNextDTMF,LookUpCaller,GetDateNow,CreateDateString2,GetTimeNow,CreateTimeString,
   \   0000                            ReadCalenderByte,WriteCalenderByte,DispInfoBox,WaitForRingSignals,LogMessage,
   \   0000                            LogMessage,LogMessage,GotoLabel,GotoLabel
   \   0000                    EXTERN  WaitForRingSignals
   \   0000                    $DEFFN  WaitForRingSignals(32768,0,2,0)
   \   0000                    EXTERN  WriteCalenderByte
   \   0000                    $DEFFN  WriteCalenderByte(32768,0,2,0)
   \   0000                    EXTERN  abort
   \   0000                    $DEFFN  abort(32768,0,0,0)
   \   0000                    PUBLIC  answerOn
   \   0000                    EXTERN  callIndex
   \   0000                    PUBLIC  callerCategory
   \   0000                    PUBLIC  callerName
   \   0000                    EXTERN  commandLine
   \   0000                    PUBLIC  cursor
   \   0000                    PUBLIC  date
   \   0000                    PUBLIC  dateNow
   \   0000                    EXTERN  error
   \   0000                    EXTERN  fclose
   \   0000                    $DEFFN  fclose(32768,0,3,0)
   \   0000                    EXTERN  fgetc
   \   0000                    $DEFFN  fgetc(32768,0,3,0)
   \   0000                    EXTERN  fopen
   \   0000                    $DEFFN  fopen(32768,0,6,0)
   \   0000                    PUBLIC  hour
   \   0000                    PUBLIC  lab0
   \   0000                    PUBLIC  lab1
   \   0000                    PUBLIC  lab2
   \   0000                    PUBLIC  lab3
   \   0000                    PUBLIC  lab4
   \   0000                    PUBLIC  lab5
   \   0000                    PUBLIC  lab6
   \   0000                    PUBLIC  lab7
   \   0000                    PUBLIC  lab8
   \   0000                    PUBLIC  lab9
   \   0000                    PUBLIC  labCorrectc
   \   0000                    PUBLIC  labDTMF
   \   0000                    PUBLIC  labHungUp
   \   0000                    PUBLIC  labIncorrectc
   \   0000                    PUBLIC  labPound
   \   0000                    PUBLIC  labStar
   \   0000                    PUBLIC  labTimeout
   \   0000                    EXTERN  lastKey
   \   0000                    PUBLIC  lastPlayed
   \   0000                    EXTERN  logOffset
   \   0000                    PUBLIC  menuSelection
   \   0000                    PUBLIC  minute
   \   0000                    PUBLIC  month
   \   0000                    EXTERN  msg
   \   0000                    EXTERN  myInt2DecStr
   \   0000                    $DEFFN  myInt2DecStr(32768,0,5,0)
   \   0000                    EXTERN  myStr2Int
   \   0000                    $DEFFN  myStr2Int(32768,0,3,0)
   \   0000                    EXTERN  myStrCmpNoCase
   \   0000                    $DEFFN  myStrCmpNoCase(32768,0,6,0)
   \   0000                    EXTERN  myStrCpy
   \   0000                    $DEFFN  myStrCpy(32768,0,6,0)
   \   0000                    PUBLIC  nextMemoIndex
   \   0000                    EXTERN  nrCommandParameters
   \   0000                    PUBLIC  numOfCalls
   \   0000                    PUBLIC  numSignals
   \   0000                    PUBLIC  pbNEntries
   \   0000                    EXTERN  receivedDTMF
   \   0000                    EXTERN  speakerVolume
   \   0000                    EXTERN  terminateAnswer
   \   0000                    PUBLIC  timCur
   \   0000                    PUBLIC  timeNow
   \   0000                    PUBLIC  timeoutValue
   \   0000                    PUBLIC  year
   \   0000                    EXTERN  ?BYTE_COPY_L08
   \   0000                    EXTERN  ?LD_A_R567_L17
   \   0000                    EXTERN  ?ST_A_R123_L17
   \   0000                    EXTERN  ?ST_A_R567_L17
   \   0000                    EXTERN  ?LD_A_R567_DISP_L17
   \   0000                    EXTERN  ?ST_A_R567_DISP_L17
   \   0000                    EXTERN  ?A_S_SWITCH_L05
   \   0000                    EXTERN  ?PINC1_R567_TO_R123_L20
   \   0000                    EXTERN  ?CL8051L_5_20_L17
   \   0000                    RSEG    HIGHCODE
      1          /*************************************************************
      2          Fil:            $Id: PhoneAns.c,v 1.10 2003/12/26 16:17:01 Gemensam Exp $
      3          
      4          Beskrivning:    Innehåller telefonsvararfunktioner
      5          
      6          Skapad:         00-02-06
      7          
      8          Ändrad:         $Date: 2003/12/26 16:17:01 $
      9          
     10          Ägare:          Fredrik Hoffman
     11          
     12          
     13          Att göra:
     14          
     15          Revisionshistoria:
     16                                          $Log: PhoneAns.c,v $
     17                                          Revision 1.10  2003/12/26 16:17:01  Gemensam
     18                                          Reinstate 500 ms wait for hang up detection to settle (if not PPD is used).
     19                                          Fixed PPD detection by decreasing phone volume from 63 to 15.
     20                                          Version 0304.
     21                                          
     22                                          Revision 1.9  2003/11/29 22:36:55  Gemensam
     23                                          Fixed problem with to short pulse width on PPD.
     24                                          Ver 0302.
     25                                          
     26                                          Revision 1.8  2003/11/23 21:40:03  Gemensam
     27                                          Parallell phone detection included.
     28                                          Removed obsolete #define's regarding LCD interface.
     29                                          Ver 0300
     30                                          
     31                                          Revision 1.7  2003/11/23 20:29:34  Gemensam
     32                                          Complete and tested volume setting in options menu.
     33                                          Ver 0201
     34                                          
     35                                          Revision 1.6  2003/11/20 22:08:53  Gemensam
     36                                          Various declarations changes.
     37                                          Still version 0200.
     38                                          
     39                                          Revision 1.5  2003/11/18 19:17:35  Gemensam
     40                                          Added menu option of setting speaker volume (untested)
     41                                          Completely changed header files
     42                                          Version 0200.
     43                                          
     44                                          Revision 1.4  2003/11/13 22:35:44  Gemensam
     45                                          Added watchdog reset at GotoLabel, FindLabel and InsertLabel.
     46                                          Added global variable to contain speaker volume, Default volume set to 50.
     47                                          Version 1.1
     48                                          
     49                                          Revision 1.3  2003/11/13 19:35:37  Gemensam
     50                                          Closed PB-file after initial read.
     51                                          
     52                                          Revision 1.2  2003/11/10 22:44:45  Gemensam
     53                                          Added header information
     54                                          
     55          
     56          *************************************************************/
     57          
     58          //////////////////////
     59          // Inkluderingar
     60          
     61          #include <io517a.h>
      1          /*                     - IO517A.H -
      2          
      3             Special header for the Siemens SAB 80C517A/83C517A-5 processors.
      4          
      5             Version 5.20 [IMAF]
      6          
      7          */
      8          
      9          #pragma language=extended
     10          
     11          /* Pre-defined SFR byte addresses: */
     12          
     13          /* CPU */
     14          sfr     ACC    = 0xE0;
     15          sfr     B      = 0xF0;
     16          sfr     SP     = 0x81;
     17          sfr     DPL    = 0x82;
     18          sfr     DPH    = 0x83;
     19          sfr     DPSEL  = 0x92;
     20          sfr     PSW    = 0xD0;
     21          sfr     XPAGE  = 0x91;
     22          sfr     SYSCON = 0xB1;
     23          
     24          /* Timer 0/Timer 1 */
     25          sfr     TCON   = 0x88;
     26          sfr     TMOD   = 0x89;
     27          sfr     TL0    = 0x8A;
     28          sfr     TL1    = 0x8B;
     29          sfr     TH0    = 0x8C;
     30          sfr     TH1    = 0x8D;
     31          
     32          /* CCU */
     33          sfr     CCEN   = 0xC1;
     34          sfr     CC4EN  = 0xC9;
     35          sfr     CCL1   = 0xC2;
     36          sfr     CCH1   = 0xC3;
     37          sfr     CCL2   = 0xC4;
     38          sfr     CCH2   = 0xC5;
     39          sfr     CCL3   = 0xC6;
     40          sfr     CCH3   = 0xC7;
     41          sfr     CCL4   = 0xCE;
     42          sfr     CCH4   = 0xCF;
     43          sfr     CMEN   = 0xF6;
     44          sfr     CML0   = 0xD2;
     45          sfr     CMH0   = 0xD3;
     46          sfr     CML1   = 0xD4;
     47          sfr     CMH1   = 0xD5;
     48          sfr     CML2   = 0xD6;
     49          sfr     CMH2   = 0xD7;
     50          sfr     CML3   = 0xE2;
     51          sfr     CMH3   = 0xE3;
     52          sfr     CML4   = 0xE4;
     53          sfr     CMH4   = 0xE5;
     54          sfr     CML5   = 0xE6;
     55          sfr     CMH5   = 0xE7;
     56          sfr     CML6   = 0xF2;
     57          sfr     CMH6   = 0xF3;
     58          sfr     CML7   = 0xF4;
     59          sfr     CMH7   = 0xF5;
     60          sfr     CMSEL  = 0xF7;
     61          sfr     CRCL   = 0xCA;
     62          sfr     CRCH   = 0xCB;
     63          sfr     CTCON  = 0xE1;
     64          sfr     CTRELL = 0xDE;
     65          sfr     CTRELH = 0xDF;
     66          sfr     TL2    = 0xCC;
     67          sfr     TH2    = 0xCD;
     68          sfr     T2CON  = 0xC8;
     69          sfr     COMSETL= 0xA1;
     70          sfr     COMSETH= 0xA2;
     71          sfr     COMCLRL= 0xA3;
     72          sfr     COMCLRH= 0xA4;
     73          sfr     SETMSK = 0xA5;
     74          sfr     CLRMSK = 0xA6;
     75          
     76          /* Ports */
     77          sfr     P0     = 0x80;
     78          sfr     P1     = 0x90;
     79          sfr     P2     = 0xA0;
     80          sfr     P3     = 0xB0;
     81          sfr     P4     = 0xE8;
     82          sfr     P5     = 0xF8;
     83          sfr     P6     = 0xFA;
     84          sfr     P7     = 0xDB;        /* Analog/Digital Input */
     85          sfr     P8     = 0xDD;        /* Analog/Digital Input, 4 Bit */
     86          
     87          /* Serial Channels */
     88          sfr     PCON   = 0x87;
     89          sfr     S0CON  = 0x98;
     90          sfr     S0BUF  = 0x99;
     91          sfr     S1CON  = 0x9B;
     92          sfr     S1BUF  = 0x9C;
     93          sfr     S0RELL = 0xAA;
     94          sfr     S0RELH = 0xBA;
     95          sfr     S1RELL = 0x9D;
     96          sfr     S1RELH = 0xBB;
     97          
     98          /* A/D Converter */
     99          sfr     ADCON0 = 0xD8;
    100          sfr     ADCON1 = 0xDC;
    101          sfr     ADDATH = 0xD9;
    102          sfr     ADDATL = 0xDA;
    103          
    104          /* MUL/DIV Unit */
    105          sfr     ARCON  = 0xEF;
    106          sfr     MD0    = 0xE9;
    107          sfr     MD1    = 0xEA;
    108          sfr     MD2    = 0xEB;
    109          sfr     MD3    = 0xEC;
    110          sfr     MD4    = 0xED;
    111          sfr     MD5    = 0xEE;
    112          
    113          /* Interrupt System */
    114          sfr     IEN0   = 0xA8;
    115          sfr     IP0    = 0xA9;
    116          sfr     IEN1   = 0xB8;
    117          sfr     IP1    = 0xB9;
    118          sfr     IEN2   = 0x9A;
    119          sfr     IRCON0 = 0xC0;
    120          sfr     IRCON1 = 0xD1;
    121          
    122          
    123          /* Watchdog */
    124          sfr     WDTREL = 0x86;
    125          
    126          
    127          /* Pre-defined SFR bit addresses */
    128          
    129          /*========ADCON0=======*/
    130          
    131          bit     BD     = 0xDF;
    132          bit     CLK    = 0xDE;
    133          bit     ADEX   = 0xDD;
    134          bit     BSY    = 0xDC;
    135          bit     ADM    = 0xDB;
    136          bit     MX2    = 0xDA;
    137          bit     MX1    = 0xD9;
    138          bit     MX0    = 0xD8;
    139          
    140          
    141          /*========IRCON0=======*/
    142          
    143          bit     EXF2   = 0xC7;
    144          bit     TF2    = 0xC6;
    145          bit     IEX6   = 0xC5;
    146          bit     IEX5   = 0xC4;
    147          bit     IEX4   = 0xC3;
    148          bit     IEX3   = 0xC2;
    149          bit     IEX2   = 0xC1;
    150          bit     IADC   = 0xC0;
    151          
    152          /*========T2CON=======*/
    153          
    154          bit     T2PS   = 0xCF;
    155          bit     I3FR   = 0xCE;
    156          bit     I2FR   = 0xCD;
    157          bit     T2R1   = 0xCC;
    158          bit     T2R0   = 0xCB;
    159          bit     T2CM   = 0xCA;
    160          bit     T2I1   = 0xC9;
    161          bit     T2I0   = 0xC8;
    162          
    163          /*========PSW=========*/
    164          
    165          bit     CY     = 0xD7;
    166          bit     AC     = 0xD6;
    167          bit     F0     = 0xD5;
    168          bit     RS1    = 0xD4;
    169          bit     RS0    = 0xD3;
    170          bit     OV     = 0xD2;
    171          bit     F1     = 0xD1;
    172          bit     P      = 0xD0;
    173          
    174          /*========TCON========*/
    175          
    176          bit     TF1    = 0x8F;
    177          bit     TR1    = 0x8E;
    178          bit     TF0    = 0x8D;
    179          bit     TR0    = 0x8C;
    180          bit     IE1    = 0x8B;
    181          bit     IT1    = 0x8A;
    182          bit     IE0    = 0x89;
    183          bit     IT0    = 0x88;
    184          
    185          /*========IEN0========*/
    186          
    187          bit     EAL    = 0xAF;
    188          bit     WDT    = 0xAE;
    189          bit     ET2    = 0xAD;
    190          bit     ES0    = 0xAC;
    191          bit     ET1    = 0xAB;
    192          bit     EX1    = 0xAA;
    193          bit     ET0    = 0xA9;
    194          bit     EX0    = 0xA8;
    195          
    196          /*========IEN1========*/
    197          
    198          bit     EXEN2  = 0xBF;
    199          bit     SWDT   = 0xBE;
    200          bit     EX6    = 0xBD;
    201          bit     EX5    = 0xBC;
    202          bit     EX4    = 0xBB;
    203          bit     EX3    = 0xBA;
    204          bit     EX2    = 0xB9;
    205          bit     EADC   = 0xB8;
    206          
    207          /*========P3=========*/
    208          
    209          bit     RD     = 0xB7;
    210          bit     WR     = 0xB6;
    211          bit     T1     = 0xB5;
    212          bit     T0     = 0xB4;
    213          bit     INT1   = 0xB3;
    214          bit     INT0   = 0xB2;
    215          bit     TXD    = 0xB1;
    216          bit     RXD    = 0xB0;
    217          
    218          /*========S0CON========*/
    219          
    220          bit     SM0    = 0x9F;
    221          bit     SM1    = 0x9E;
    222          bit     SM20   = 0x9D;
    223          bit     REN0   = 0x9C;
    224          bit     TB80   = 0x9B;
    225          bit     RB80   = 0x9A;
    226          bit     TI0    = 0x99;
    227          bit     RI0    = 0x98;
    228          
    229          
    230          /* Interrupt Vector Definitions */
    231          
    232          interrupt [0x03] void EX0_int (void);     /* External Interrupt 0 */
    233          
    234          interrupt [0x0B] void T0_int (void);      /* Timer 0 Overflow */
    235          
    236          interrupt [0x13] void EX1_int (void);     /* External Interrupt 1 */
    237          
    238          interrupt [0x1B] void T1_int (void);      /* Timer 1 Overflow */
    239          
    240          interrupt [0x23] void SCON0_int (void);   /* Serial Port 0 */
    241          
    242          interrupt [0x2B] void T2_int (void);      /* Timer 2 Overflow */
    243          
    244          interrupt [0x2B] void T2EX_int (void);    /* Negative Transition on T2EX */
    245          
    246          interrupt [0x43] void ADC_int (void);     /* ADC Interrupt */
    247          
    248          interrupt [0x4B] void EX2_int (void);     /* External Interrupt 2 */
    249          
    250          interrupt [0x53] void EX3_int (void);     /* External Interrupt 3 */
    251          
    252          interrupt [0x5B] void EX4_int (void);     /* External Interrupt 4 */
    253          
    254          interrupt [0x63] void EX5_int (void);     /* External Interrupt 5 */
    255          
    256          interrupt [0x6B] void EX6_int (void);     /* External Interrupt 6 */
    257          
    258          interrupt [0x83] void SCON1_int (void);   /* Serial Port 1 */
    259          
    260          interrupt [0x93] void ICMP_int (void);    /* Compare match interrupt */
    261          
    262          interrupt [0x9B] void CT_int (void);      /* Compare Timer Overflow */
    263          
    264          interrupt [0xA3] void ICS_int (void);     /* COMSET interrupt */
    265          
    266          interrupt [0xAB] void ICR_int (void);     /* COMCLR interrupt */
    267          
    268          
     62          #include <stdio.h>
      1          /*                      - STDIO.H -
      2          
      3             Subset of ANSI standard I/O function declarations.
      4          
      5             Version: 3.30 04/Nov/94 IHAW
      6          
      7          
      8          */
      9          
     10          #ifndef _STDIO_INCLUDED
     11          #define _STDIO_INCLUDED
     12          
     13          #ifndef NULL
     14          #define NULL    (void *) 0
     15          #endif
     16          
     17          #ifndef EOF
     18          #define EOF     (-1)
     19          #endif
     20          
     21          #ifndef size_t
     22          #if     sizeof((char*)0 - (char*)0) <= sizeof(int)
     23          #define size_t  unsigned int
     24          #else
     25          #define size_t  unsigned long 
     26          #endif
     27          #endif
     28          
     29          /* ===
     30          
     31          #if __TID__ & 0x8000
     32          #pragma function=intrinsic(0)
     33          #endif
     34          
     35          === */
     36          
     37          #ifndef MEMORY_ATTRIBUTE
     38          #define MEMORY_ATTRIBUTE
     39          #endif
     40          
     41          MEMORY_ATTRIBUTE int    puts(const char *__s);
     42          MEMORY_ATTRIBUTE int    putchar(int __value);
     43          MEMORY_ATTRIBUTE int    getchar(void);
     44          MEMORY_ATTRIBUTE int    sprintf(char *__s,const char *__format,...);
     45          MEMORY_ATTRIBUTE int    printf(const char *__format,...);
     46          MEMORY_ATTRIBUTE int    scanf(const char *__format,...);
     47          MEMORY_ATTRIBUTE int    sscanf(const char *__s, const char *__format,...);
     48          MEMORY_ATTRIBUTE char   *gets(char *__s);
     49          
     50          #if __TID__ & 0x8000
     51          #pragma function=default
     52          #endif
     53          
     54          #endif
     55          
     56          
     57          
     63          #include <stdlib.h>
      1          /*                      - STDLIB.H -
      2          
      3             The ANSI-defined 'standard' functions.
      4          
      5             Version: 3.30 04/Nov/94 IHAW
      6          
      7          $Name: V3_33B $
      8          $Log: stdlib.h $
      9          Revision 1.3  1996/06/07 07:11:26  matsp
     10          
     11          Revision 1.2  1996/01/26 16:13:20  matsp
     12          A lot. Converted to Source Integrity
     13          Revision 1.2  1996/01/26 17:13:18  MATSP
     14          Revision 1.4  1996/01/26 16:07:29  MATSP
     15          Revision 1.3  1995/12/04 09:04:11  MATSP
     16          RAND_MAX changed from 32768 to 32767.
     17          */
     18          
     19          #ifndef _STDLIB_INCLUDED
     20          #define _STDLIB_INCLUDED
     21          
     22          #ifndef size_t
     23          #if sizeof((char *)0 - (char *)0) <= sizeof(int)
     24          #define size_t          unsigned int
     25          #else
     26          #define size_t          unsigned long
     27          #endif
     28          #endif
     29          
     30          #ifndef NULL
     31          #define NULL    (void*) 0 
     32          #endif
     33          
     34          typedef struct
     35                  {
     36                    int   quot;
     37                    int   rem;
     38                  } div_t;
     39          
     40          typedef struct
     41                  {
     42                    long int      quot;
     43                    long int      rem;
     44                  } ldiv_t;
     45          
     46          
     47          #define RAND_MAX        32767
     48          
     49          #define EXIT_SUCCESS    0
     50          #define EXIT_FAILURE    1
     51          
     52          #define MB_CUR_MAX      1
     53          
     54          #if __TID__ & 0x8000
     55          #pragma function=intrinsic(0)
     56          #endif
     57          
     58          #ifndef MEMORY_ATTRIBUTE
     59          #define MEMORY_ATTRIBUTE
     60          #endif
     61          
     62          #ifndef PTR_ATTRIBUTE
     63          #define PTR_ATTRIBUTE
     64          #endif
     65          
     66          MEMORY_ATTRIBUTE void   *malloc(size_t __size);
     67          
     68          MEMORY_ATTRIBUTE void   free(void *__ptr);
     69          
     70          MEMORY_ATTRIBUTE void   exit(int __status);
     71          
     72          MEMORY_ATTRIBUTE void   *calloc(unsigned int __nelem, size_t __elsize);
     73          
     74          MEMORY_ATTRIBUTE void   *realloc(void *__ptr, size_t __size);
     75          
     76          MEMORY_ATTRIBUTE int atoi (const char *__nptr);
     77          
     78          MEMORY_ATTRIBUTE long atol (const char *__nptr);
     79          
     80          MEMORY_ATTRIBUTE double atof (const char *__nptr);
     81          
     82          MEMORY_ATTRIBUTE double strtod(const char *__nptr, char **__endptr);
     83          
     84          MEMORY_ATTRIBUTE long int strtol(const char *__nptr, char **__endptr, int __base);
     85          
     86          MEMORY_ATTRIBUTE unsigned long int strtoul(const char *__nptr, char **__endptr, int __base);
     87          
     88          MEMORY_ATTRIBUTE int rand(void);
     89          
     90          MEMORY_ATTRIBUTE void srand(unsigned int __seed);
     91          
     92          MEMORY_ATTRIBUTE void abort(void);
     93          
     94          MEMORY_ATTRIBUTE int abs(int __j);
     95          
     96          MEMORY_ATTRIBUTE div_t div(int __numer, int __denom);
     97          
     98          MEMORY_ATTRIBUTE long int labs(long int __j);
     99          
    100          MEMORY_ATTRIBUTE ldiv_t ldiv(long int __numer, long int __denom);
    101          
    102          MEMORY_ATTRIBUTE void *bsearch(const void *__key, const void *__base,
    103                                  size_t __nmemb, size_t __size,
    104                                  int (*__compar) (const void *, const void *));
    105          
    106          MEMORY_ATTRIBUTE void qsort(void *__base, size_t __nmemb, size_t __size,
    107                                  int (*__compar) (const void *, const void *));
    108          
    109          #if __TID__ & 0x8000
    110          #pragma function=default
    111          #endif
    112          
    113          #endif
    114          
     64          #include <string.h>
      1          /*                       - STRING.H -
      2          
      3             The ANSI 'string' function declarations.
      4                     
      5             Version: 3.30 04/Nov/94 IHAW
      6                             
      7          */
      8          
      9          #ifndef _STRING_INCLUDED
     10          #define _STRING_INCLUDED
     11          
     12          #ifndef NULL
     13          #define NULL    (void*)0     /* changed from char* 93.01.21 ICLM */
     14          #endif
     15          
     16          #ifndef size_t
     17          #if sizeof((char *)0 - (char *)0) <= sizeof(int)
     18          #define size_t          unsigned int
     19          #else
     20          #define size_t          unsigned long
     21          #endif
     22          #endif
     23          
     24          #if __TID__ & 0x8000
     25          #pragma function=intrinsic(0)
     26          #endif
     27          
     28          #ifndef MEMORY_ATTRIBUTE
     29          #define MEMORY_ATTRIBUTE
     30          #endif
     31          
     32          MEMORY_ATTRIBUTE void *memcpy(void *s1, const void *s2, size_t n);
     33          
     34          MEMORY_ATTRIBUTE void *memmove(void *s1, const void *s2, size_t n);
     35          
     36          MEMORY_ATTRIBUTE void *memchr(const void *s, int c, size_t n);
     37          
     38          MEMORY_ATTRIBUTE void *memset(void *s, int c, size_t n);
     39          
     40          MEMORY_ATTRIBUTE int memcmp(const void *s1, const void *s2, size_t n);
     41          
     42          MEMORY_ATTRIBUTE char *strchr(const char *s, int c);
     43          
     44          MEMORY_ATTRIBUTE int strcmp(const char *s1, const char *s2);
     45          
     46          MEMORY_ATTRIBUTE int strncmp(const char *s1, const char *s2, size_t n);
     47          
     48          MEMORY_ATTRIBUTE int strcoll(const char *s1, const char *s2);
     49          
     50          MEMORY_ATTRIBUTE size_t strlen(const char *s);
     51          
     52          MEMORY_ATTRIBUTE size_t strcspn(const char *s1, const char *s2);
     53          
     54          MEMORY_ATTRIBUTE size_t strspn(const char *s1, const char *s2);
     55          
     56          MEMORY_ATTRIBUTE char *strpbrk(const char *s1, const char *s2);
     57          
     58          MEMORY_ATTRIBUTE char *strrchr(const char *s, int c);
     59          
     60          MEMORY_ATTRIBUTE char *strstr(const char *s1, const char *s2);
     61          
     62          MEMORY_ATTRIBUTE char *strcat(char *s1, const char *s2);
     63          
     64          MEMORY_ATTRIBUTE char *strncat(char *s1, const char *s2, size_t n);
     65          
     66          MEMORY_ATTRIBUTE char *strcpy(char *s1, const char *s2);
     67          
     68          MEMORY_ATTRIBUTE char *strncpy(char *s1, const char *s2, size_t n);
     69          
     70          MEMORY_ATTRIBUTE char *strerror(int errnum);
     71          
     72          MEMORY_ATTRIBUTE char *strtok(char *s1, const char *s2);
     73          
     74          MEMORY_ATTRIBUTE size_t strxfrm(char *s1, const char *s2, size_t n);
     75          
     76          #if __TID__ & 0x8000
     77          #pragma function=default
     78          #endif
     79          
     80          #endif
     81          
     82          
     65          #include "PhoneAns.h"
      1          /********************************************************
      2          Fil:            $Id: PhoneAns.h,v 1.2 2003/11/20 22:08:53 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/11/20 22:08:53 $
      5          
      6          Revisionshistoria:
      7                                          $Log: PhoneAns.h,v $
      8                                          Revision 1.2  2003/11/20 22:08:53  Gemensam
      9                                          Various declarations changes.
     10                                          Still version 0200.
     11                                          
     12                                          Revision 1.1  2003/11/18 19:17:36  Gemensam
     13                                          Added menu option of setting speaker volume (untested)
     14                                          Completely changed header files
     15                                          Version 0200.
     16                                          
     17                                          
     18          
     19          ********************************************************/
     20          
     21          #ifndef _PHONEANS_INCLUDED_
     22          #define _PHONEANS_INCLUDED_
     23          
     24          #include "Main.h"
      1          /*************************************************************
      2          Fil:            $Id: Main.h,v 1.10 2003/12/26 16:17:01 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/12/26 16:17:01 $
      5          
      6          Revisionshistoria:
      7                                          $Log: Main.h,v $
      8                                          Revision 1.10  2003/12/26 16:17:01  Gemensam
      9                                          Reinstate 500 ms wait for hang up detection to settle (if not PPD is used).
     10                                          Fixed PPD detection by decreasing phone volume from 63 to 15.
     11                                          Version 0304.
     12                                          
     13                                          Revision 1.9  2003/12/09 20:52:49  Gemensam
     14                                          Commented out PPD detection since the HW not work yet.
     15                                          Ver 0302.
     16                                          
     17                                          Revision 1.8  2003/11/29 22:35:59  Gemensam
     18                                          Fixed problem with to short pulse width on PPD.
     19                                          Ver 0302.
     20                                          
     21                                          Revision 1.7  2003/11/24 22:44:36  Gemensam
     22                                          Fixed PPD, not working yet,
     23                                          New command: speaker volume.
     24                                          Version 0301.
     25                                          
     26                                          Revision 1.6  2003/11/23 21:40:03  Gemensam
     27                                          Parallell phone detection included.
     28                                          Removed obsolete #define's regarding LCD interface.
     29                                          Ver 0300
     30                                          
     31                                          Revision 1.5  2003/11/23 20:29:34  Gemensam
     32                                          Complete and tested volume setting in options menu.
     33                                          Ver 0201
     34                                          
     35                                          Revision 1.4  2003/11/20 22:08:53  Gemensam
     36                                          Various declarations changes.
     37                                          Still version 0200.
     38                                          
     39                                          Revision 1.3  2003/11/18 19:17:36  Gemensam
     40                                          Added menu option of setting speaker volume (untested)
     41                                          Completely changed header files
     42                                          Version 0200.
     43                                          
     44                                          Revision 1.2  2003/11/10 22:44:45  Gemensam
     45                                          Added header information
     46                                          
     47          *************************************************************/
     48          
     49          #ifndef _MAIN_INCLUDED_
     50          #define _MAIN_INCLUDED_
     51          
     52          #include "FileSystem.h"
      1          /**************************************************************************************
      2          Fil:            $Id: FileSystem.h,v 1.4 2003/11/20 22:08:53 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/11/20 22:08:53 $
      5          
      6          Kommentarer:    Filhuvudet befinner sig i "Spare" arean tillhörande filens första sida. Huvudet består 
      7                                          av 16 bytes enligt följande lista:
      8                                          0       Huvud       0xAA = Legalt filhuvud, annat tillsvidare odefinierat
      9                                          1-4     Fillängd    Pos 1 = MSB, pos 4 = LSB
     10                                          5-12    Filtitel    Enl "Titel.ext". Om titeln är mindre än 8 tecken avslutas det med nollor
     11                                          13-15   Filext      Enl "Titel.ext". Om ext är mindre än 3 tecken avslutas det med nollor
     12          
     13                                          En nolla skriven i fileName[0] indikerar att
     14                                          filstrukturen är ledig.
     15                  
     16          Revisionshistoria:
     17                                          $Log: FileSystem.h,v $
     18                                          Revision 1.4  2003/11/20 22:08:53  Gemensam
     19                                          Various declarations changes.
     20                                          Still version 0200.
     21                                          
     22                                          Revision 1.3  2003/11/18 19:17:36  Gemensam
     23                                          Added menu option of setting speaker volume (untested)
     24                                          Completely changed header files
     25                                          Version 0200.
     26                                          
     27                                          Revision 1.2  2003/11/10 22:44:45  Gemensam
     28                                          Added header information
     29                                          
     30          
     31          **************************************************************************************/
     32          
     33          #ifndef _FILESYSTEM_INCLUDED_
     34          #define _FILESYSTEM_INCLUDED_
     35          
     36          ///////////////////////////////////
     37          // Definitioner
     38          
     39          #define FS_MAXFILES         8 
     40          #define FS_FILENAMELENGTH   13
     41          #define FS_FLASHSIZE        0x800000
     42          
     43          #define OFF            0
     44          #define READY        1
     45          #define NEMPTY        2
     46          #define WRITING        3
     47          #define OCCUPIED    4
     48          
     49          #define CLE     P4.0                                //Command Latch Enable
     50          #define ALE     P4.1                                //Address Latch Enable
     51          #define WP      P4.2                                //Write Protect
     52          #define SE      P4.3                                //Spare Enable
     53          //#define CE      P4.4                                //Chip Enable
     54          #define FBUSY   P4.5                                //Busy
     55          
     56          #define FREG (*(unsigned char xdata *) 0xE000)
     57          #define FLASH (*(unsigned char xdata *) 0xB000) 
     58          
     59          ///////////////////////////////////
     60          // Strukturer
     61          
     62          struct ST_FILE_HEAD {
     63              unsigned long   length;
     64              char            name[FS_FILENAMELENGTH];
     65          };
     66          #define FILE_HEAD struct ST_FILE_HEAD
     67          
     68          
     69          struct ST_FILE {
     70              char            fileName[FS_FILENAMELENGTH];
     71              unsigned long   startAddress;
     72              unsigned long   length; 
     73              unsigned long   offset; 
     74              char            write;
     75              char            append;
     76          };
     77          #define FILE struct ST_FILE 
     78          
     79          
     80          
     81          ///////////////////////////////////
     82          // Funktioner och procedurer
     83          
     84          extern void            InitializeFileSystem( void );
     85          extern void            InitializeFlash( void );
     86          extern void            SetupReadSeq( void );
     87          extern unsigned char   ReadFLASH( void );
     88          extern void            TerminateReadSeq( void );
     89          extern void            GetDeviceIDRS232(void);
     90          extern void            SetupWriteSeq( void );
     91          extern void            WriteFLASH(unsigned char);
     92          extern void            TerminateWriteSeq( void );
     93          extern void            PerformWriteSeq( void );
     94          extern void            EraseBlock( void );
     95          extern void            WriteFileHead(const char* name, long size);
     96          extern FILE*           fopen(const char* name, const char* def);
     97          extern FILE*               fopenA(const char* name, long maxSize, long offset);
     98          extern void            fputc(FILE* filePtr, char c);
     99          extern void            fputLine(FILE* filePtr, const char* str);
    100          extern void            fupLoad( void );
    101          extern int             fgetc(FILE* filePtr);
    102          extern void            fgetLine(FILE* filePtr, char* str, int maxLen);
    103          extern void            fdownLoad( void );
    104          extern void            fclose(FILE* filePtr);
    105          extern long            ftell(FILE* filePtr);
    106          //void            Rewind(FILE* filePtr);
    107          extern void            fSetPos(FILE* filePtr, long offset);
    108          extern void            ReleaseCurrFile( void );
    109          extern void            EraseAll( void );
    110          extern void            StartDynamic( void );
    111          extern void            EraseDynamic( void );
    112          extern char                        MemUsage( void );
    113          extern void                        Dir( void );
    114          extern void                        Type( void );
    115          extern void                        TypeA( void );
    116          
    117          #endif
     53          
     54          
     55          ///////////////////////////////////
     56          // Definitioner
     57          
     58          #define VERSION_MENU_STRING     "Telestation 3.5       (c) 2004-09-19 FRHA"
     59          
     60          #define CM_PARSIZE              24
     61          #define CM_NRPAR                16
     62          
     63          #define MAX_LABEL_LEN   8
     64          #define MAX_LABELS      64
     65          
     66          // Nedan var ett försök till multipla bat-filer, kanske införs senare
     67          /*
     68          #define MAX_BATFILES    8
     69          */
     70          
     71          ///////////////////////////////////
     72          // Strukturer
     73          
     74          // Nedan var ett försök till multipla bat-filer, kanske införs senare
     75          /*
     76          struct ST_Label {
     77              char    name[MAX_LABEL_LEN];
     78              long    pos;
     79          };
     80          #define Label struct ST_Label
     81           
     82          struct ST_BatFileObj {
     83              FILE*       fp;                 //Filpekare till bat-filen
     84              Label*      labels;             //Pekare till lista med ingående labels
     85              char        labelIndex;         //Pekar på nästa lediga label
     86              BatFileObj* caller;             //Den batfil som kallade på denna. Om användaren gav kommandot 
     87                                              //skall den inehålla NULL
     88              char        occupied;           //1 om detta objekt används, 0 annars
     89          };    
     90          #define BatFileObj struct ST_BatFileObj
     91          */
     92          
     93          ///////////////////////////////////
     94          // Funktioner och procedurer
     95          
     96          extern void    InitializeComputer1( void );
     97          extern void    InitializePhoneAnsApp( void );
     98          extern void    MainShell( void );
     99          extern char    DecodeAndPerform(const char* cmdStr);
    100          //int     MainCommandInterper(char c);
    101          extern void    Hello( void );
    102          extern void    TestHW( void );
    103          extern void    FlashID( void );
    104          extern void    Erase( void );
    105          extern void    BackRead( void );
    106          extern void    ReadSpare( void );
    107          extern void    WF1( void );
    108          extern void    WF2( void );
    109          extern void    WF3( void );
    110          extern void    RF1( void );
    111          extern void    RF2( void );
    112          extern void    RF3( void );
    113          extern void    CreateLong( void );
    114          extern void    ReadSpare2( void );
    115          extern void    Append( void );
    116          
    117          extern void    SetupBatFile( void );
    118          extern void    ClearLabelList( void );
    119          extern void    ExecuteBatFile(const char* batFileName);
    120          extern char    InsertLabel(const char* name, long pos);
    121          extern int     FindLabel(const char *name);
    122          extern char    GotoLabel(const char* name);
    123          
    124          extern void    myStrCpy(char* dest, const char* src);
    125          extern int     myStrLen(char* str);
    126          extern void    myLong2HexStr(long v, char* str);
    127          extern void    myInt2DecStr(int v, char* str);
    128          extern void    myInt2DecStr00(char v, char* str);
    129          extern int     myStr2Int(const char* str);
    130          extern char    myStrCmpNoCase(const char* s1, const char* s2);
    131          
    132          // Nedan var ett försök till multipla bat-filer, kanske införs senare
    133          /*
    134          void    SetupBatFile( void );
    135          void    ClearLabelList( void );
    136          void    ClearLabelList(Label* list);
    137          BatFileObj*    VacantBatFileObj(FILE* fp);
    138          void    ExecuteBatFile(const char* batFileName);
    139          char    InsertLabel(const char* name, long pos);
    140          char    FindLabel(const char *name, Label* l);
    141          char    GotoLabel(const char* name);
    142          */
    143          
    144          ///////////////////////////
    145          // Globala variabler
    146          
    147          
    148          ///////////////////////////
    149          // Lokala variabler
    150          
    151          
    152          #endif
     25          #include "Calender.h"
      1          /********************************************************
      2          Fil:            $Id: Calender.h,v 1.4 2003/11/20 22:08:52 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/11/20 22:08:52 $
      5          
      6          Revisionshistoria:
      7                                          $Log: Calender.h,v $
      8                                          Revision 1.4  2003/11/20 22:08:52  Gemensam
      9                                          Various declarations changes.
     10                                          Still version 0200.
     11                                          
     12                                          Revision 1.3  2003/11/18 19:17:35  Gemensam
     13                                          Added menu option of setting speaker volume (untested)
     14                                          Completely changed header files
     15                                          Version 0200.
     16                                          
     17                                          Revision 1.2  2003/11/10 22:44:45  Gemensam
     18                                          Added header information
     19                                          
     20          
     21          ********************************************************/
     22          
     23          #ifndef _CALENDER_INCLUDED_
     24          #define _CALENDER_INCLUDED_
     25          
     26          ///////////////////////////////////
     27          // Definitioner
     28          
     29          // Non-volatile variabler:
     30          #define NV_ANSWERING_ON 0x08
     31          #define NV_NUM_SIGNALS  0x09
     32          #define NV_PLAYED_MS    0x0A
     33          #define NV_PLAYED_LS    0x0B
     34          #define NV_SPEAKER_VOL  0x0C
     35          //Max adress är 0x3F
     36          
     37          #define SDA    P3.0
     38          #define SCL    P3.1
     39          //#define SDA    P1.5
     40          //#define SCL    P1.6
     41          
     42          
     43          ///////////////////////////////////
     44          // Strukturer
     45          
     46          struct ST_TIME {
     47              char    seconds;
     48              char    minutes;
     49              char    hours;
     50          };
     51          #define TIME struct ST_TIME
     52          
     53          
     54          struct ST_DATE {
     55              char    day;
     56              char    date;
     57              char    month;
     58              char    year;
     59          };
     60          #define DATE struct ST_DATE
     61          
     62          ///////////////////////////////////
     63          // Funktioner och procedurer
     64          
     65          extern void    InitializeCalender( void );
     66          extern char    WOCB(char dat);
     67          extern char    ROCB(char ack);
     68          extern char    WriteCalenderByte(char address, char dat);
     69          extern char    ReadCalenderByte(char address, char* dat);
     70          extern void    GetTimeNow(TIME* tptr);
     71          extern void    GetDateNow(DATE* tptr);
     72          extern void    CreateTimeString(TIME* tptr, char* str);
     73          extern void    CreateDateString(DATE* tptr, char* str);
     74          extern void    CreateDateString2(DATE* tptr, char* str);
     75           
     76          
     77          ///////////////////////////
     78          // Variabler
     79          
     80          
     81          
     82          
     83           
     84          #endif
     26          
     27          ///////////////////////////////////
     28          // Definitioner
     29          
     30          #define MS_LOG          0x01
     31          #define MS_MENU         0x02
     32          #define MS_TIMEDATE     0x03
     33          #define MS_ERASEQST     0x04
     34          #define MS_MEMO         0x05
     35          
     36          #define PB_MAXENTRIES   512
     37          #define PB_POSTSIZE     32
     38          
     39          ///////////////////////////////////
     40          // Strukturer
     41          
     42          
     43          ///////////////////////////////////
     44          // Funktioner och procedurer
     45          
     46          extern void    InitializePhoneAns( void );
     47          extern void    WaitForCall( void );
     48          extern void    CorrectDate(char changedDate);
     49          extern void    RecordCallerMessage( void );
     50          extern void    AskQuestionMsg( void );
     51          extern void    EnterCode( void );
     52          extern void    SetupUpQLabels( void );
     53          extern void    LabelCopy(char* dest, const char* src);
     54          extern void    CreateUniqueFilename(char* str);
     55          extern void    ShowTimeDateSet( void );
     56          extern void    ShowEraseQuest( void );
     57          extern void    ReadPhoneBookFile( void );
     58          extern void    LookUpCaller(char* number, char* name,  char* category);
     59          extern void    IntitializeMemo( void );
     60          extern void    RecordMemo( void );
     61          extern void    PlayMemo( void );
     62          extern void    CreateMemoFileName(int index, char* str);
     63          extern char    CategoryHit(char* str, char category);
     64          
     65          #endif
     66          #include "calender.h"
      1          /********************************************************
      2          Fil:            $Id: Calender.h,v 1.4 2003/11/20 22:08:52 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/11/20 22:08:52 $
      5          
      6          Revisionshistoria:
      7                                          $Log: Calender.h,v $
      8                                          Revision 1.4  2003/11/20 22:08:52  Gemensam
      9                                          Various declarations changes.
     10                                          Still version 0200.
     11                                          
     12                                          Revision 1.3  2003/11/18 19:17:35  Gemensam
     13                                          Added menu option of setting speaker volume (untested)
     14                                          Completely changed header files
     15                                          Version 0200.
     16                                          
     17                                          Revision 1.2  2003/11/10 22:44:45  Gemensam
     18                                          Added header information
     19                                          
     20          
     21          ********************************************************/
     22          
     23          #ifndef _CALENDER_INCLUDED_
     24          #define _CALENDER_INCLUDED_
     25          
     26          ///////////////////////////////////
     27          // Definitioner
     28          
     29          // Non-volatile variabler:
     30          #define NV_ANSWERING_ON 0x08
     31          #define NV_NUM_SIGNALS  0x09
     32          #define NV_PLAYED_MS    0x0A
     33          #define NV_PLAYED_LS    0x0B
     34          #define NV_SPEAKER_VOL  0x0C
     35          //Max adress är 0x3F
     36          
     37          #define SDA    P3.0
     38          #define SCL    P3.1
     39          //#define SDA    P1.5
     40          //#define SCL    P1.6
     41          
     42          
     43          ///////////////////////////////////
     44          // Strukturer
     45          
     46          struct ST_TIME {
     47              char    seconds;
     48              char    minutes;
     49              char    hours;
     50          };
     51          #define TIME struct ST_TIME
     52          
     53          
     54          struct ST_DATE {
     55              char    day;
     56              char    date;
     57              char    month;
     58              char    year;
     59          };
     60          #define DATE struct ST_DATE
     61          
     62          ///////////////////////////////////
     63          // Funktioner och procedurer
     64          
     65          extern void    InitializeCalender( void );
     66          extern char    WOCB(char dat);
     67          extern char    ROCB(char ack);
     68          extern char    WriteCalenderByte(char address, char dat);
     69          extern char    ReadCalenderByte(char address, char* dat);
     70          extern void    GetTimeNow(TIME* tptr);
     71          extern void    GetDateNow(DATE* tptr);
     72          extern void    CreateTimeString(TIME* tptr, char* str);
     73          extern void    CreateDateString(DATE* tptr, char* str);
     74          extern void    CreateDateString2(DATE* tptr, char* str);
     75           
     76          
     77          ///////////////////////////
     78          // Variabler
     79          
     80          
     81          
     82          
     83           
     84          #endif
     67          #include "main.h"
      1          /*************************************************************
      2          Fil:            $Id: Main.h,v 1.10 2003/12/26 16:17:01 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/12/26 16:17:01 $
      5          
      6          Revisionshistoria:
      7                                          $Log: Main.h,v $
      8                                          Revision 1.10  2003/12/26 16:17:01  Gemensam
      9                                          Reinstate 500 ms wait for hang up detection to settle (if not PPD is used).
     10                                          Fixed PPD detection by decreasing phone volume from 63 to 15.
     11                                          Version 0304.
     12                                          
     13                                          Revision 1.9  2003/12/09 20:52:49  Gemensam
     14                                          Commented out PPD detection since the HW not work yet.
     15                                          Ver 0302.
     16                                          
     17                                          Revision 1.8  2003/11/29 22:35:59  Gemensam
     18                                          Fixed problem with to short pulse width on PPD.
     19                                          Ver 0302.
     20                                          
     21                                          Revision 1.7  2003/11/24 22:44:36  Gemensam
     22                                          Fixed PPD, not working yet,
     23                                          New command: speaker volume.
     24                                          Version 0301.
     25                                          
     26                                          Revision 1.6  2003/11/23 21:40:03  Gemensam
     27                                          Parallell phone detection included.
     28                                          Removed obsolete #define's regarding LCD interface.
     29                                          Ver 0300
     30                                          
     31                                          Revision 1.5  2003/11/23 20:29:34  Gemensam
     32                                          Complete and tested volume setting in options menu.
     33                                          Ver 0201
     34                                          
     35                                          Revision 1.4  2003/11/20 22:08:53  Gemensam
     36                                          Various declarations changes.
     37                                          Still version 0200.
     38                                          
     39                                          Revision 1.3  2003/11/18 19:17:36  Gemensam
     40                                          Added menu option of setting speaker volume (untested)
     41                                          Completely changed header files
     42                                          Version 0200.
     43                                          
     44                                          Revision 1.2  2003/11/10 22:44:45  Gemensam
     45                                          Added header information
     46                                          
     47          *************************************************************/
     48          
     49          #ifndef _MAIN_INCLUDED_
     50          #define _MAIN_INCLUDED_
     51          
     52          #include "FileSystem.h"
     53          
     54          
     55          ///////////////////////////////////
     56          // Definitioner
     57          
     58          #define VERSION_MENU_STRING     "Telestation 3.5       (c) 2004-09-19 FRHA"
     59          
     60          #define CM_PARSIZE              24
     61          #define CM_NRPAR                16
     62          
     63          #define MAX_LABEL_LEN   8
     64          #define MAX_LABELS      64
     65          
     66          // Nedan var ett försök till multipla bat-filer, kanske införs senare
     67          /*
     68          #define MAX_BATFILES    8
     69          */
     70          
     71          ///////////////////////////////////
     72          // Strukturer
     73          
     74          // Nedan var ett försök till multipla bat-filer, kanske införs senare
     75          /*
     76          struct ST_Label {
     77              char    name[MAX_LABEL_LEN];
     78              long    pos;
     79          };
     80          #define Label struct ST_Label
     81           
     82          struct ST_BatFileObj {
     83              FILE*       fp;                 //Filpekare till bat-filen
     84              Label*      labels;             //Pekare till lista med ingående labels
     85              char        labelIndex;         //Pekar på nästa lediga label
     86              BatFileObj* caller;             //Den batfil som kallade på denna. Om användaren gav kommandot 
     87                                              //skall den inehålla NULL
     88              char        occupied;           //1 om detta objekt används, 0 annars
     89          };    
     90          #define BatFileObj struct ST_BatFileObj
     91          */
     92          
     93          ///////////////////////////////////
     94          // Funktioner och procedurer
     95          
     96          extern void    InitializeComputer1( void );
     97          extern void    InitializePhoneAnsApp( void );
     98          extern void    MainShell( void );
     99          extern char    DecodeAndPerform(const char* cmdStr);
    100          //int     MainCommandInterper(char c);
    101          extern void    Hello( void );
    102          extern void    TestHW( void );
    103          extern void    FlashID( void );
    104          extern void    Erase( void );
    105          extern void    BackRead( void );
    106          extern void    ReadSpare( void );
    107          extern void    WF1( void );
    108          extern void    WF2( void );
    109          extern void    WF3( void );
    110          extern void    RF1( void );
    111          extern void    RF2( void );
    112          extern void    RF3( void );
    113          extern void    CreateLong( void );
    114          extern void    ReadSpare2( void );
    115          extern void    Append( void );
    116          
    117          extern void    SetupBatFile( void );
    118          extern void    ClearLabelList( void );
    119          extern void    ExecuteBatFile(const char* batFileName);
    120          extern char    InsertLabel(const char* name, long pos);
    121          extern int     FindLabel(const char *name);
    122          extern char    GotoLabel(const char* name);
    123          
    124          extern void    myStrCpy(char* dest, const char* src);
    125          extern int     myStrLen(char* str);
    126          extern void    myLong2HexStr(long v, char* str);
    127          extern void    myInt2DecStr(int v, char* str);
    128          extern void    myInt2DecStr00(char v, char* str);
    129          extern int     myStr2Int(const char* str);
    130          extern char    myStrCmpNoCase(const char* s1, const char* s2);
    131          
    132          // Nedan var ett försök till multipla bat-filer, kanske införs senare
    133          /*
    134          void    SetupBatFile( void );
    135          void    ClearLabelList( void );
    136          void    ClearLabelList(Label* list);
    137          BatFileObj*    VacantBatFileObj(FILE* fp);
    138          void    ExecuteBatFile(const char* batFileName);
    139          char    InsertLabel(const char* name, long pos);
    140          char    FindLabel(const char *name, Label* l);
    141          char    GotoLabel(const char* name);
    142          */
    143          
    144          ///////////////////////////
    145          // Globala variabler
    146          
    147          
    148          ///////////////////////////
    149          // Lokala variabler
    150          
    151          
    152          #endif
     68          #include "FileSystem.h"
      1          /**************************************************************************************
      2          Fil:            $Id: FileSystem.h,v 1.4 2003/11/20 22:08:53 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/11/20 22:08:53 $
      5          
      6          Kommentarer:    Filhuvudet befinner sig i "Spare" arean tillhörande filens första sida. Huvudet består 
      7                                          av 16 bytes enligt följande lista:
      8                                          0       Huvud       0xAA = Legalt filhuvud, annat tillsvidare odefinierat
      9                                          1-4     Fillängd    Pos 1 = MSB, pos 4 = LSB
     10                                          5-12    Filtitel    Enl "Titel.ext". Om titeln är mindre än 8 tecken avslutas det med nollor
     11                                          13-15   Filext      Enl "Titel.ext". Om ext är mindre än 3 tecken avslutas det med nollor
     12          
     13                                          En nolla skriven i fileName[0] indikerar att
     14                                          filstrukturen är ledig.
     15                  
     16          Revisionshistoria:
     17                                          $Log: FileSystem.h,v $
     18                                          Revision 1.4  2003/11/20 22:08:53  Gemensam
     19                                          Various declarations changes.
     20                                          Still version 0200.
     21                                          
     22                                          Revision 1.3  2003/11/18 19:17:36  Gemensam
     23                                          Added menu option of setting speaker volume (untested)
     24                                          Completely changed header files
     25                                          Version 0200.
     26                                          
     27                                          Revision 1.2  2003/11/10 22:44:45  Gemensam
     28                                          Added header information
     29                                          
     30          
     31          **************************************************************************************/
     32          
     33          #ifndef _FILESYSTEM_INCLUDED_
     34          #define _FILESYSTEM_INCLUDED_
     35          
     36          ///////////////////////////////////
     37          // Definitioner
     38          
     39          #define FS_MAXFILES         8 
     40          #define FS_FILENAMELENGTH   13
     41          #define FS_FLASHSIZE        0x800000
     42          
     43          #define OFF            0
     44          #define READY        1
     45          #define NEMPTY        2
     46          #define WRITING        3
     47          #define OCCUPIED    4
     48          
     49          #define CLE     P4.0                                //Command Latch Enable
     50          #define ALE     P4.1                                //Address Latch Enable
     51          #define WP      P4.2                                //Write Protect
     52          #define SE      P4.3                                //Spare Enable
     53          //#define CE      P4.4                                //Chip Enable
     54          #define FBUSY   P4.5                                //Busy
     55          
     56          #define FREG (*(unsigned char xdata *) 0xE000)
     57          #define FLASH (*(unsigned char xdata *) 0xB000) 
     58          
     59          ///////////////////////////////////
     60          // Strukturer
     61          
     62          struct ST_FILE_HEAD {
     63              unsigned long   length;
     64              char            name[FS_FILENAMELENGTH];
     65          };
     66          #define FILE_HEAD struct ST_FILE_HEAD
     67          
     68          
     69          struct ST_FILE {
     70              char            fileName[FS_FILENAMELENGTH];
     71              unsigned long   startAddress;
     72              unsigned long   length; 
     73              unsigned long   offset; 
     74              char            write;
     75              char            append;
     76          };
     77          #define FILE struct ST_FILE 
     78          
     79          
     80          
     81          ///////////////////////////////////
     82          // Funktioner och procedurer
     83          
     84          extern void            InitializeFileSystem( void );
     85          extern void            InitializeFlash( void );
     86          extern void            SetupReadSeq( void );
     87          extern unsigned char   ReadFLASH( void );
     88          extern void            TerminateReadSeq( void );
     89          extern void            GetDeviceIDRS232(void);
     90          extern void            SetupWriteSeq( void );
     91          extern void            WriteFLASH(unsigned char);
     92          extern void            TerminateWriteSeq( void );
     93          extern void            PerformWriteSeq( void );
     94          extern void            EraseBlock( void );
     95          extern void            WriteFileHead(const char* name, long size);
     96          extern FILE*           fopen(const char* name, const char* def);
     97          extern FILE*               fopenA(const char* name, long maxSize, long offset);
     98          extern void            fputc(FILE* filePtr, char c);
     99          extern void            fputLine(FILE* filePtr, const char* str);
    100          extern void            fupLoad( void );
    101          extern int             fgetc(FILE* filePtr);
    102          extern void            fgetLine(FILE* filePtr, char* str, int maxLen);
    103          extern void            fdownLoad( void );
    104          extern void            fclose(FILE* filePtr);
    105          extern long            ftell(FILE* filePtr);
    106          //void            Rewind(FILE* filePtr);
    107          extern void            fSetPos(FILE* filePtr, long offset);
    108          extern void            ReleaseCurrFile( void );
    109          extern void            EraseAll( void );
    110          extern void            StartDynamic( void );
    111          extern void            EraseDynamic( void );
    112          extern char                        MemUsage( void );
    113          extern void                        Dir( void );
    114          extern void                        Type( void );
    115          extern void                        TypeA( void );
    116          
    117          #endif
     69          #include "ErrorCodes.h"
      1          /***********************************************
      2          Fil:            $Id: ErrorCodes.h,v 1.3 2003/11/20 22:08:52 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/11/20 22:08:52 $
      5          
      6          Revisionshistoria:
      7                                          $Log: ErrorCodes.h,v $
      8                                          Revision 1.3  2003/11/20 22:08:52  Gemensam
      9                                          Various declarations changes.
     10                                          Still version 0200.
     11                                          
     12                                          Revision 1.2  2003/11/10 22:44:45  Gemensam
     13                                          Added header information
     14                                          
     15          
     16          
     17          ***********************************************/
     18          
     19          #ifndef _ERRORCODES_INCLUDED_
     20          #define _ERRORCODES_INCLUDED_
     21          
     22          
     23          //Felkoder
     24          
     25          //Generellt
     26          #define EM_NOERROR          0x00
     27          
     28          
     29          
     30          //Filsystem
     31          #define EM_FILEEXISTS       0x10
     32          #define EM_FILENOTEXISTS    0x11
     33          #define EM_OUTOFFILEMEMORY  0x12
     34          #define EM_TOOMANYFILES     0x13
     35          #define EM_FILEOPEN         0x14
     36          #define EM_FILENOTOPEN      0x15
     37          #define EM_FILEREADONLY     0x16
     38          #define EM_FILEWRITEONLY    0x17
     39          #define EM_WRITEFILEOPEN    0x18
     40          
     41          //Phone
     42          #define EM_TOOMANYTIMERS    0x19
     43          
     44          //BAtfiles
     45          #define EM_TOOMANYBATFILES  0x20
     46          #define EM_REDEFLABELATTEMPT    0x21
     47          #define EM_TOOMANYLABELS    0x22
     48          #define EM_NOLABEL          0x23
     49          
     50          
     51          //PhoneAns
     52          #define EM_PARAMETER_SYNTAX    0x24
     53          
     54          #endif
     70          #include "RS232.h"
      1          /********************************************************
      2          Fil:            $Id: RS232.h,v 1.2 2003/11/20 22:08:53 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/11/20 22:08:53 $
      5          
      6          Revisionshistoria:
      7                                          $Log: RS232.h,v $
      8                                          Revision 1.2  2003/11/20 22:08:53  Gemensam
      9                                          Various declarations changes.
     10                                          Still version 0200.
     11                                          
     12                                          Revision 1.1  2003/11/18 19:17:36  Gemensam
     13                                          Added menu option of setting speaker volume (untested)
     14                                          Completely changed header files
     15                                          Version 0200.
     16                                          
     17                                          
     18          
     19          ********************************************************/
     20          
     21          #ifndef _RS232_INCLUDED_
     22          #define _RS232_INCLUDED_
     23          
     24          ///////////////////////////////////
     25          // Definitioner
     26          
     27          
     28          ///////////////////////////////////
     29          // Strukturer
     30          
     31          
     32          ///////////////////////////////////
     33          // Funktioner och procedurer
     34          
     35          extern void             InitializeRS232( void );
     36          extern void             SendRS232(char tecken);
     37          extern void             SendStringRS232(const char *str);
     38          extern void             SendStringEOLRS232(const char *str);
     39          extern char             WaitAndReceiveRS232( void );
     40          extern char             WaitAndReceiveTimeout( void );
     41          extern int      ReceiveLineRS232(char* str, int maxLen);
     42          
     43          #endif
     71          #include "Wav.h"
      1          /********************************************************
      2          Fil:            $Id: wav.h,v 1.1 2003/11/23 20:29:34 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/11/23 20:29:34 $
      5          
      6          Revisionshistoria:
      7                                          $Log: wav.h,v $
      8                                          Revision 1.1  2003/11/23 20:29:34  Gemensam
      9                                          Complete and tested volume setting in options menu.
     10                                          Ver 0201
     11                                          
     12                                          
     13          
     14          ********************************************************/
     15          
     16          #ifndef _WAV_INCLUDED_
     17          #define _WAV_INCLUDED_
     18          
     19          ///////////////////////////////////
     20          // Definitioner
     21          
     22          #define WS_NO_OP        0x00
     23          #define WS_REC          0x01
     24          #define WS_PLAY         0x02
     25          #define WS_ECHO         0x03
     26          #define WS_TONE         0x04
     27          #define WS_PORT1        0x05
     28           
     29          #define DAC0 (*(unsigned char xdata *) 0xA000)
     30          #define DAC1 (*(unsigned char xdata *) 0xA001)
     31          #define DAC2 (*(unsigned char xdata *) 0xA002)
     32          #define DAC3 (*(unsigned char xdata *) 0xA003)
     33          
     34          #define WAVBUFSIZE  512
     35          
     36          //#define SPEAKER_ON  P1.5 = 1
     37          //#define SPEAKER_OFF  P1.5 = 0
     38          
     39          ///////////////////////////////////
     40          // Strukturer
     41          
     42          
     43          ///////////////////////////////////
     44          // Funktioner och procedurer
     45          
     46          extern void    InitializeWAV( void );
     47          extern void    SetupMic( void );
     48          extern void    SetupPhoneIn( void );
     49          extern void    RecMicFile(const char* fileName);
     50          extern void    RecPhoneFile(const char* fileName);
     51          extern void    RecFile(const char* fileName);
     52          extern void    PlayFile(const char* fileName);
     53          extern void    EchoMic( void );
     54          extern void    EchoPhone( void );
     55          extern void    Echo( void );
     56          extern void    WavTone( void );
     57           
     58          #endif
     72          #include "DTMF.h"
      1          /*************************************************************
      2          Fil:            $Id: DTMF.h,v 1.2 2003/11/20 22:08:52 Gemensam Exp $
      3          
      4          Beskrivning:    Header fil till DTMF.c
      5          
      6          Skapad:         03-11-18
      7          
      8          Ändrad:         $Date: 2003/11/20 22:08:52 $
      9          
     10          Ägare:          Fredrik Hoffman
     11          
     12          
     13          Att göra:
     14          
     15          Revisionshistoria:
     16                                          $Log: DTMF.h,v $
     17                                          Revision 1.2  2003/11/20 22:08:52  Gemensam
     18                                          Various declarations changes.
     19                                          Still version 0200.
     20                                          
     21                                          Revision 1.1  2003/11/18 19:17:36  Gemensam
     22                                          Added menu option of setting speaker volume (untested)
     23                                          Completely changed header files
     24                                          Version 0200.
     25                                          
     26          
     27          *************************************************************/
     28          
     29          #ifndef _DTMF_INCLUDED_
     30          #define _DTMF_INCLUDED_
     31          
     32          ///////////////////////////////////
     33          // Definitioner
     34          
     35          #define DTMF_TRANS      (*(unsigned char xdata *) 0x9000)
     36          #define DTMF_READ       (*(unsigned char xdata *) 0x9000)
     37          #define DTMF_CONTROL    (*(unsigned char xdata *) 0x9001)
     38          #define DTMF_STATUS     (*(unsigned char xdata *) 0x9001)
     39           
     40          ///////////////////////////////////
     41          // Funktioner och procedurer
     42          
     43          extern void    InitializeDTMF( void );
     44          extern void    MakeDTMFTones(const char *tones);
     45          extern char    DecodeDTMF(char c);
     46          extern char    DecodeReceivedDTMF( void );
     47          extern void    ResetDTMFIndex( void );
     48          extern char    GetNextDTMF( void );
     49           
     50          #endif
     73          #include "Phone.h"
      1          /********************************************************
      2          Fil:            $Id: Phone.h,v 1.6 2003/12/26 16:17:01 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/12/26 16:17:01 $
      5          
      6          Revisionshistoria:
      7                                          $Log: Phone.h,v $
      8                                          Revision 1.6  2003/12/26 16:17:01  Gemensam
      9                                          Reinstate 500 ms wait for hang up detection to settle (if not PPD is used).
     10                                          Fixed PPD detection by decreasing phone volume from 63 to 15.
     11                                          Version 0304.
     12                                          
     13                                          Revision 1.5  2003/11/29 22:36:00  Gemensam
     14                                          Fixed problem with to short pulse width on PPD.
     15                                          Ver 0302.
     16                                          
     17                                          Revision 1.4  2003/11/24 22:44:36  Gemensam
     18                                          Fixed PPD, not working yet,
     19                                          New command: speaker volume.
     20                                          Version 0301.
     21                                          
     22                                          Revision 1.3  2003/11/23 21:40:03  Gemensam
     23                                          Parallell phone detection included.
     24                                          Removed obsolete #define's regarding LCD interface.
     25                                          Ver 0300
     26                                          
     27                                          Revision 1.2  2003/11/20 22:08:53  Gemensam
     28                                          Various declarations changes.
     29                                          Still version 0200.
     30                                          
     31                                          Revision 1.1  2003/11/18 19:17:36  Gemensam
     32                                          Added menu option of setting speaker volume (untested)
     33                                          Completely changed header files
     34                                          Version 0200.
     35                                          
     36                                          
     37          
     38          ********************************************************/
     39          
     40          #ifndef _PHONE_INCLUDED_
     41          #define _PHONE_INCLUDED_
     42          
     43          ///////////////////////////////////
     44          // Definitioner
     45          
     46          //PS = Phone Signals
     47          #define PS_RV                                           P1.2
     48          #define PS_LC                                           P1.7
     49          #define PS_LCD                                          P1.1
     50          #define PS_PPD                                          P1.0
     51          
     52          #define WRS_POS_EDGE_TRIGG          10
     53          #define WRS_NEG_EDGE_TRIGG          10
     54          #define WRS_POST_SIGNAL_LIMIT       20
     55          #define WRS_SIGNAL_MIN_INTERVALL    300
     56          #define WRS_SIGNAL_MAX_INTERVALL    600
     57          
     58          /* Examples of timeouts
     59          Lift phone:             Play:
     60          1E5                             11
     61          209                             163
     62          20C                             11
     63          200                             4
     64          216                             E8      
     65          1F3                             F5
     66          */
     67          
     68          #define P_PPD_PW                                        0x190
     69          #define P_RIPPLE_FILTER_TIMEOUT         10
     70          
     71          #define DEFAULT_PHONE_OUT_VOLUME        15
     72          
     73          ///////////////////////////////////
     74          // Strukturer
     75          
     76          
     77          ///////////////////////////////////
     78          // Funktioner och procedurer
     79          
     80          extern void    InitializePhone( void );
     81          extern void    HangUp( void );
     82          extern void    LiftPhone( void );
     83          
     84          #ifdef  __PPD_ON__
     85          extern void        ClearPPDRipple( void );
     86          #endif
     87          
     88          extern void    MonitorRingSignal( void );
     89          extern int         WaitForRingSignals(int  nSignals);
     90          
     91          #endif
     74          #include "Timer.h"
      1          /********************************************************
      2          Fil:            $Id: Timer.h,v 1.2 2003/11/20 22:08:53 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/11/20 22:08:53 $
      5          
      6          Revisionshistoria:
      7                                          $Log: Timer.h,v $
      8                                          Revision 1.2  2003/11/20 22:08:53  Gemensam
      9                                          Various declarations changes.
     10                                          Still version 0200.
     11                                          
     12                                          Revision 1.1  2003/11/18 19:17:36  Gemensam
     13                                          Added menu option of setting speaker volume (untested)
     14                                          Completely changed header files
     15                                          Version 0200.
     16                                          
     17                                          
     18          
     19          ********************************************************/
     20          
     21          #ifndef _TIMER_INCLUDED_
     22          #define _TIMER_INCLUDED_
     23          
     24          ///////////////////////////////////
     25          // Definitioner
     26          
     27          #define TM_MAX_TIMERS   5
     28          
     29          ///////////////////////////////////
     30          // Strukturer
     31          
     32          
     33          ///////////////////////////////////
     34          // Funktioner och procedurer
     35          
     36          extern void    InitializeTimer( void );
     37          extern char    StartTimer(unsigned int tenMillisecTimeout);
     38          extern void    KillTimer(char  timerIndex);
     39          extern char    TimedOut(char timerIndex);
     40          extern void    WaitFor(unsigned int tenMillisec);
     41           
     42          #endif
     75          #include "DPOT.h"
      1          /*************************************************************
      2          Fil:            $Id: DPot.h,v 1.2 2003/11/20 22:08:52 Gemensam Exp $
      3          
      4          Beskrivning:    Header fil till DPot.c
      5          
      6          Skapad:         03-11-17
      7          
      8          Ändrad:         $Date: 2003/11/20 22:08:52 $
      9          
     10          Ägare:          Fredrik Hoffman
     11          
     12          
     13          Att göra:
     14          
     15          Kommentarer:
     16          
     17              Varje pot har fyra nonvolatile register. Dessa definieras härmed enligt följande:
     18              *   0 = Zero Wiper  = 0
     19              *   1 = Variable Wiper  = ?
     20              *   2 = Oanvänd = X
     21              *   3 = Full Wiper = 255
     22              Vid initialiseringen skall värden för Zero och Full skrivas in i NV-registererna
     23              Sedan skall Wiper på alla pottar sättas till Zero.
     24          
     25          Revisionshistoria:
     26                                          $Log: DPot.h,v $
     27                                          Revision 1.2  2003/11/20 22:08:52  Gemensam
     28                                          Various declarations changes.
     29                                          Still version 0200.
     30                                          
     31                                          Revision 1.1  2003/11/18 19:17:36  Gemensam
     32                                          Added menu option of setting speaker volume (untested)
     33                                          Completely changed header files
     34                                          Version 0200.
     35                                          
     36          
     37          *************************************************************/
     38          
     39          #ifndef _DPOT_INCLUDED_
     40          #define _DPOT_INCLUDED_
     41          
     42          ///////////////////////////////////
     43          // Definitioner
     44          
     45          #define DPCL    P3.3
     46          #define DPDA    P3.4
     47           
     48          #define POT_PHONE_OUT   0x00
     49          #define POT_PHONE_IN    0x03
     50          #define POT_SPEAKER     0x01
     51          #define POT_DTMF        0x02
     52          
     53          #define DEFAULT_SPEAKER_VOLUME  50
     54          
     55          ///////////////////////////////////
     56          // Funktioner och procedurer
     57          
     58          extern void    InitializeDPot( void );
     59          extern void    RPWait( void );
     60          extern char    WOEPB(char dat);
     61          extern char    ROEPB(char ack);
     62          extern char    SetDPWiper(char pot, char value);
     63          extern char    ReadDPWiper(char pot, char* dat);
     64           
     65          extern void    SpeakerVolume(char volume);
     66          extern void    PhoneInVolume(char volume);
     67          extern void    PhoneOutVolume(char volume);
     68          extern void    DTMFVolume(char volume);
     69          
     70          #endif
     76          #include "LCD.h"
      1          /********************************************************
      2          Fil:            $Id: LCD.h,v 1.4 2003/11/23 21:40:03 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/11/23 21:40:03 $
      5          
      6          Revisionshistoria:
      7                                          $Log: LCD.h,v $
      8                                          Revision 1.4  2003/11/23 21:40:03  Gemensam
      9                                          Parallell phone detection included.
     10                                          Removed obsolete #define's regarding LCD interface.
     11                                          Ver 0300
     12                                          
     13                                          Revision 1.3  2003/11/23 20:29:34  Gemensam
     14                                          Complete and tested volume setting in options menu.
     15                                          Ver 0201
     16                                          
     17                                          Revision 1.2  2003/11/20 22:08:53  Gemensam
     18                                          Various declarations changes.
     19                                          Still version 0200.
     20                                          
     21                                          Revision 1.1  2003/11/18 19:17:36  Gemensam
     22                                          Added menu option of setting speaker volume (untested)
     23                                          Completely changed header files
     24                                          Version 0200.
     25                                          
     26                                          
     27          
     28          ********************************************************/
     29          
     30          #ifndef _LCD_INCLUDED_
     31          #define _LCD_INCLUDED_
     32          
     33          ///////////////////////////////////
     34          // Definitioner
     35          
     36          #define LCD_DATA      (*(unsigned char xdata *) 0x8000)
     37          #define LCD_INSTR     (*(unsigned char xdata *) 0x8001)
     38          #define LCD_BUSY      (*(unsigned char xdata *) 0x8001)
     39          
     40          #define DISPBUFFERSIZE  50
     41          // DISPBUFFERSIZE är antalet samtal i dispBuffer (samtalsindexerat)
     42          #define DISPCALLSIZE  40
     43          // DISPCALLSIZE är antalet byte per samtalsrad
     44           
     45          #define LCD_CHAR_PER_ROW        42
     46          
     47          #define MENU_LEFT_COLUMN        4
     48          
     49          #define MENU_ITEM_SPKR_VOL      0
     50          #define MENU_ITEM_ANS_ONOFF     1
     51          #define MENU_ITEM_MEMO          2
     52          #define MENU_ITEM_TIMEDATE      3
     53          #define MENU_ITEM_NUMSIG        4
     54          #define MENU_ITEM_ERASE         5
     55          #define MENU_NUM_OF_ITEMS       6
     56          
     57          
     58          ///////////////////////////////////
     59          // Strukturer
     60          
     61          
     62          ///////////////////////////////////
     63          // Funktioner och procedurer
     64          
     65          extern void    InitializeLCD( void );
     66          extern void    ClearDisp( void );
     67          extern void    DispString(char* str);
     68          extern void    SetLCDReg(char regNr, char d);
     69          extern void    LogCursorAt(int newCursorPos, char updateAlways);
     70          extern void    FillDispBuffer(void);
     71          extern void    DispInfoBox(char* str1, char* str2);
     72          extern void    DisplayMenu(char* menuStr);
     73          extern void    DispMemUsage( void );
     74          extern void    OptionCursorAt(int  newCursorPos);
     75          extern void    DispOptionsMenu(char answerOn, char numSignals);
     76          extern void    DispSetTimeDate(char cursor, char year, char month, char day, char hour, char minute);
     77          extern void    DispSetTimeDateHead( void );
     78          extern void    DispEraseQuest( void );
     79          extern void    DispMemoScreen( void );
     80          
     81          #endif
     77          #include "LogFile.h"
      1          /********************************************************
      2          Fil:            $Id: LogFile.h,v 1.2 2003/11/20 22:08:53 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/11/20 22:08:53 $
      5          
      6          Revisionshistoria:
      7                                          $Log: LogFile.h,v $
      8                                          Revision 1.2  2003/11/20 22:08:53  Gemensam
      9                                          Various declarations changes.
     10                                          Still version 0200.
     11                                          
     12                                          Revision 1.1  2003/11/18 19:17:36  Gemensam
     13                                          Added menu option of setting speaker volume (untested)
     14                                          Completely changed header files
     15                                          Version 0200.
     16                                          
     17                                          
     18          
     19          ********************************************************/
     20          
     21          #ifndef _LOGFILE_INCLUDED_
     22          #define _LOGFILE_INCLUDED_
     23          
     24          #include "FileSystem.h"
      1          /**************************************************************************************
      2          Fil:            $Id: FileSystem.h,v 1.4 2003/11/20 22:08:53 Gemensam Exp $
      3          
      4          Ändrad:         $Date: 2003/11/20 22:08:53 $
      5          
      6          Kommentarer:    Filhuvudet befinner sig i "Spare" arean tillhörande filens första sida. Huvudet består 
      7                                          av 16 bytes enligt följande lista:
      8                                          0       Huvud       0xAA = Legalt filhuvud, annat tillsvidare odefinierat
      9                                          1-4     Fillängd    Pos 1 = MSB, pos 4 = LSB
     10                                          5-12    Filtitel    Enl "Titel.ext". Om titeln är mindre än 8 tecken avslutas det med nollor
     11                                          13-15   Filext      Enl "Titel.ext". Om ext är mindre än 3 tecken avslutas det med nollor
     12          
     13                                          En nolla skriven i fileName[0] indikerar att
     14                                          filstrukturen är ledig.
     15                  
     16          Revisionshistoria:
     17                                          $Log: FileSystem.h,v $
     18                                          Revision 1.4  2003/11/20 22:08:53  Gemensam
     19                                          Various declarations changes.
     20                                          Still version 0200.
     21                                          
     22                                          Revision 1.3  2003/11/18 19:17:36  Gemensam
     23                                          Added menu option of setting speaker volume (untested)
     24                                          Completely changed header files
     25                                          Version 0200.
     26                                          
     27                                          Revision 1.2  2003/11/10 22:44:45  Gemensam
     28                                          Added header information
     29                                          
     30          
     31          **************************************************************************************/
     32          
     33          #ifndef _FILESYSTEM_INCLUDED_
     34          #define _FILESYSTEM_INCLUDED_
     35          
     36          ///////////////////////////////////
     37          // Definitioner
     38          
     39          #define FS_MAXFILES         8 
     40          #define FS_FILENAMELENGTH   13
     41          #define FS_FLASHSIZE        0x800000
     42          
     43          #define OFF            0
     44          #define READY        1
     45          #define NEMPTY        2
     46          #define WRITING        3
     47          #define OCCUPIED    4
     48          
     49          #define CLE     P4.0                                //Command Latch Enable
     50          #define ALE     P4.1                                //Address Latch Enable
     51          #define WP      P4.2                                //Write Protect
     52          #define SE      P4.3                                //Spare Enable
     53          //#define CE      P4.4                                //Chip Enable
     54          #define FBUSY   P4.5                                //Busy
     55          
     56          #define FREG (*(unsigned char xdata *) 0xE000)
     57          #define FLASH (*(unsigned char xdata *) 0xB000) 
     58          
     59          ///////////////////////////////////
     60          // Strukturer
     61          
     62          struct ST_FILE_HEAD {
     63              unsigned long   length;
     64              char            name[FS_FILENAMELENGTH];
     65          };
     66          #define FILE_HEAD struct ST_FILE_HEAD
     67          
     68          
     69          struct ST_FILE {
     70              char            fileName[FS_FILENAMELENGTH];
     71              unsigned long   startAddress;
     72              unsigned long   length; 
     73              unsigned long   offset; 
     74              char            write;
     75              char            append;
     76          };
     77          #define FILE struct ST_FILE 
     78          
     79          
     80          
     81          ///////////////////////////////////
     82          // Funktioner och procedurer
     83          
     84          extern void            InitializeFileSystem( void );
     85          extern void            InitializeFlash( void );
     86          extern void            SetupReadSeq( void );
     87          extern unsigned char   ReadFLASH( void );
     88          extern void            TerminateReadSeq( void );
     89          extern void            GetDeviceIDRS232(void);
     90          extern void            SetupWriteSeq( void );
     91          extern void            WriteFLASH(unsigned char);
     92          extern void            TerminateWriteSeq( void );
     93          extern void            PerformWriteSeq( void );
     94          extern void            EraseBlock( void );
     95          extern void            WriteFileHead(const char* name, long size);
     96          extern FILE*           fopen(const char* name, const char* def);
     97          extern FILE*               fopenA(const char* name, long maxSize, long offset);
     98          extern void            fputc(FILE* filePtr, char c);
     99          extern void            fputLine(FILE* filePtr, const char* str);
    100          extern void            fupLoad( void );
    101          extern int             fgetc(FILE* filePtr);
    102          extern void            fgetLine(FILE* filePtr, char* str, int maxLen);
    103          extern void            fdownLoad( void );
    104          extern void            fclose(FILE* filePtr);
    105          extern long            ftell(FILE* filePtr);
    106          //void            Rewind(FILE* filePtr);
    107          extern void            fSetPos(FILE* filePtr, long offset);
    108          extern void            ReleaseCurrFile( void );
    109          extern void            EraseAll( void );
    110          extern void            StartDynamic( void );
    111          extern void            EraseDynamic( void );
    112          extern char                        MemUsage( void );
    113          extern void                        Dir( void );
    114          extern void                        Type( void );
    115          extern void                        TypeA( void );
    116          
    117          #endif
     25          
     26          ///////////////////////////////////
     27          // Definitioner
     28          
     29          #define MS_LOG          0x01
     30          #define MS_MENU         0x02
     31          #define MS_TIMEDATE     0x03
     32          #define MS_ERASEQST     0x04
     33          
     34          ///////////////////////////////////
     35          // Strukturer
     36          
     37          
     38          ///////////////////////////////////
     39          // Funktioner och procedurer
     40          
     41          extern void    InitializeLogFile( void );
     42          extern void    CreateLog( void );
     43          extern void    LogMessage(const char* str1, const char* str2);
     44          extern char    BuildCallerList( void );
     45          extern char    FindCall(FILE* fp, int index);
     46          extern char    FindNextCall(FILE* fp);
     47          extern void    GetCallInformation(FILE* fp, char* phoneNumber, char* time, int* noOfMessages);
     48          extern char    PlayThisCall(int callIndex);
     49          extern void    PlayNewMessages( void );
     50          
     51          #endif
     78          #include "Keyboard.h"
      1          /*************************************************************
      2          Fil:            $Id: Keyboard.h,v 1.2 2003/11/20 22:08:53 Gemensam Exp $
      3          
      4          Beskrivning:    Header fil till Keyboard.c
      5          
      6          Skapad:         03-11-18
      7          
      8          Ändrad:         $Date: 2003/11/20 22:08:53 $
      9          
     10          Ägare:          Fredrik Hoffman
     11          
     12          
     13          Att göra:
     14          
     15          Kommentarer:
     16          
     17          Revisionshistoria:
     18                                          $Log: Keyboard.h,v $
     19                                          Revision 1.2  2003/11/20 22:08:53  Gemensam
     20                                          Various declarations changes.
     21                                          Still version 0200.
     22                                          
     23                                          Revision 1.1  2003/11/18 19:17:36  Gemensam
     24                                          Added menu option of setting speaker volume (untested)
     25                                          Completely changed header files
     26                                          Version 0200.
     27                                          
     28          
     29          *************************************************************/
     30          
     31          #ifndef _KEYBOARD_INCLUDED_
     32          #define _KEYBOARD_INCLUDED_
     33          
     34          ///////////////////////////////////
     35          // Definitioner
     36          
     37          #define KEYBOARD    (*(unsigned char xdata *) 0xC000)
     38          #define KEY_CLK     P1.6
     39          #define KEY_IRQ     P1.4
     40          
     41          #define KS_IDLE         0x00
     42          #define KS_WAITFIRST    0x01
     43          #define KS_WAITMULTI    0x02
     44          
     45          #define FIRST_KEY_TIMEOUT   10
     46          #define MULTI_KEY_TIMEOUT   2
     47           
     48          
     49          ///////////////////////////////////
     50          // Funktioner och procedurer
     51          
     52          extern void    InitializeKeyboard( void );
     53          extern void    KeyboardOn( void );
     54          extern void    KeyboardOff( void );
     55           
     56          #endif
     79          
     80          
     81          //////////////////////
     82          // Globala variabler
     83          
     84          extern xdata char       terminateAnswer;
     85          extern xdata char       speakerVolume;
     86          extern xdata char       receivedDTMF;           //Innehåller den senaste mottagna DTMF-signalen
     87                                                                                          //från avbrottsrutinen. Om inget tagits emot sätts
     88                                                                                          //den till 0. För att få ett användbart värde skall
     89                                                                                          //funktionen DecodeDTMF() köras.
     90          extern xdata char       lastKey;
     91          extern xdata long       logOffset;                      //Nästa skrivposition i Log-filen
     92          extern xdata int        callIndex[1024];        //Innehåller positionen i logfilen där resp
     93                                                                                          //samtalsnummer ligger. Index 0 är det äldsta 
     94                                                                                          //samtalet, 1 är det näst äldsta osv (kronologindexerad)
     95          extern xdata char       msg[100];
     96          extern xdata char       commandLine[CM_PARSIZE][CM_NRPAR];      //Här lagras kommandot och alla parametrar
     97                                                                                          //Varje kommando/parameter får vara max cmParSize tecken
     98                                                                                          //Till varje kommando kan cmNrPar-1 kopplas
     99          extern xdata int        nrCommandParameters;//Här anges antal strängar kommandot bygger upp (dvs
    100                                                                                          //antal parametrar + 1 för kommandot)
    101          extern xdata int        error;                          //Error-kod, se definitioner ovan
    102           
    103          xdata char                      answerOn;
    104          xdata int                       numOfCalls;
    105          xdata int                       lastPlayed;                     //Kronologindexerad
    106          //xdata FILE*   logFilePtr;
    107          xdata char                      callerCategory;
    108          xdata int                       nextMemoIndex;          //Indexet till det senaste Memo:et, kan också
    109                                                                                          //ses som antal inspelade memo:n.
    110          //////////////////////
    111          // Lokala variabler
    112          
    113          xdata char                      labDTMF[MAX_LABEL_LEN];
    114          xdata char                      lab0[MAX_LABEL_LEN];
    115          xdata char                      lab1[MAX_LABEL_LEN];
    116          xdata char                      lab2[MAX_LABEL_LEN];
    117          xdata char                      lab3[MAX_LABEL_LEN];
    118          xdata char                      lab4[MAX_LABEL_LEN];
    119          xdata char                      lab5[MAX_LABEL_LEN];
    120          xdata char                      lab6[MAX_LABEL_LEN];
    121          xdata char                      lab7[MAX_LABEL_LEN];
    122          xdata char                      lab8[MAX_LABEL_LEN];
    123          xdata char                      lab9[MAX_LABEL_LEN];
    124          xdata char                      labPound[MAX_LABEL_LEN];
    125          xdata char                      labStar[MAX_LABEL_LEN];
    126          xdata char                      labCorrectc[MAX_LABEL_LEN];
    127          xdata char                      labIncorrectc[MAX_LABEL_LEN];
    128          xdata char                      labTimeout[MAX_LABEL_LEN];
    129          xdata char                      labHungUp[MAX_LABEL_LEN];
    130          xdata unsigned int      timeoutValue;
    131          //xdata int                     screenStart;
    132          xdata int                       cursor;                                                         //Samtalsindexerad
    133          xdata char                      menuSelection;
    134          xdata char                      numSignals;
    135          xdata DATE                      dateNow;
    136          xdata char                      year;
    137          xdata char                      month;
    138          xdata char                      date;
    139          xdata TIME                      timeNow;
    140          xdata char                      hour;
    141          xdata char                      minute;
    142          xdata char                      timCur;
    143          xdata char                      PBSpace[PB_MAXENTRIES * PB_POSTSIZE];   //PhoneBook filspegling
    144          xdata int                       pbNEntries;
    145          xdata char                      callerName[20];
    146          //xdata char            recMsgs[1024];
    147          
    148          
    149          //////////////////////
    150          // Kod
    151          
    152          void    InitializePhoneAns( void )
    153          {       
   \   0000            InitializePhoneAns:
   \   0000  900000            MOV     DPTR,#$LOCBX InitializePhoneAns
   \   0003  D0E0              POP     ACC
   \   0005  F0                MOVX    @DPTR,A
   \   0006  A3                INC     DPTR
   \   0007  D0E0              POP     ACC
   \   0009  F0                MOVX    @DPTR,A
    154          //    SendStringRS232("Calls: ");
    155          //    myInt2DecStr(numOfCalls, msg);
    156          //    SendStringEOLRS232(msg);
    157              ReadPhoneBookFile();
   \   000A  120000            LCALL   $REFFN ReadPhoneBookFile
    158          }
   \   000D  900000            MOV     DPTR,#$LOCBX InitializePhoneAns
   \   0010  E0                MOVX    A,@DPTR
   \   0011  F8                MOV     R0,A
   \   0012  A3                INC     DPTR
   \   0013  E0                MOVX    A,@DPTR
   \   0014  C0E0              PUSH    ACC
   \   0016  E8                MOV     A,R0
   \   0017  C0E0              PUSH    ACC
   \   0019  22                RET
    159          
    160          
    161          
    162          
    163          void    WaitForCall( void )
    164          /*
    165          Kommandorad:
    166          
    167          WAITCALL LS=SUCCESS_LABEL LT=TIMEOUT_LABEL
    168          
    169          */
    170          {
   \   001A            WaitForCall:
   \   001A  900000            MOV     DPTR,#$LOCBX WaitForCall+73
   \   001D  D0E0              POP     ACC
   \   001F  F0                MOVX    @DPTR,A
   \   0020  A3                INC     DPTR
   \   0021  D0E0              POP     ACC
   \   0023  F0                MOVX    @DPTR,A
    171              xdata char    DTMFString[40];
    172              xdata int     i;
    173              xdata int     j;
    174              xdata char    c;
    175              xdata char    timeStr[15];
    176              xdata char    menuState;
    177              xdata DATE    dateNow;
    178              xdata TIME    timeNow;
    179              xdata char    timer;
    180              xdata char    legalCallNumber;
    181              xdata FILE*   df;
    182           
    183              PhoneInVolume(63);
   \   0024  7C3F              MOV     R4,#63
   \   0026  120000            LCALL   $REFFN PhoneInVolume
    184               
    185              SendStringEOLRS232("Init waitcall...");
   \   0029  7D00              MOV     R5,#LOW(?0000)
   \   002B  7E00              MOV     R6,#HIGH(?0000)
   \   002D  7F02              MOV     R7,#2
   \   002F  120000            LCALL   $REFFN SendStringEOLRS232
    186              ClearDisp();
   \   0032  120000            LCALL   $REFFN ClearDisp
    187              DispInfoBox("Initializing answering machine", "Please wait...");
   \   0035  7F02              MOV     R7,#2
   \   0037  900000            MOV     DPTR,#$PRMBX DispInfoBox+3
   \   003A  EF                MOV     A,R7
   \   003B  F0                MOVX    @DPTR,A
   \   003C  A3                INC     DPTR
   \   003D  7400              MOV     A,#HIGH(?0002)
   \   003F  F0                MOVX    @DPTR,A
   \   0040  A3                INC     DPTR
   \   0041  7430              MOV     A,#LOW(?0002)
   \   0043  F0                MOVX    @DPTR,A
   \   0044  7D11              MOV     R5,#LOW(?0001)
   \   0046  7E00              MOV     R6,#HIGH(?0001)
   \   0048  120000            LCALL   $REFFN DispInfoBox
    188          
    189              if (BuildCallerList()) {
   \   004B  120000            LCALL   $REFFN BuildCallerList
   \   004E  EC                MOV     A,R4
   \   004F  604A              JZ      ?0004
   \   0051            ?0003:
    190                  ReadCalenderByte(NV_PLAYED_MS, &c);
   \   0051  7D00              MOV     R5,#LOW ($LOCBX WaitForCall+44)
   \   0053  7E00              MOV     R6,#HIGH ($LOCBX WaitForCall+44)
   \   0055  7F01              MOV     R7,#1
   \   0057  7C0A              MOV     R4,#10
   \   0059  120000            LCALL   $REFFN ReadCalenderByte
    191                  lastPlayed = c << 8;
   \   005C  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   005F  E0                MOVX    A,@DPTR
    192                  ReadCalenderByte(NV_PLAYED_LS, &c);
   \   0060  900003            MOV     DPTR,#lastPlayed
   \   0063  F0                MOVX    @DPTR,A
   \   0064  A3                INC     DPTR
   \   0065  E4                CLR     A
   \   0066  F0                MOVX    @DPTR,A
   \   0067  7D00              MOV     R5,#LOW ($LOCBX WaitForCall+44)
   \   0069  7E00              MOV     R6,#HIGH ($LOCBX WaitForCall+44)
   \   006B  7F01              MOV     R7,#1
   \   006D  7C0B              MOV     R4,#11
   \   006F  120000            LCALL   $REFFN ReadCalenderByte
    193                  lastPlayed += c;
   \   0072  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0075  E0                MOVX    A,@DPTR
   \   0076  7D00              MOV     R5,#0
   \   0078  FC                MOV     R4,A
   \   0079  900004            MOV     DPTR,#lastPlayed+1
   \   007C  E0                MOVX    A,@DPTR
   \   007D  2C                ADD     A,R4
   \   007E  F0                MOVX    @DPTR,A
   \   007F  900003            MOV     DPTR,#lastPlayed
   \   0082  E0                MOVX    A,@DPTR
   \   0083  3D                ADDC    A,R5
   \   0084  F0                MOVX    @DPTR,A
    194                  if (lastPlayed == 0xFFFF) lastPlayed = -1;
   \   0085  A3                INC     DPTR
   \   0086  E0                MOVX    A,@DPTR
   \   0087  04                INC     A
   \   0088  7005              JNZ     ?0553
   \   008A  900003            MOV     DPTR,#lastPlayed
   \   008D  E0                MOVX    A,@DPTR
   \   008E  04                INC     A
   \   008F            ?0553:
   \   008F  7008              JNZ     ?0006
   \   0091            ?0005:
   \   0091  900003            MOV     DPTR,#lastPlayed
   \   0094  74FF              MOV     A,#255
   \   0096  F0                MOVX    @DPTR,A
   \   0097  A3                INC     DPTR
   \   0098  F0                MOVX    @DPTR,A
   \   0099            ?0006:
    195              } else {
   \   0099  801F              SJMP    ?0007
   \   009B            ?0004:
    196                  lastPlayed = -1;
   \   009B  900003            MOV     DPTR,#lastPlayed
   \   009E  74FF              MOV     A,#255
   \   00A0  F0                MOVX    @DPTR,A
   \   00A1  A3                INC     DPTR
   \   00A2  F0                MOVX    @DPTR,A
    197                  WriteCalenderByte(NV_PLAYED_MS, 0xFF);
   \   00A3  FD                MOV     R5,A
   \   00A4  7C0A              MOV     R4,#10
   \   00A6  120000            LCALL   $REFFN WriteCalenderByte
    198                  WriteCalenderByte(NV_PLAYED_LS, 0xFF);
   \   00A9  7DFF              MOV     R5,#255
   \   00AB  7C0B              MOV     R4,#11
   \   00AD  120000            LCALL   $REFFN WriteCalenderByte
    199                  WriteCalenderByte(0x07, 0x80);          //Släck diod
   \   00B0  7D80              MOV     R5,#128
   \   00B2  7C07              MOV     R4,#7
   \   00B4  120000            LCALL   $REFFN WriteCalenderByte
    200                  CreateLog();
   \   00B7  120000            LCALL   $REFFN CreateLog
   \   00BA            ?0007:
    201              }
    202              terminateAnswer = 0;
   \   00BA  E4                CLR     A
   \   00BB  900000            MOV     DPTR,#terminateAnswer
   \   00BE  F0                MOVX    @DPTR,A
    203                  
    204              SetupUpQLabels();
   \   00BF  120000            LCALL   $REFFN SetupUpQLabels
    205              
    206              KeyboardOn();
   \   00C2  120000            LCALL   $REFFN KeyboardOn
    207              
    208              ReadCalenderByte(NV_ANSWERING_ON, &answerOn);
   \   00C5  7D00              MOV     R5,#LOW(answerOn)
   \   00C7  7E00              MOV     R6,#HIGH(answerOn)
   \   00C9  7F01              MOV     R7,#1
   \   00CB  7C08              MOV     R4,#8
   \   00CD  120000            LCALL   $REFFN ReadCalenderByte
    209              if (answerOn) P3.5 = 0;
   \   00D0  900000            MOV     DPTR,#answerOn
   \   00D3  E0                MOVX    A,@DPTR
   \   00D4  6004              JZ      ?0009
   \   00D6            ?0008:
   \   00D6  C2B5              CLR     P3.5
   \   00D8  8002              SJMP    ?0010
   \   00DA            ?0009:
    210              else P3.5 = 1;
   \   00DA  D2B5              SETB    P3.5
   \   00DC            ?0010:
    211              ReadCalenderByte(NV_NUM_SIGNALS, &numSignals);
   \   00DC  7D95              MOV     R5,#LOW(numSignals)
   \   00DE  7E00              MOV     R6,#HIGH(numSignals)
   \   00E0  7F01              MOV     R7,#1
   \   00E2  7C09              MOV     R4,#9
   \   00E4  120000            LCALL   $REFFN ReadCalenderByte
    212          
    213                  ReadCalenderByte(NV_SPEAKER_VOL, &speakerVolume);
    214              
   \   00E7  7D00              MOV     R5,#LOW(speakerVolume)
   \   00E9  7E00              MOV     R6,#HIGH(speakerVolume)
   \   00EB  7F01              MOV     R7,#1
   \   00ED  7C0C              MOV     R4,#12
   \   00EF  120000            LCALL   $REFFN ReadCalenderByte
    215          //    SendStringRS232("Num signals: ");
    216          //    SendRS232('0' + numSignals);
    217          //    SendStringEOLRS232(" ");
    218              
    219              legalCallNumber = 0;
    220          
    221              SendStringEOLRS232("Init waitcall done");
   \   00F2  7D3F              MOV     R5,#LOW(?0011)
   \   00F4  7E00              MOV     R6,#HIGH(?0011)
   \   00F6  7F02              MOV     R7,#2
   \   00F8  120000            LCALL   $REFFN SendStringEOLRS232
    222          
    223              menuSelection = 0;
    224              menuState = MS_LOG;
   \   00FB  E4                CLR     A
   \   00FC  900094            MOV     DPTR,#menuSelection
   \   00FF  F0                MOVX    @DPTR,A
    225          
    226              ClearDisp();
   \   0100  120000            LCALL   $REFFN ClearDisp
    227              FillDispBuffer();
   \   0103  120000            LCALL   $REFFN FillDispBuffer
    228           
    229              cursor = 0;
   \   0106  900092            MOV     DPTR,#cursor
   \   0109  E4                CLR     A
   \   010A  F0                MOVX    @DPTR,A
   \   010B  A3                INC     DPTR
   \   010C  F0                MOVX    @DPTR,A
    230              LogCursorAt(0, 1);
   \   010D  7E01              MOV     R6,#1
   \   010F  FD                MOV     R5,A
   \   0110  FC                MOV     R4,A
   \   0111  120000            LCALL   $REFFN LogCursorAt
    231              DispMemUsage();
   \   0114  120000            LCALL   $REFFN DispMemUsage
    232              DisplayMenu("  PLAY     UP     DOWN    MENU   PLAY NEW");
   \   0117  7D52              MOV     R5,#LOW(?0012)
   \   0119  7E00              MOV     R6,#HIGH(?0012)
   \   011B  7F02              MOV     R7,#2
   \   011D  120000            LCALL   $REFFN DisplayMenu
   \   0120  E4                CLR     A
   \   0121  900000            MOV     DPTR,#$LOCBX WaitForCall+69
   \   0124  F0                MOVX    @DPTR,A
   \   0125  04                INC     A
   \   0126  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   0129  F0                MOVX    @DPTR,A
   \   012A            ?0015:
    233              
    234              do {    
    235                  receivedDTMF = 0;
   \   012A  E4                CLR     A
   \   012B  900000            MOV     DPTR,#receivedDTMF
   \   012E  F0                MOVX    @DPTR,A
    236                  ResetDTMFIndex();
   \   012F  120000            LCALL   $REFFN ResetDTMFIndex
   \   0132            ?0017:
    237           
    238                  while (!receivedDTMF) {
   \   0132  900000            MOV     DPTR,#receivedDTMF
   \   0135  E0                MOVX    A,@DPTR
   \   0136  6003              JZ      $+5
   \   0138  020A8B            LJMP    ?0016
   \   013B            ?0018:
    239                      //Huvudloop för menysystem och knapptryckningar
    240          
    241                      WDT = 1;
   \   013B  D2AE              SETB    IE.6
    242                      SWDT = 1;
   \   013D  D2BE              SETB    IP.6
   \   013F            ?0020:
    243                  
    244                      while ((!receivedDTMF) && (!lastKey)) {
   \   013F  900000            MOV     DPTR,#receivedDTMF
   \   0142  E0                MOVX    A,@DPTR
   \   0143  700C              JNZ     ?0019
   \   0145  900000            MOV     DPTR,#lastKey
   \   0148  E0                MOVX    A,@DPTR
   \   0149  7006              JNZ     ?0019
   \   014B            ?0023:
   \   014B            ?0022:
   \   014B            ?0021:
    245                          WDT = 1;
   \   014B  D2AE              SETB    IE.6
    246                          SWDT = 1;
   \   014D  D2BE              SETB    IP.6
   \   014F  80EE              SJMP    ?0020
   \   0151            ?0019:
    247                      }
    248                      switch (menuState) {
   \   0151  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   0154  E0                MOVX    A,@DPTR
   \   0155  120000            LCALL   ?A_S_SWITCH_L05
   \   0158  01                DB      1
   \   0159  04                DB      4
   \   015A  0A83              DW      ?0024
   \   015C  0166              DW      ?0025
   \   015E  0289              DW      ?0045
   \   0160  04E6              DW      ?0103
   \   0162  08B1              DW      ?0167
   \   0164  0A28              DW      ?0183
   \   0166            ?0025:
    249                      case MS_LOG :
    250                          if (lastKey == 1) {
   \   0166  900000            MOV     DPTR,#lastKey
   \   0169  E0                MOVX    A,@DPTR
   \   016A  14                DEC     A
   \   016B  703B              JNZ     ?0027
   \   016D            ?0026:
    251                              PlayThisCall(numOfCalls - cursor - 1);
   \   016D  900001            MOV     DPTR,#numOfCalls
   \   0170  E0                MOVX    A,@DPTR
   \   0171  FD                MOV     R5,A
   \   0172  A3                INC     DPTR
   \   0173  E0                MOVX    A,@DPTR
   \   0174  C3                CLR     C
   \   0175  900093            MOV     DPTR,#cursor+1
   \   0178  FE                MOV     R6,A
   \   0179  E0                MOVX    A,@DPTR
   \   017A  CE                XCH     A,R6
   \   017B  9E                SUBB    A,R6
   \   017C  FC                MOV     R4,A
   \   017D  900092            MOV     DPTR,#cursor
   \   0180  E0                MOVX    A,@DPTR
   \   0181  FE                MOV     R6,A
   \   0182  ED                MOV     A,R5
   \   0183  9E                SUBB    A,R6
   \   0184  FD                MOV     R5,A
   \   0185  EC                MOV     A,R4
   \   0186  24FF              ADD     A,#255
   \   0188  FC                MOV     R4,A
   \   0189  ED                MOV     A,R5
   \   018A  34FF              ADDC    A,#255
   \   018C  FD                MOV     R5,A
   \   018D  120000            LCALL   $REFFN PlayThisCall
    252                              receivedDTMF = 0;
   \   0190  E4                CLR     A
   \   0191  900000            MOV     DPTR,#receivedDTMF
   \   0194  F0                MOVX    @DPTR,A
    253                              ResetDTMFIndex();
   \   0195  120000            LCALL   $REFFN ResetDTMFIndex
    254                              LogCursorAt(cursor, 1);
   \   0198  900092            MOV     DPTR,#cursor
   \   019B  E0                MOVX    A,@DPTR
   \   019C  FD                MOV     R5,A
   \   019D  A3                INC     DPTR
   \   019E  E0                MOVX    A,@DPTR
   \   019F  FC                MOV     R4,A
   \   01A0  7E01              MOV     R6,#1
   \   01A2  120000            LCALL   $REFFN LogCursorAt
   \   01A5  020286            LJMP    ?0028
   \   01A8            ?0027:
    255                          } else if (lastKey == 2) {
   \   01A8  E0                MOVX    A,@DPTR
   \   01A9  B4022A            CJNE    A,#2,?0030
   \   01AC            ?0029:
    256                              if (cursor > 0) {
   \   01AC  D3                SETB    C
   \   01AD  900093            MOV     DPTR,#cursor+1
   \   01B0  E0                MOVX    A,@DPTR
   \   01B1  9400              SUBB    A,#0
   \   01B3  900092            MOV     DPTR,#cursor
   \   01B6  E0                MOVX    A,@DPTR
   \   01B7  6480              XRL     A,#128
   \   01B9  9480              SUBB    A,#128
   \   01BB  4016              JC      ?0032
   \   01BD            ?0031:
    257                                  cursor--;
   \   01BD  A3                INC     DPTR
   \   01BE  E0                MOVX    A,@DPTR
   \   01BF  24FF              ADD     A,#255
   \   01C1  F0                MOVX    @DPTR,A
   \   01C2  900092            MOV     DPTR,#cursor
   \   01C5  E0                MOVX    A,@DPTR
   \   01C6  34FF              ADDC    A,#255
   \   01C8  F0                MOVX    @DPTR,A
    258                                  LogCursorAt(cursor, 0);
   \   01C9  E0                MOVX    A,@DPTR
   \   01CA  FD                MOV     R5,A
   \   01CB  A3                INC     DPTR
   \   01CC  E0                MOVX    A,@DPTR
   \   01CD  FC                MOV     R4,A
   \   01CE  7E00              MOV     R6,#0
   \   01D0  120000            LCALL   $REFFN LogCursorAt
   \   01D3            ?0032:
   \   01D3  020286            LJMP    ?0033
   \   01D6            ?0030:
    259                              }
    260                          } else if (lastKey == 4) {
   \   01D6  B40439            CJNE    A,#4,?0035
   \   01D9            ?0034:
    261                              if (cursor < numOfCalls-1) {
   \   01D9  900002            MOV     DPTR,#numOfCalls+1
   \   01DC  E0                MOVX    A,@DPTR
   \   01DD  24FF              ADD     A,#255
   \   01DF  FC                MOV     R4,A
   \   01E0  900001            MOV     DPTR,#numOfCalls
   \   01E3  E0                MOVX    A,@DPTR
   \   01E4  34FF              ADDC    A,#255
   \   01E6  FD                MOV     R5,A
   \   01E7  900093            MOV     DPTR,#cursor+1
   \   01EA  E0                MOVX    A,@DPTR
   \   01EB  C3                CLR     C
   \   01EC  9C                SUBB    A,R4
   \   01ED  900092            MOV     DPTR,#cursor
   \   01F0  E0                MOVX    A,@DPTR
   \   01F1  6480              XRL     A,#128
   \   01F3  CD                XCH     A,R5
   \   01F4  6480              XRL     A,#128
   \   01F6  CD                XCH     A,R5
   \   01F7  9D                SUBB    A,R5
   \   01F8  5016              JNC     ?0037
   \   01FA            ?0036:
    262                                  cursor++;
   \   01FA  A3                INC     DPTR
   \   01FB  E0                MOVX    A,@DPTR
   \   01FC  04                INC     A
   \   01FD  F0                MOVX    @DPTR,A
   \   01FE  900092            MOV     DPTR,#cursor
   \   0201  7003              JNZ     ?0554
   \   0203  E0                MOVX    A,@DPTR
   \   0204  04                INC     A
   \   0205  F0                MOVX    @DPTR,A
   \   0206            ?0554:
    263                                  LogCursorAt(cursor, 0);
   \   0206  E0                MOVX    A,@DPTR
   \   0207  FD                MOV     R5,A
   \   0208  A3                INC     DPTR
   \   0209  E0                MOVX    A,@DPTR
   \   020A  FC                MOV     R4,A
   \   020B  7E00              MOV     R6,#0
   \   020D  120000            LCALL   $REFFN LogCursorAt
   \   0210            ?0037:
   \   0210  8074              SJMP    ?0038
   \   0212            ?0035:
    264                              }
    265                          } else if (lastKey == 8) {
   \   0212  B40828            CJNE    A,#8,?0040
   \   0215            ?0039:
    266                              menuState = MS_MENU;
    267                              DispOptionsMenu(answerOn, numSignals);
   \   0215  900095            MOV     DPTR,#numSignals
   \   0218  E0                MOVX    A,@DPTR
   \   0219  FD                MOV     R5,A
   \   021A  900000            MOV     DPTR,#answerOn
   \   021D  E0                MOVX    A,@DPTR
   \   021E  FC                MOV     R4,A
   \   021F  120000            LCALL   $REFFN DispOptionsMenu
    268                              menuSelection = 0;
   \   0222  E4                CLR     A
   \   0223  900094            MOV     DPTR,#menuSelection
   \   0226  F0                MOVX    @DPTR,A
    269                              OptionCursorAt(menuSelection);
   \   0227  FD                MOV     R5,A
   \   0228  FC                MOV     R4,A
   \   0229  120000            LCALL   $REFFN OptionCursorAt
    270                              DisplayMenu("  NEXT     UP     DOWN    BACK");                      // Should be buttons of default menuSelection
   \   022C  7D7C              MOV     R5,#LOW(?0041)
   \   022E  7E00              MOV     R6,#HIGH(?0041)
   \   0230  7F02              MOV     R7,#2
   \   0232  120000            LCALL   $REFFN DisplayMenu
   \   0235  7402              MOV     A,#2
   \   0237  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   023A  F0                MOVX    @DPTR,A
   \   023B  8049              SJMP    ?0042
   \   023D            ?0040:
    271                          } else if (lastKey == 16) {
   \   023D  B41046            CJNE    A,#16,?0044
   \   0240            ?0043:
    272                              PlayNewMessages();
   \   0240  120000            LCALL   $REFFN PlayNewMessages
    273                              lastPlayed = numOfCalls - 1;
   \   0243  900002            MOV     DPTR,#numOfCalls+1
   \   0246  E0                MOVX    A,@DPTR
   \   0247  24FF              ADD     A,#255
   \   0249  FC                MOV     R4,A
   \   024A  900001            MOV     DPTR,#numOfCalls
   \   024D  E0                MOVX    A,@DPTR
   \   024E  34FF              ADDC    A,#255
   \   0250  FD                MOV     R5,A
    274                              WriteCalenderByte(NV_PLAYED_MS, (lastPlayed >> 8) & 0xFF);
   \   0251  900003            MOV     DPTR,#lastPlayed
   \   0254  F0                MOVX    @DPTR,A
   \   0255  A3                INC     DPTR
   \   0256  EC                MOV     A,R4
   \   0257  F0                MOVX    @DPTR,A
   \   0258  7C0A              MOV     R4,#10
   \   025A  120000            LCALL   $REFFN WriteCalenderByte
    275                              WriteCalenderByte(NV_PLAYED_LS, lastPlayed & 0xFF);
   \   025D  900004            MOV     DPTR,#lastPlayed+1
   \   0260  E0                MOVX    A,@DPTR
   \   0261  FD                MOV     R5,A
   \   0262  7C0B              MOV     R4,#11
   \   0264  120000            LCALL   $REFFN WriteCalenderByte
    276                              WriteCalenderByte(0x07, 0x80);          //Släck diod
   \   0267  7D80              MOV     R5,#128
   \   0269  7C07              MOV     R4,#7
   \   026B  120000            LCALL   $REFFN WriteCalenderByte
    277                              receivedDTMF = 0;
   \   026E  E4                CLR     A
   \   026F  900000            MOV     DPTR,#receivedDTMF
   \   0272  F0                MOVX    @DPTR,A
    278                              ResetDTMFIndex();
   \   0273  120000            LCALL   $REFFN ResetDTMFIndex
    279                              FillDispBuffer();
   \   0276  120000            LCALL   $REFFN FillDispBuffer
    280                              LogCursorAt(cursor, 1);
   \   0279  900092            MOV     DPTR,#cursor
   \   027C  E0                MOVX    A,@DPTR
   \   027D  FD                MOV     R5,A
   \   027E  A3                INC     DPTR
   \   027F  E0                MOVX    A,@DPTR
   \   0280  FC                MOV     R4,A
   \   0281  7E01              MOV     R6,#1
   \   0283  120000            LCALL   $REFFN LogCursorAt
   \   0286            ?0044:
   \   0286            ?0042:
   \   0286            ?0038:
   \   0286            ?0033:
   \   0286            ?0028:
    281                          }
    282                          break;
   \   0286  020A83            LJMP    ?0024
   \   0289            ?0045:
    283                      case MS_MENU:
    284                          if (lastKey == 1) {
   \   0289  900000            MOV     DPTR,#lastKey
   \   028C  E0                MOVX    A,@DPTR
   \   028D  14                DEC     A
   \   028E  7046              JNZ     ?0047
   \   0290            ?0046:
    285                              menuSelection++;
   \   0290  900094            MOV     DPTR,#menuSelection
   \   0293  E0                MOVX    A,@DPTR
   \   0294  04                INC     A
   \   0295  F0                MOVX    @DPTR,A
    286                              if ((menuSelection == MENU_ITEM_SPKR_VOL) ||
    287                                                          (menuSelection == MENU_ITEM_NUMSIG)) DisplayMenu("  NEXT     UP     DOWN    BACK");
   \   0296  E0                MOVX    A,@DPTR
   \   0297  6003              JZ      ?0048
   \   0299  B40409            CJNE    A,#4,?0049
   \   029C            ?0050:
   \   029C            ?0051:
   \   029C            ?0048:
   \   029C  7D7C              MOV     R5,#LOW(?0041)
   \   029E  7E00              MOV     R6,#HIGH(?0041)
   \   02A0  7F02              MOV     R7,#2
   \   02A2  120000            LCALL   $REFFN DisplayMenu
   \   02A5            ?0049:
    288                              if ((menuSelection == MENU_ITEM_ANS_ONOFF) || 
    289                                                          (menuSelection == MENU_ITEM_MEMO) || 
    290                                                          (menuSelection == MENU_ITEM_TIMEDATE) || 
    291                                                          (menuSelection == MENU_ITEM_ERASE)) DisplayMenu("  NEXT   SELECT           BACK");
   \   02A5  900094            MOV     DPTR,#menuSelection
   \   02A8  E0                MOVX    A,@DPTR
   \   02A9  14                DEC     A
   \   02AA  600E              JZ      ?0052
   \   02AC  E0                MOVX    A,@DPTR
   \   02AD  6402              XRL     A,#2
   \   02AF  6009              JZ      ?0052
   \   02B1  E0                MOVX    A,@DPTR
   \   02B2  6403              XRL     A,#3
   \   02B4  6004              JZ      ?0052
   \   02B6  E0                MOVX    A,@DPTR
   \   02B7  B40509            CJNE    A,#5,?0053
   \   02BA            ?0054:
   \   02BA            ?0055:
   \   02BA            ?0052:
   \   02BA  7D9B              MOV     R5,#LOW(?0056)
   \   02BC  7E00              MOV     R6,#HIGH(?0056)
   \   02BE  7F02              MOV     R7,#2
   \   02C0  120000            LCALL   $REFFN DisplayMenu
   \   02C3            ?0053:
    292                              if (menuSelection == MENU_NUM_OF_ITEMS) menuSelection = 0;
   \   02C3  900094            MOV     DPTR,#menuSelection
   \   02C6  E0                MOVX    A,@DPTR
   \   02C7  B40602            CJNE    A,#6,?0058
   \   02CA            ?0057:
   \   02CA  E4                CLR     A
   \   02CB  F0                MOVX    @DPTR,A
   \   02CC            ?0058:
    293                              OptionCursorAt(menuSelection);
   \   02CC  E0                MOVX    A,@DPTR
   \   02CD  7D00              MOV     R5,#0
   \   02CF  FC                MOV     R4,A
   \   02D0  120000            LCALL   $REFFN OptionCursorAt
   \   02D3  0204E3            LJMP    ?0059
   \   02D6            ?0047:
    294                          } else if (lastKey == 2) {
   \   02D6  E0                MOVX    A,@DPTR
   \   02D7  B40202            CJNE    A,#2,$+5
   \   02DA  8003              SJMP    $+5
   \   02DC  020479            LJMP    ?0061
   \   02DF            ?0060:
    295                              if (menuSelection == MENU_ITEM_ANS_ONOFF) {
   \   02DF  900094            MOV     DPTR,#menuSelection
   \   02E2  E0                MOVX    A,@DPTR
   \   02E3  14                DEC     A
   \   02E4  7038              JNZ     ?0063
   \   02E6            ?0062:
    296                                  if (answerOn) {
   \   02E6  900000            MOV     DPTR,#answerOn
   \   02E9  E0                MOVX    A,@DPTR
   \   02EA  6009              JZ      ?0065
   \   02EC            ?0064:
    297                                      answerOn = 0;
   \   02EC  E4                CLR     A
   \   02ED  900000            MOV     DPTR,#answerOn
   \   02F0  F0                MOVX    @DPTR,A
    298                                      P3.5 = 1;
   \   02F1  D2B5              SETB    P3.5
    299                                  } else {
   \   02F3  8008              SJMP    ?0066
   \   02F5            ?0065:
    300                                      answerOn = 1;
   \   02F5  7401              MOV     A,#1
   \   02F7  900000            MOV     DPTR,#answerOn
   \   02FA  F0                MOVX    @DPTR,A
    301                                      P3.5 = 0;
   \   02FB  C2B5              CLR     P3.5
   \   02FD            ?0066:
    302                                  }
    303                                  WriteCalenderByte(NV_ANSWERING_ON, answerOn);
   \   02FD  E0                MOVX    A,@DPTR
   \   02FE  FD                MOV     R5,A
   \   02FF  7C08              MOV     R4,#8
   \   0301  120000            LCALL   $REFFN WriteCalenderByte
    304                                  DispOptionsMenu(answerOn, numSignals);
   \   0304  900095            MOV     DPTR,#numSignals
   \   0307  E0                MOVX    A,@DPTR
   \   0308  FD                MOV     R5,A
   \   0309  900000            MOV     DPTR,#answerOn
   \   030C  E0                MOVX    A,@DPTR
   \   030D  FC                MOV     R4,A
   \   030E  120000            LCALL   $REFFN DispOptionsMenu
    305                                  OptionCursorAt(menuSelection);
   \   0311  900094            MOV     DPTR,#menuSelection
   \   0314  E0                MOVX    A,@DPTR
   \   0315  7D00              MOV     R5,#0
   \   0317  FC                MOV     R4,A
   \   0318  120000            LCALL   $REFFN OptionCursorAt
   \   031B  020477            LJMP    ?0067
   \   031E            ?0063:
    306                              } else if (menuSelection == MENU_ITEM_MEMO) {
   \   031E  E0                MOVX    A,@DPTR
   \   031F  B40215            CJNE    A,#2,?0069
   \   0322            ?0068:
    307                                  menuState = MS_MEMO;
    308                                  DispMemoScreen();
   \   0322  120000            LCALL   $REFFN DispMemoScreen
    309                                  DisplayMenu("  PLAY   RECORD            BACK");
   \   0325  7DBA              MOV     R5,#LOW(?0070)
   \   0327  7E00              MOV     R6,#HIGH(?0070)
   \   0329  7F02              MOV     R7,#2
   \   032B  120000            LCALL   $REFFN DisplayMenu
   \   032E  7405              MOV     A,#5
   \   0330  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   0333  F0                MOVX    @DPTR,A
   \   0334  020477            LJMP    ?0071
   \   0337            ?0069:
    310                              } else if (menuSelection == MENU_ITEM_TIMEDATE) {
   \   0337  B40302            CJNE    A,#3,$+5
   \   033A  8003              SJMP    $+5
   \   033C  020404            LJMP    ?0073
   \   033F            ?0072:
    311                                  menuState = MS_TIMEDATE;
    312                                  GetDateNow(&dateNow);
   \   033F  7D00              MOV     R5,#LOW ($LOCBX WaitForCall+61)
   \   0341  7E00              MOV     R6,#HIGH ($LOCBX WaitForCall+61)
   \   0343  7F01              MOV     R7,#1
   \   0345  120000            LCALL   $REFFN GetDateNow
    313                                  year = (dateNow.year & 0x0F) + (10 * ((dateNow.year >> 4) & 0x0F));
   \   0348  900000            MOV     DPTR,#$LOCBX WaitForCall+64
   \   034B  E0                MOVX    A,@DPTR
   \   034C  C4                SWAP    A
   \   034D  540F              ANL     A,#15
   \   034F  75F00A            MOV     B,#10
   \   0352  A4                MUL     AB
   \   0353  FC                MOV     R4,A
   \   0354  900000            MOV     DPTR,#$LOCBX WaitForCall+64
   \   0357  E0                MOVX    A,@DPTR
   \   0358  540F              ANL     A,#15
   \   035A  2C                ADD     A,R4
   \   035B  90009A            MOV     DPTR,#year
   \   035E  F0                MOVX    @DPTR,A
    314                                  month = (dateNow.month & 0x0F) + (10 * ((dateNow.month >> 4) & 0x0F));
   \   035F  900000            MOV     DPTR,#$LOCBX WaitForCall+63
   \   0362  E0                MOVX    A,@DPTR
   \   0363  C4                SWAP    A
   \   0364  540F              ANL     A,#15
   \   0366  75F00A            MOV     B,#10
   \   0369  A4                MUL     AB
   \   036A  FC                MOV     R4,A
   \   036B  900000            MOV     DPTR,#$LOCBX WaitForCall+63
   \   036E  E0                MOVX    A,@DPTR
   \   036F  540F              ANL     A,#15
   \   0371  2C                ADD     A,R4
   \   0372  90009B            MOV     DPTR,#month
   \   0375  F0                MOVX    @DPTR,A
    315                                  date = (dateNow.date & 0x0F) + (10 * ((dateNow.date >> 4) & 0x0F));
   \   0376  900000            MOV     DPTR,#$LOCBX WaitForCall+62
   \   0379  E0                MOVX    A,@DPTR
   \   037A  C4                SWAP    A
   \   037B  540F              ANL     A,#15
   \   037D  75F00A            MOV     B,#10
   \   0380  A4                MUL     AB
   \   0381  FC                MOV     R4,A
   \   0382  900000            MOV     DPTR,#$LOCBX WaitForCall+62
   \   0385  E0                MOVX    A,@DPTR
   \   0386  540F              ANL     A,#15
   \   0388  2C                ADD     A,R4
   \   0389  90009C            MOV     DPTR,#date
   \   038C  F0                MOVX    @DPTR,A
    316                                  GetTimeNow(&timeNow);
   \   038D  7D00              MOV     R5,#LOW ($LOCBX WaitForCall+65)
   \   038F  7E00              MOV     R6,#HIGH ($LOCBX WaitForCall+65)
   \   0391  7F01              MOV     R7,#1
   \   0393  120000            LCALL   $REFFN GetTimeNow
    317                                  hour = (timeNow.hours & 0x0F) + (10 * ((timeNow.hours >> 4) & 0x0F));
   \   0396  900000            MOV     DPTR,#$LOCBX WaitForCall+67
   \   0399  E0                MOVX    A,@DPTR
   \   039A  C4                SWAP    A
   \   039B  540F              ANL     A,#15
   \   039D  75F00A            MOV     B,#10
   \   03A0  A4                MUL     AB
   \   03A1  FC                MOV     R4,A
   \   03A2  900000            MOV     DPTR,#$LOCBX WaitForCall+67
   \   03A5  E0                MOVX    A,@DPTR
   \   03A6  540F              ANL     A,#15
   \   03A8  2C                ADD     A,R4
   \   03A9  9000A0            MOV     DPTR,#hour
   \   03AC  F0                MOVX    @DPTR,A
    318                                  minute = (timeNow.minutes & 0x0F) + (10 * ((timeNow.minutes >> 4) & 0x0F));
   \   03AD  900000            MOV     DPTR,#$LOCBX WaitForCall+66
   \   03B0  E0                MOVX    A,@DPTR
   \   03B1  C4                SWAP    A
   \   03B2  540F              ANL     A,#15
   \   03B4  75F00A            MOV     B,#10
   \   03B7  A4                MUL     AB
   \   03B8  FC                MOV     R4,A
   \   03B9  900000            MOV     DPTR,#$LOCBX WaitForCall+66
   \   03BC  E0                MOVX    A,@DPTR
   \   03BD  540F              ANL     A,#15
   \   03BF  2C                ADD     A,R4
   \   03C0  9000A1            MOV     DPTR,#minute
   \   03C3  F0                MOVX    @DPTR,A
    319                                  timCur = 0;                                      
   \   03C4  E4                CLR     A
   \   03C5  9000A2            MOV     DPTR,#timCur
   \   03C8  F0                MOVX    @DPTR,A
    320                                  DispSetTimeDateHead();
   \   03C9  120000            LCALL   $REFFN DispSetTimeDateHead
    321                                  DisplayMenu("  NEXT    UP      DOWN      DONE   CANCEL");
   \   03CC  7DDA              MOV     R5,#LOW(?0074)
   \   03CE  7E00              MOV     R6,#HIGH(?0074)
   \   03D0  7F02              MOV     R7,#2
   \   03D2  120000            LCALL   $REFFN DisplayMenu
    322                                  DispSetTimeDate(timCur, year, month, date, hour, minute);
   \   03D5  9000A1            MOV     DPTR,#minute
   \   03D8  E0                MOVX    A,@DPTR
   \   03D9  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+5
   \   03DC  F0                MOVX    @DPTR,A
   \   03DD  9000A0            MOV     DPTR,#hour
   \   03E0  E0                MOVX    A,@DPTR
   \   03E1  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+4
   \   03E4  F0                MOVX    @DPTR,A
   \   03E5  90009C            MOV     DPTR,#date
   \   03E8  E0                MOVX    A,@DPTR
   \   03E9  FF                MOV     R7,A
   \   03EA  90009B            MOV     DPTR,#month
   \   03ED  E0                MOVX    A,@DPTR
   \   03EE  FE                MOV     R6,A
   \   03EF  90009A            MOV     DPTR,#year
   \   03F2  E0                MOVX    A,@DPTR
   \   03F3  FD                MOV     R5,A
   \   03F4  9000A2            MOV     DPTR,#timCur
   \   03F7  E0                MOVX    A,@DPTR
   \   03F8  FC                MOV     R4,A
   \   03F9  120000            LCALL   $REFFN DispSetTimeDate
   \   03FC  7403              MOV     A,#3
   \   03FE  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   0401  F0                MOVX    @DPTR,A
   \   0402  8073              SJMP    ?0075
   \   0404            ?0073:
    323                              } else if (menuSelection == MENU_ITEM_NUMSIG) {
   \   0404  B40431            CJNE    A,#4,?0077
   \   0407            ?0076:
    324                                  if (numSignals < 15) {
   \   0407  900095            MOV     DPTR,#numSignals
   \   040A  E0                MOVX    A,@DPTR
   \   040B  24F1              ADD     A,#241
   \   040D  4010              JC      ?0079
   \   040F            ?0078:
    325                                      numSignals++;
   \   040F  900095            MOV     DPTR,#numSignals
   \   0412  E0                MOVX    A,@DPTR
   \   0413  04                INC     A
   \   0414  F0                MOVX    @DPTR,A
    326                                      WriteCalenderByte(NV_NUM_SIGNALS, numSignals);
   \   0415  900095            MOV     DPTR,#numSignals
   \   0418  E0                MOVX    A,@DPTR
   \   0419  FD                MOV     R5,A
   \   041A  7C09              MOV     R4,#9
   \   041C  120000            LCALL   $REFFN WriteCalenderByte
   \   041F            ?0079:
    327                                  }
    328                                  DispOptionsMenu(answerOn, numSignals);
   \   041F  900095            MOV     DPTR,#numSignals
   \   0422  E0                MOVX    A,@DPTR
   \   0423  FD                MOV     R5,A
   \   0424  900000            MOV     DPTR,#answerOn
   \   0427  E0                MOVX    A,@DPTR
   \   0428  FC                MOV     R4,A
   \   0429  120000            LCALL   $REFFN DispOptionsMenu
    329                                  OptionCursorAt(menuSelection);
   \   042C  900094            MOV     DPTR,#menuSelection
   \   042F  E0                MOVX    A,@DPTR
   \   0430  7D00              MOV     R5,#0
   \   0432  FC                MOV     R4,A
   \   0433  120000            LCALL   $REFFN OptionCursorAt
   \   0436  803F              SJMP    ?0080
   \   0438            ?0077:
    330                              } else if (menuSelection == MENU_ITEM_ERASE) {
   \   0438  B4050B            CJNE    A,#5,?0082
   \   043B            ?0081:
    331                                  menuState = MS_ERASEQST;
    332                                  DispEraseQuest();
   \   043B  120000            LCALL   $REFFN DispEraseQuest
   \   043E  7404              MOV     A,#4
   \   0440  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   0443  F0                MOVX    @DPTR,A
   \   0444  8031              SJMP    ?0083
   \   0446            ?0082:
    333                                                  } else if (menuSelection == MENU_ITEM_SPKR_VOL) {
   \   0446  702F              JNZ     ?0085
   \   0448            ?0084:
    334                                                          if (speakerVolume < 63) {
   \   0448  900000            MOV     DPTR,#speakerVolume
   \   044B  E0                MOVX    A,@DPTR
   \   044C  24C1              ADD     A,#193
   \   044E  4010              JC      ?0087
   \   0450            ?0086:
    335                                                                  speakerVolume += 1;
   \   0450  900000            MOV     DPTR,#speakerVolume
   \   0453  E0                MOVX    A,@DPTR
   \   0454  04                INC     A
   \   0455  F0                MOVX    @DPTR,A
    336                                                                  WriteCalenderByte(NV_SPEAKER_VOL, speakerVolume);
   \   0456  900000            MOV     DPTR,#speakerVolume
   \   0459  E0                MOVX    A,@DPTR
   \   045A  FD                MOV     R5,A
   \   045B  7C0C              MOV     R4,#12
   \   045D  120000            LCALL   $REFFN WriteCalenderByte
   \   0460            ?0087:
    337                                                          }
    338                                  DispOptionsMenu(answerOn, numSignals);
   \   0460  900095            MOV     DPTR,#numSignals
   \   0463  E0                MOVX    A,@DPTR
   \   0464  FD                MOV     R5,A
   \   0465  900000            MOV     DPTR,#answerOn
   \   0468  E0                MOVX    A,@DPTR
   \   0469  FC                MOV     R4,A
   \   046A  120000            LCALL   $REFFN DispOptionsMenu
    339                                  OptionCursorAt(menuSelection);
   \   046D  900094            MOV     DPTR,#menuSelection
   \   0470  E0                MOVX    A,@DPTR
   \   0471  7D00              MOV     R5,#0
   \   0473  FC                MOV     R4,A
   \   0474  120000            LCALL   $REFFN OptionCursorAt
   \   0477            ?0085:
   \   0477            ?0083:
   \   0477            ?0080:
   \   0477            ?0075:
   \   0477            ?0071:
   \   0477            ?0067:
   \   0477  806A              SJMP    ?0088
   \   0479            ?0061:
    340                              }
    341                          } else if (lastKey == 4) {
   \   0479  B40448            CJNE    A,#4,?0090
   \   047C            ?0089:
    342                              if (menuSelection == MENU_ITEM_NUMSIG) {
   \   047C  900094            MOV     DPTR,#menuSelection
   \   047F  E0                MOVX    A,@DPTR
   \   0480  B40414            CJNE    A,#4,?0092
   \   0483            ?0091:
    343                                  if (numSignals > 0) {
   \   0483  900095            MOV     DPTR,#numSignals
   \   0486  E0                MOVX    A,@DPTR
   \   0487  600C              JZ      ?0094
   \   0489            ?0093:
    344                                      numSignals--;
   \   0489  14                DEC     A
   \   048A  900095            MOV     DPTR,#numSignals
   \   048D  F0                MOVX    @DPTR,A
    345                                      WriteCalenderByte(NV_NUM_SIGNALS, numSignals);
   \   048E  E0                MOVX    A,@DPTR
   \   048F  FD                MOV     R5,A
   \   0490  7C09              MOV     R4,#9
   \   0492  120000            LCALL   $REFFN WriteCalenderByte
   \   0495            ?0094:
   \   0495  8014              SJMP    ?0095
   \   0497            ?0092:
    346                                  }
    347                                                  } else if (menuSelection == MENU_ITEM_SPKR_VOL) {
   \   0497  7012              JNZ     ?0097
   \   0499            ?0096:
    348                                                          if (speakerVolume > 0) {
   \   0499  900000            MOV     DPTR,#speakerVolume
   \   049C  E0                MOVX    A,@DPTR
   \   049D  600C              JZ      ?0099
   \   049F            ?0098:
    349                                                                  speakerVolume -= 1;
   \   049F  14                DEC     A
   \   04A0  900000            MOV     DPTR,#speakerVolume
   \   04A3  F0                MOVX    @DPTR,A
    350                                                                  WriteCalenderByte(NV_SPEAKER_VOL, speakerVolume);
   \   04A4  E0                MOVX    A,@DPTR
   \   04A5  FD                MOV     R5,A
   \   04A6  7C0C              MOV     R4,#12
   \   04A8  120000            LCALL   $REFFN WriteCalenderByte
   \   04AB            ?0099:
   \   04AB            ?0097:
   \   04AB            ?0095:
    351                                                          }
    352                              }
    353                              DispOptionsMenu(answerOn, numSignals);
   \   04AB  900095            MOV     DPTR,#numSignals
   \   04AE  E0                MOVX    A,@DPTR
   \   04AF  FD                MOV     R5,A
   \   04B0  900000            MOV     DPTR,#answerOn
   \   04B3  E0                MOVX    A,@DPTR
   \   04B4  FC                MOV     R4,A
   \   04B5  120000            LCALL   $REFFN DispOptionsMenu
    354                              OptionCursorAt(menuSelection);
   \   04B8  900094            MOV     DPTR,#menuSelection
   \   04BB  E0                MOVX    A,@DPTR
   \   04BC  7D00              MOV     R5,#0
   \   04BE  FC                MOV     R4,A
   \   04BF  120000            LCALL   $REFFN OptionCursorAt
   \   04C2  801F              SJMP    ?0100
   \   04C4            ?0090:
    355                          } else if (lastKey == 8) {
   \   04C4  B4081C            CJNE    A,#8,?0102
   \   04C7            ?0101:
    356                              LogCursorAt(cursor, 1);
   \   04C7  900092            MOV     DPTR,#cursor
   \   04CA  E0                MOVX    A,@DPTR
   \   04CB  FD                MOV     R5,A
   \   04CC  A3                INC     DPTR
   \   04CD  E0                MOVX    A,@DPTR
   \   04CE  FC                MOV     R4,A
   \   04CF  7E01              MOV     R6,#1
   \   04D1  120000            LCALL   $REFFN LogCursorAt
    357                              DisplayMenu("  PLAY     UP     DOWN    MENU   PLAY NEW");
   \   04D4  7D52              MOV     R5,#LOW(?0012)
   \   04D6  7E00              MOV     R6,#HIGH(?0012)
   \   04D8  7F02              MOV     R7,#2
   \   04DA  120000            LCALL   $REFFN DisplayMenu
    358                              menuState = MS_LOG;
   \   04DD  7401              MOV     A,#1
   \   04DF  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   04E2  F0                MOVX    @DPTR,A
   \   04E3            ?0102:
   \   04E3            ?0100:
   \   04E3            ?0088:
   \   04E3            ?0059:
    359                          }
    360                          break;
   \   04E3  020A83            LJMP    ?0024
   \   04E6            ?0103:
    361                      case MS_TIMEDATE:
    362                          if (lastKey == 1) {
   \   04E6  900000            MOV     DPTR,#lastKey
   \   04E9  E0                MOVX    A,@DPTR
   \   04EA  14                DEC     A
   \   04EB  7037              JNZ     ?0105
   \   04ED            ?0104:
    363                              timCur++;
   \   04ED  9000A2            MOV     DPTR,#timCur
   \   04F0  E0                MOVX    A,@DPTR
   \   04F1  04                INC     A
   \   04F2  F0                MOVX    @DPTR,A
    364                              if (timCur > 4) timCur = 0;
   \   04F3  E0                MOVX    A,@DPTR
   \   04F4  24FB              ADD     A,#251
   \   04F6  5002              JNC     ?0107
   \   04F8            ?0106:
   \   04F8  E4                CLR     A
   \   04F9  F0                MOVX    @DPTR,A
   \   04FA            ?0107:
    365                              DispSetTimeDate(timCur, year, month, date, hour, minute);
   \   04FA  9000A1            MOV     DPTR,#minute
   \   04FD  E0                MOVX    A,@DPTR
   \   04FE  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+5
   \   0501  F0                MOVX    @DPTR,A
   \   0502  9000A0            MOV     DPTR,#hour
   \   0505  E0                MOVX    A,@DPTR
   \   0506  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+4
   \   0509  F0                MOVX    @DPTR,A
   \   050A  90009C            MOV     DPTR,#date
   \   050D  E0                MOVX    A,@DPTR
   \   050E  FF                MOV     R7,A
   \   050F  90009B            MOV     DPTR,#month
   \   0512  E0                MOVX    A,@DPTR
   \   0513  FE                MOV     R6,A
   \   0514  90009A            MOV     DPTR,#year
   \   0517  E0                MOVX    A,@DPTR
   \   0518  FD                MOV     R5,A
   \   0519  9000A2            MOV     DPTR,#timCur
   \   051C  E0                MOVX    A,@DPTR
   \   051D  FC                MOV     R4,A
   \   051E  120000            LCALL   $REFFN DispSetTimeDate
   \   0521  0208AE            LJMP    ?0108
   \   0524            ?0105:
    366                          } else if (lastKey == 2) {
   \   0524  E0                MOVX    A,@DPTR
   \   0525  B40202            CJNE    A,#2,$+5
   \   0528  8003              SJMP    $+5
   \   052A  020657            LJMP    ?0110
   \   052D            ?0109:
    367                              if (timCur == 0) {
   \   052D  9000A2            MOV     DPTR,#timCur
   \   0530  E0                MOVX    A,@DPTR
   \   0531  703C              JNZ     ?0112
   \   0533            ?0111:
    368                                  year++;
   \   0533  90009A            MOV     DPTR,#year
   \   0536  E0                MOVX    A,@DPTR
   \   0537  04                INC     A
   \   0538  F0                MOVX    @DPTR,A
    369                                  if (year > 99) year = 0;
   \   0539  E0                MOVX    A,@DPTR
   \   053A  249C              ADD     A,#156
   \   053C  5002              JNC     ?0114
   \   053E            ?0113:
   \   053E  E4                CLR     A
   \   053F  F0                MOVX    @DPTR,A
   \   0540            ?0114:
    370                                  CorrectDate(0);
   \   0540  7C00              MOV     R4,#0
   \   0542  120000            LCALL   $REFFN CorrectDate
    371                                  DispSetTimeDate(timCur, year, month, date, hour, minute);
   \   0545  9000A1            MOV     DPTR,#minute
   \   0548  E0                MOVX    A,@DPTR
   \   0549  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+5
   \   054C  F0                MOVX    @DPTR,A
   \   054D  9000A0            MOV     DPTR,#hour
   \   0550  E0                MOVX    A,@DPTR
   \   0551  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+4
   \   0554  F0                MOVX    @DPTR,A
   \   0555  90009C            MOV     DPTR,#date
   \   0558  E0                MOVX    A,@DPTR
   \   0559  FF                MOV     R7,A
   \   055A  90009B            MOV     DPTR,#month
   \   055D  E0                MOVX    A,@DPTR
   \   055E  FE                MOV     R6,A
   \   055F  90009A            MOV     DPTR,#year
   \   0562  E0                MOVX    A,@DPTR
   \   0563  FD                MOV     R5,A
   \   0564  9000A2            MOV     DPTR,#timCur
   \   0567  E0                MOVX    A,@DPTR
   \   0568  FC                MOV     R4,A
   \   0569  120000            LCALL   $REFFN DispSetTimeDate
   \   056C  020654            LJMP    ?0115
   \   056F            ?0112:
    372                              } else if (timCur == 1) {
   \   056F  14                DEC     A
   \   0570  703D              JNZ     ?0117
   \   0572            ?0116:
    373                                  month++;
   \   0572  90009B            MOV     DPTR,#month
   \   0575  E0                MOVX    A,@DPTR
   \   0576  04                INC     A
   \   0577  F0                MOVX    @DPTR,A
    374                                  if (month > 12) month = 1;
   \   0578  E0                MOVX    A,@DPTR
   \   0579  24F3              ADD     A,#243
   \   057B  5003              JNC     ?0119
   \   057D            ?0118:
   \   057D  7401              MOV     A,#1
   \   057F  F0                MOVX    @DPTR,A
   \   0580            ?0119:
    375                                  CorrectDate(0);
   \   0580  7C00              MOV     R4,#0
   \   0582  120000            LCALL   $REFFN CorrectDate
    376                                  DispSetTimeDate(timCur, year, month, date, hour, minute);
   \   0585  9000A1            MOV     DPTR,#minute
   \   0588  E0                MOVX    A,@DPTR
   \   0589  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+5
   \   058C  F0                MOVX    @DPTR,A
   \   058D  9000A0            MOV     DPTR,#hour
   \   0590  E0                MOVX    A,@DPTR
   \   0591  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+4
   \   0594  F0                MOVX    @DPTR,A
   \   0595  90009C            MOV     DPTR,#date
   \   0598  E0                MOVX    A,@DPTR
   \   0599  FF                MOV     R7,A
   \   059A  90009B            MOV     DPTR,#month
   \   059D  E0                MOVX    A,@DPTR
   \   059E  FE                MOV     R6,A
   \   059F  90009A            MOV     DPTR,#year
   \   05A2  E0                MOVX    A,@DPTR
   \   05A3  FD                MOV     R5,A
   \   05A4  9000A2            MOV     DPTR,#timCur
   \   05A7  E0                MOVX    A,@DPTR
   \   05A8  FC                MOV     R4,A
   \   05A9  120000            LCALL   $REFFN DispSetTimeDate
   \   05AC  020654            LJMP    ?0120
   \   05AF            ?0117:
    377                              } else if (timCur == 2) {
   \   05AF  E0                MOVX    A,@DPTR
   \   05B0  B40234            CJNE    A,#2,?0122
   \   05B3            ?0121:
    378                                  date++;
   \   05B3  90009C            MOV     DPTR,#date
   \   05B6  E0                MOVX    A,@DPTR
   \   05B7  04                INC     A
   \   05B8  F0                MOVX    @DPTR,A
    379                                  CorrectDate(1);
   \   05B9  7C01              MOV     R4,#1
   \   05BB  120000            LCALL   $REFFN CorrectDate
    380                                  DispSetTimeDate(timCur, year, month, date, hour, minute);
   \   05BE  9000A1            MOV     DPTR,#minute
   \   05C1  E0                MOVX    A,@DPTR
   \   05C2  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+5
   \   05C5  F0                MOVX    @DPTR,A
   \   05C6  9000A0            MOV     DPTR,#hour
   \   05C9  E0                MOVX    A,@DPTR
   \   05CA  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+4
   \   05CD  F0                MOVX    @DPTR,A
   \   05CE  90009C            MOV     DPTR,#date
   \   05D1  E0                MOVX    A,@DPTR
   \   05D2  FF                MOV     R7,A
   \   05D3  90009B            MOV     DPTR,#month
   \   05D6  E0                MOVX    A,@DPTR
   \   05D7  FE                MOV     R6,A
   \   05D8  90009A            MOV     DPTR,#year
   \   05DB  E0                MOVX    A,@DPTR
   \   05DC  FD                MOV     R5,A
   \   05DD  9000A2            MOV     DPTR,#timCur
   \   05E0  E0                MOVX    A,@DPTR
   \   05E1  FC                MOV     R4,A
   \   05E2  120000            LCALL   $REFFN DispSetTimeDate
   \   05E5  806D              SJMP    ?0123
   \   05E7            ?0122:
    381                              } else if (timCur == 3) {
   \   05E7  B40336            CJNE    A,#3,?0125
   \   05EA            ?0124:
    382                                  hour++;
   \   05EA  9000A0            MOV     DPTR,#hour
   \   05ED  E0                MOVX    A,@DPTR
   \   05EE  04                INC     A
   \   05EF  F0                MOVX    @DPTR,A
    383                                  if (hour > 23) hour = 0;
   \   05F0  E0                MOVX    A,@DPTR
   \   05F1  24E8              ADD     A,#232
   \   05F3  5002              JNC     ?0127
   \   05F5            ?0126:
   \   05F5  E4                CLR     A
   \   05F6  F0                MOVX    @DPTR,A
   \   05F7            ?0127:
    384                                  DispSetTimeDate(timCur, year, month, date, hour, minute);
   \   05F7  9000A1            MOV     DPTR,#minute
   \   05FA  E0                MOVX    A,@DPTR
   \   05FB  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+5
   \   05FE  F0                MOVX    @DPTR,A
   \   05FF  9000A0            MOV     DPTR,#hour
   \   0602  E0                MOVX    A,@DPTR
   \   0603  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+4
   \   0606  F0                MOVX    @DPTR,A
   \   0607  90009C            MOV     DPTR,#date
   \   060A  E0                MOVX    A,@DPTR
   \   060B  FF                MOV     R7,A
   \   060C  90009B            MOV     DPTR,#month
   \   060F  E0                MOVX    A,@DPTR
   \   0610  FE                MOV     R6,A
   \   0611  90009A            MOV     DPTR,#year
   \   0614  E0                MOVX    A,@DPTR
   \   0615  FD                MOV     R5,A
   \   0616  9000A2            MOV     DPTR,#timCur
   \   0619  E0                MOVX    A,@DPTR
   \   061A  FC                MOV     R4,A
   \   061B  120000            LCALL   $REFFN DispSetTimeDate
   \   061E  8034              SJMP    ?0128
   \   0620            ?0125:
    385                              } else if (timCur == 4) {
   \   0620  B40431            CJNE    A,#4,?0130
   \   0623            ?0129:
    386                                  minute++;
   \   0623  9000A1            MOV     DPTR,#minute
   \   0626  E0                MOVX    A,@DPTR
   \   0627  04                INC     A
   \   0628  F0                MOVX    @DPTR,A
    387                                  if (minute > 59) minute = 0;
   \   0629  E0                MOVX    A,@DPTR
   \   062A  24C4              ADD     A,#196
   \   062C  5002              JNC     ?0132
   \   062E            ?0131:
   \   062E  E4                CLR     A
   \   062F  F0                MOVX    @DPTR,A
   \   0630            ?0132:
    388                                  DispSetTimeDate(timCur, year, month, date, hour, minute);
   \   0630  E0                MOVX    A,@DPTR
   \   0631  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+5
   \   0634  F0                MOVX    @DPTR,A
   \   0635  9000A0            MOV     DPTR,#hour
   \   0638  E0                MOVX    A,@DPTR
   \   0639  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+4
   \   063C  F0                MOVX    @DPTR,A
   \   063D  90009C            MOV     DPTR,#date
   \   0640  E0                MOVX    A,@DPTR
   \   0641  FF                MOV     R7,A
   \   0642  90009B            MOV     DPTR,#month
   \   0645  E0                MOVX    A,@DPTR
   \   0646  FE                MOV     R6,A
   \   0647  90009A            MOV     DPTR,#year
   \   064A  E0                MOVX    A,@DPTR
   \   064B  FD                MOV     R5,A
   \   064C  9000A2            MOV     DPTR,#timCur
   \   064F  E0                MOVX    A,@DPTR
   \   0650  FC                MOV     R4,A
   \   0651  120000            LCALL   $REFFN DispSetTimeDate
   \   0654            ?0130:
   \   0654            ?0128:
   \   0654            ?0123:
   \   0654            ?0120:
   \   0654            ?0115:
   \   0654  0208AE            LJMP    ?0133
   \   0657            ?0110:
    389                              }
    390                          } else if (lastKey == 4) {
   \   0657  B40402            CJNE    A,#4,$+5
   \   065A  8003              SJMP    $+5
   \   065C  020786            LJMP    ?0135
   \   065F            ?0134:
    391                              if (timCur == 0) {
   \   065F  9000A2            MOV     DPTR,#timCur
   \   0662  E0                MOVX    A,@DPTR
   \   0663  703C              JNZ     ?0137
   \   0665            ?0136:
    392                                  if (year == 0) year = 99;
   \   0665  90009A            MOV     DPTR,#year
   \   0668  E0                MOVX    A,@DPTR
   \   0669  7005              JNZ     ?0139
   \   066B            ?0138:
   \   066B  7463              MOV     A,#99
   \   066D  F0                MOVX    @DPTR,A
   \   066E  8002              SJMP    ?0140
   \   0670            ?0139:
    393                                  else year--;
   \   0670  14                DEC     A
   \   0671  F0                MOVX    @DPTR,A
   \   0672            ?0140:
    394                                  CorrectDate(0);
   \   0672  7C00              MOV     R4,#0
   \   0674  120000            LCALL   $REFFN CorrectDate
    395                                  DispSetTimeDate(timCur, year, month, date, hour, minute);
   \   0677  9000A1            MOV     DPTR,#minute
   \   067A  E0                MOVX    A,@DPTR
   \   067B  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+5
   \   067E  F0                MOVX    @DPTR,A
   \   067F  9000A0            MOV     DPTR,#hour
   \   0682  E0                MOVX    A,@DPTR
   \   0683  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+4
   \   0686  F0                MOVX    @DPTR,A
   \   0687  90009C            MOV     DPTR,#date
   \   068A  E0                MOVX    A,@DPTR
   \   068B  FF                MOV     R7,A
   \   068C  90009B            MOV     DPTR,#month
   \   068F  E0                MOVX    A,@DPTR
   \   0690  FE                MOV     R6,A
   \   0691  90009A            MOV     DPTR,#year
   \   0694  E0                MOVX    A,@DPTR
   \   0695  FD                MOV     R5,A
   \   0696  9000A2            MOV     DPTR,#timCur
   \   0699  E0                MOVX    A,@DPTR
   \   069A  FC                MOV     R4,A
   \   069B  120000            LCALL   $REFFN DispSetTimeDate
   \   069E  020783            LJMP    ?0141
   \   06A1            ?0137:
    396                              } else if (timCur == 1) {
   \   06A1  14                DEC     A
   \   06A2  703B              JNZ     ?0143
   \   06A4            ?0142:
    397                                  month--;
   \   06A4  90009B            MOV     DPTR,#month
   \   06A7  E0                MOVX    A,@DPTR
   \   06A8  14                DEC     A
   \   06A9  F0                MOVX    @DPTR,A
    398                                  if (month < 1) month = 12;
   \   06AA  E0                MOVX    A,@DPTR
   \   06AB  7003              JNZ     ?0145
   \   06AD            ?0144:
   \   06AD  740C              MOV     A,#12
   \   06AF  F0                MOVX    @DPTR,A
   \   06B0            ?0145:
    399                                  CorrectDate(0);
   \   06B0  7C00              MOV     R4,#0
   \   06B2  120000            LCALL   $REFFN CorrectDate
    400                                  DispSetTimeDate(timCur, year, month, date, hour, minute);
   \   06B5  9000A1            MOV     DPTR,#minute
   \   06B8  E0                MOVX    A,@DPTR
   \   06B9  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+5
   \   06BC  F0                MOVX    @DPTR,A
   \   06BD  9000A0            MOV     DPTR,#hour
   \   06C0  E0                MOVX    A,@DPTR
   \   06C1  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+4
   \   06C4  F0                MOVX    @DPTR,A
   \   06C5  90009C            MOV     DPTR,#date
   \   06C8  E0                MOVX    A,@DPTR
   \   06C9  FF                MOV     R7,A
   \   06CA  90009B            MOV     DPTR,#month
   \   06CD  E0                MOVX    A,@DPTR
   \   06CE  FE                MOV     R6,A
   \   06CF  90009A            MOV     DPTR,#year
   \   06D2  E0                MOVX    A,@DPTR
   \   06D3  FD                MOV     R5,A
   \   06D4  9000A2            MOV     DPTR,#timCur
   \   06D7  E0                MOVX    A,@DPTR
   \   06D8  FC                MOV     R4,A
   \   06D9  120000            LCALL   $REFFN DispSetTimeDate
   \   06DC  020783            LJMP    ?0146
   \   06DF            ?0143:
    401                              } else if (timCur == 2) {
   \   06DF  E0                MOVX    A,@DPTR
   \   06E0  B40234            CJNE    A,#2,?0148
   \   06E3            ?0147:
    402                                  date--;
   \   06E3  90009C            MOV     DPTR,#date
   \   06E6  E0                MOVX    A,@DPTR
   \   06E7  14                DEC     A
   \   06E8  F0                MOVX    @DPTR,A
    403                                  CorrectDate(1);
   \   06E9  7C01              MOV     R4,#1
   \   06EB  120000            LCALL   $REFFN CorrectDate
    404                                  DispSetTimeDate(timCur, year, month, date, hour, minute);
   \   06EE  9000A1            MOV     DPTR,#minute
   \   06F1  E0                MOVX    A,@DPTR
   \   06F2  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+5
   \   06F5  F0                MOVX    @DPTR,A
   \   06F6  9000A0            MOV     DPTR,#hour
   \   06F9  E0                MOVX    A,@DPTR
   \   06FA  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+4
   \   06FD  F0                MOVX    @DPTR,A
   \   06FE  90009C            MOV     DPTR,#date
   \   0701  E0                MOVX    A,@DPTR
   \   0702  FF                MOV     R7,A
   \   0703  90009B            MOV     DPTR,#month
   \   0706  E0                MOVX    A,@DPTR
   \   0707  FE                MOV     R6,A
   \   0708  90009A            MOV     DPTR,#year
   \   070B  E0                MOVX    A,@DPTR
   \   070C  FD                MOV     R5,A
   \   070D  9000A2            MOV     DPTR,#timCur
   \   0710  E0                MOVX    A,@DPTR
   \   0711  FC                MOV     R4,A
   \   0712  120000            LCALL   $REFFN DispSetTimeDate
   \   0715  806C              SJMP    ?0149
   \   0717            ?0148:
    405                              } else if (timCur == 3) {
   \   0717  B40336            CJNE    A,#3,?0151
   \   071A            ?0150:
    406                                  if (hour == 0) hour = 23;
   \   071A  9000A0            MOV     DPTR,#hour
   \   071D  E0                MOVX    A,@DPTR
   \   071E  7005              JNZ     ?0153
   \   0720            ?0152:
   \   0720  7417              MOV     A,#23
   \   0722  F0                MOVX    @DPTR,A
   \   0723  8002              SJMP    ?0154
   \   0725            ?0153:
    407                                  else hour--;
   \   0725  14                DEC     A
   \   0726  F0                MOVX    @DPTR,A
   \   0727            ?0154:
    408                                  DispSetTimeDate(timCur, year, month, date, hour, minute);
   \   0727  9000A1            MOV     DPTR,#minute
   \   072A  E0                MOVX    A,@DPTR
   \   072B  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+5
   \   072E  F0                MOVX    @DPTR,A
   \   072F  9000A0            MOV     DPTR,#hour
   \   0732  E0                MOVX    A,@DPTR
   \   0733  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+4
   \   0736  F0                MOVX    @DPTR,A
   \   0737  90009C            MOV     DPTR,#date
   \   073A  E0                MOVX    A,@DPTR
   \   073B  FF                MOV     R7,A
   \   073C  90009B            MOV     DPTR,#month
   \   073F  E0                MOVX    A,@DPTR
   \   0740  FE                MOV     R6,A
   \   0741  90009A            MOV     DPTR,#year
   \   0744  E0                MOVX    A,@DPTR
   \   0745  FD                MOV     R5,A
   \   0746  9000A2            MOV     DPTR,#timCur
   \   0749  E0                MOVX    A,@DPTR
   \   074A  FC                MOV     R4,A
   \   074B  120000            LCALL   $REFFN DispSetTimeDate
   \   074E  8033              SJMP    ?0155
   \   0750            ?0151:
    409                              } else if (timCur == 4) {
   \   0750  B40430            CJNE    A,#4,?0157
   \   0753            ?0156:
    410                                  if (minute == 0) minute = 59;
   \   0753  9000A1            MOV     DPTR,#minute
   \   0756  E0                MOVX    A,@DPTR
   \   0757  7005              JNZ     ?0159
   \   0759            ?0158:
   \   0759  743B              MOV     A,#59
   \   075B  F0                MOVX    @DPTR,A
   \   075C  8002              SJMP    ?0160
   \   075E            ?0159:
    411                                  else minute--;
   \   075E  14                DEC     A
   \   075F  F0                MOVX    @DPTR,A
   \   0760            ?0160:
    412                                  DispSetTimeDate(timCur, year, month, date, hour, minute);
   \   0760  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+5
   \   0763  F0                MOVX    @DPTR,A
   \   0764  9000A0            MOV     DPTR,#hour
   \   0767  E0                MOVX    A,@DPTR
   \   0768  900000            MOV     DPTR,#$PRMBX DispSetTimeDate+4
   \   076B  F0                MOVX    @DPTR,A
   \   076C  90009C            MOV     DPTR,#date
   \   076F  E0                MOVX    A,@DPTR
   \   0770  FF                MOV     R7,A
   \   0771  90009B            MOV     DPTR,#month
   \   0774  E0                MOVX    A,@DPTR
   \   0775  FE                MOV     R6,A
   \   0776  90009A            MOV     DPTR,#year
   \   0779  E0                MOVX    A,@DPTR
   \   077A  FD                MOV     R5,A
   \   077B  9000A2            MOV     DPTR,#timCur
   \   077E  E0                MOVX    A,@DPTR
   \   077F  FC                MOV     R4,A
   \   0780  120000            LCALL   $REFFN DispSetTimeDate
   \   0783            ?0157:
   \   0783            ?0155:
   \   0783            ?0149:
   \   0783            ?0146:
   \   0783            ?0141:
   \   0783  0208AE            LJMP    ?0161
   \   0786            ?0135:
    413                              }
    414                          } else if (lastKey == 8) {
   \   0786  B40802            CJNE    A,#8,$+5
   \   0789  8003              SJMP    $+5
   \   078B  020885            LJMP    ?0163
   \   078E            ?0162:
    415                              menuState = MS_MENU;
    416                              c = year / 10;
   \   078E  90009A            MOV     DPTR,#year
   \   0791  E0                MOVX    A,@DPTR
   \   0792  75F00A            MOV     B,#10
   \   0795  84                DIV     AB
   \   0796  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0799  F0                MOVX    @DPTR,A
    417                              WriteCalenderByte(0x06, (c << 4) + year - (c * 10));
   \   079A  E0                MOVX    A,@DPTR
   \   079B  C4                SWAP    A
   \   079C  54F0              ANL     A,#240
   \   079E  FC                MOV     R4,A
   \   079F  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   07A2  E0                MOVX    A,@DPTR
   \   07A3  75F00A            MOV     B,#10
   \   07A6  A4                MUL     AB
   \   07A7  F4                CPL     A
   \   07A8  04                INC     A
   \   07A9  2C                ADD     A,R4
   \   07AA  FC                MOV     R4,A
   \   07AB  90009A            MOV     DPTR,#year
   \   07AE  E0                MOVX    A,@DPTR
   \   07AF  2C                ADD     A,R4
   \   07B0  FD                MOV     R5,A
   \   07B1  7C06              MOV     R4,#6
   \   07B3  120000            LCALL   $REFFN WriteCalenderByte
    418                              c = month / 10;
   \   07B6  90009B            MOV     DPTR,#month
   \   07B9  E0                MOVX    A,@DPTR
   \   07BA  75F00A            MOV     B,#10
   \   07BD  84                DIV     AB
   \   07BE  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   07C1  F0                MOVX    @DPTR,A
    419                              WriteCalenderByte(0x05, (c << 4) + month - (c * 10));
   \   07C2  E0                MOVX    A,@DPTR
   \   07C3  C4                SWAP    A
   \   07C4  54F0              ANL     A,#240
   \   07C6  FC                MOV     R4,A
   \   07C7  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   07CA  E0                MOVX    A,@DPTR
   \   07CB  75F00A            MOV     B,#10
   \   07CE  A4                MUL     AB
   \   07CF  F4                CPL     A
   \   07D0  04                INC     A
   \   07D1  2C                ADD     A,R4
   \   07D2  FC                MOV     R4,A
   \   07D3  90009B            MOV     DPTR,#month
   \   07D6  E0                MOVX    A,@DPTR
   \   07D7  2C                ADD     A,R4
   \   07D8  FD                MOV     R5,A
   \   07D9  7C05              MOV     R4,#5
   \   07DB  120000            LCALL   $REFFN WriteCalenderByte
    420                              c = date / 10;
   \   07DE  90009C            MOV     DPTR,#date
   \   07E1  E0                MOVX    A,@DPTR
   \   07E2  75F00A            MOV     B,#10
   \   07E5  84                DIV     AB
   \   07E6  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   07E9  F0                MOVX    @DPTR,A
    421                              WriteCalenderByte(0x04, (c << 4) + date - (c * 10));
   \   07EA  E0                MOVX    A,@DPTR
   \   07EB  C4                SWAP    A
   \   07EC  54F0              ANL     A,#240
   \   07EE  FC                MOV     R4,A
   \   07EF  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   07F2  E0                MOVX    A,@DPTR
   \   07F3  75F00A            MOV     B,#10
   \   07F6  A4                MUL     AB
   \   07F7  F4                CPL     A
   \   07F8  04                INC     A
   \   07F9  2C                ADD     A,R4
   \   07FA  FC                MOV     R4,A
   \   07FB  90009C            MOV     DPTR,#date
   \   07FE  E0                MOVX    A,@DPTR
   \   07FF  2C                ADD     A,R4
   \   0800  FD                MOV     R5,A
   \   0801  7C04              MOV     R4,#4
   \   0803  120000            LCALL   $REFFN WriteCalenderByte
    422                              c = hour / 10;
   \   0806  9000A0            MOV     DPTR,#hour
   \   0809  E0                MOVX    A,@DPTR
   \   080A  75F00A            MOV     B,#10
   \   080D  84                DIV     AB
   \   080E  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0811  F0                MOVX    @DPTR,A
    423                              WriteCalenderByte(0x02, (c << 4) + hour - (c * 10));
   \   0812  E0                MOVX    A,@DPTR
   \   0813  C4                SWAP    A
   \   0814  54F0              ANL     A,#240
   \   0816  FC                MOV     R4,A
   \   0817  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   081A  E0                MOVX    A,@DPTR
   \   081B  75F00A            MOV     B,#10
   \   081E  A4                MUL     AB
   \   081F  F4                CPL     A
   \   0820  04                INC     A
   \   0821  2C                ADD     A,R4
   \   0822  FC                MOV     R4,A
   \   0823  9000A0            MOV     DPTR,#hour
   \   0826  E0                MOVX    A,@DPTR
   \   0827  2C                ADD     A,R4
   \   0828  FD                MOV     R5,A
   \   0829  7C02              MOV     R4,#2
   \   082B  120000            LCALL   $REFFN WriteCalenderByte
    424                              c = minute / 10;
   \   082E  9000A1            MOV     DPTR,#minute
   \   0831  E0                MOVX    A,@DPTR
   \   0832  75F00A            MOV     B,#10
   \   0835  84                DIV     AB
   \   0836  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0839  F0                MOVX    @DPTR,A
    425                              WriteCalenderByte(0x01, (c << 4) + minute - (c * 10));
   \   083A  E0                MOVX    A,@DPTR
   \   083B  C4                SWAP    A
   \   083C  54F0              ANL     A,#240
   \   083E  FC                MOV     R4,A
   \   083F  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0842  E0                MOVX    A,@DPTR
   \   0843  75F00A            MOV     B,#10
   \   0846  A4                MUL     AB
   \   0847  F4                CPL     A
   \   0848  04                INC     A
   \   0849  2C                ADD     A,R4
   \   084A  FC                MOV     R4,A
   \   084B  9000A1            MOV     DPTR,#minute
   \   084E  E0                MOVX    A,@DPTR
   \   084F  2C                ADD     A,R4
   \   0850  FD                MOV     R5,A
   \   0851  7C01              MOV     R4,#1
   \   0853  120000            LCALL   $REFFN WriteCalenderByte
    426                              WriteCalenderByte(0x00, 0);
   \   0856  7D00              MOV     R5,#0
   \   0858  7C00              MOV     R4,#0
   \   085A  120000            LCALL   $REFFN WriteCalenderByte
    427                              DispOptionsMenu(answerOn, numSignals);
   \   085D  900095            MOV     DPTR,#numSignals
   \   0860  E0                MOVX    A,@DPTR
   \   0861  FD                MOV     R5,A
   \   0862  900000            MOV     DPTR,#answerOn
   \   0865  E0                MOVX    A,@DPTR
   \   0866  FC                MOV     R4,A
   \   0867  120000            LCALL   $REFFN DispOptionsMenu
    428                              OptionCursorAt(menuSelection);
   \   086A  900094            MOV     DPTR,#menuSelection
   \   086D  E0                MOVX    A,@DPTR
   \   086E  7D00              MOV     R5,#0
   \   0870  FC                MOV     R4,A
   \   0871  120000            LCALL   $REFFN OptionCursorAt
    429                              DisplayMenu("  NEXT   SELECT           BACK");
   \   0874  7D9B              MOV     R5,#LOW(?0056)
   \   0876  7E00              MOV     R6,#HIGH(?0056)
   \   0878  7F02              MOV     R7,#2
   \   087A  120000            LCALL   $REFFN DisplayMenu
   \   087D  7402              MOV     A,#2
   \   087F  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   0882  F0                MOVX    @DPTR,A
   \   0883  8029              SJMP    ?0164
   \   0885            ?0163:
    430                          } else if (lastKey == 16) {
   \   0885  B41026            CJNE    A,#16,?0166
   \   0888            ?0165:
    431                              menuState = MS_MENU;
    432                              DispOptionsMenu(answerOn, numSignals);
   \   0888  900095            MOV     DPTR,#numSignals
   \   088B  E0                MOVX    A,@DPTR
   \   088C  FD                MOV     R5,A
   \   088D  900000            MOV     DPTR,#answerOn
   \   0890  E0                MOVX    A,@DPTR
   \   0891  FC                MOV     R4,A
   \   0892  120000            LCALL   $REFFN DispOptionsMenu
    433                              OptionCursorAt(menuSelection);
   \   0895  900094            MOV     DPTR,#menuSelection
   \   0898  E0                MOVX    A,@DPTR
   \   0899  7D00              MOV     R5,#0
   \   089B  FC                MOV     R4,A
   \   089C  120000            LCALL   $REFFN OptionCursorAt
    434                              DisplayMenu("  NEXT   SELECT           BACK");
   \   089F  7D9B              MOV     R5,#LOW(?0056)
   \   08A1  7E00              MOV     R6,#HIGH(?0056)
   \   08A3  7F02              MOV     R7,#2
   \   08A5  120000            LCALL   $REFFN DisplayMenu
   \   08A8  7402              MOV     A,#2
   \   08AA  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   08AD  F0                MOVX    @DPTR,A
   \   08AE            ?0166:
   \   08AE            ?0164:
   \   08AE            ?0161:
   \   08AE            ?0133:
   \   08AE            ?0108:
    435                          }
    436                          break;
   \   08AE  020A83            LJMP    ?0024
   \   08B1            ?0167:
    437                      case MS_ERASEQST:
    438                          if (lastKey == 2) {
   \   08B1  900000            MOV     DPTR,#lastKey
   \   08B4  E0                MOVX    A,@DPTR
   \   08B5  B40202            CJNE    A,#2,$+5
   \   08B8  8003              SJMP    $+5
   \   08BA  0209FD            LJMP    ?0169
   \   08BD            ?0168:
    439                              DispInfoBox("Erasing messages", "Please wait...");
   \   08BD  7F02              MOV     R7,#2
   \   08BF  900000            MOV     DPTR,#$PRMBX DispInfoBox+3
   \   08C2  EF                MOV     A,R7
   \   08C3  F0                MOVX    @DPTR,A
   \   08C4  A3                INC     DPTR
   \   08C5  7400              MOV     A,#HIGH(?0002)
   \   08C7  F0                MOVX    @DPTR,A
   \   08C8  A3                INC     DPTR
   \   08C9  7430              MOV     A,#LOW(?0002)
   \   08CB  F0                MOVX    @DPTR,A
   \   08CC  7D04              MOV     R5,#LOW(?0170)
   \   08CE  7E01              MOV     R6,#HIGH(?0170)
   \   08D0  120000            LCALL   $REFFN DispInfoBox
    440                              EraseDynamic();
   \   08D3  120000            LCALL   $REFFN EraseDynamic
    441                              WriteCalenderByte(NV_PLAYED_MS, 0xFF);
   \   08D6  7DFF              MOV     R5,#255
   \   08D8  7C0A              MOV     R4,#10
   \   08DA  120000            LCALL   $REFFN WriteCalenderByte
    442                              WriteCalenderByte(NV_PLAYED_LS, 0xFF);
   \   08DD  7DFF              MOV     R5,#255
   \   08DF  7C0B              MOV     R4,#11
   \   08E1  120000            LCALL   $REFFN WriteCalenderByte
    443                              lastPlayed = -1;
   \   08E4  900003            MOV     DPTR,#lastPlayed
   \   08E7  74FF              MOV     A,#255
   \   08E9  F0                MOVX    @DPTR,A
   \   08EA  A3                INC     DPTR
   \   08EB  F0                MOVX    @DPTR,A
    444                              nextMemoIndex = 0;
   \   08EC  900006            MOV     DPTR,#nextMemoIndex
   \   08EF  E4                CLR     A
   \   08F0  F0                MOVX    @DPTR,A
   \   08F1  A3                INC     DPTR
   \   08F2  F0                MOVX    @DPTR,A
    445                              df = fopen("Log.txt", "r");
   \   08F3  7F02              MOV     R7,#2
   \   08F5  900000            MOV     DPTR,#$PRMBX fopen+3
   \   08F8  EF                MOV     A,R7
   \   08F9  F0                MOVX    @DPTR,A
   \   08FA  A3                INC     DPTR
   \   08FB  7401              MOV     A,#HIGH(?0172)
   \   08FD  F0                MOVX    @DPTR,A
   \   08FE  A3                INC     DPTR
   \   08FF  741D              MOV     A,#LOW(?0172)
   \   0901  F0                MOVX    @DPTR,A
   \   0902  7D15              MOV     R5,#LOW(?0171)
   \   0904  7E01              MOV     R6,#HIGH(?0171)
   \   0906  120000            LCALL   $REFFN fopen
    446                              if (df) {
   \   0909  900000            MOV     DPTR,#$LOCBX WaitForCall+70
   \   090C  EF                MOV     A,R7
   \   090D  F0                MOVX    @DPTR,A
   \   090E  A3                INC     DPTR
   \   090F  EE                MOV     A,R6
   \   0910  F0                MOVX    @DPTR,A
   \   0911  A3                INC     DPTR
   \   0912  ED                MOV     A,R5
   \   0913  F0                MOVX    @DPTR,A
   \   0914  4E                ORL     A,R6
   \   0915  602C              JZ      ?0174
   \   0917            ?0173:
    447                                  fclose(df);
   \   0917  120000            LCALL   $REFFN fclose
    448                                  menuState = MS_MENU;
    449                                  DispOptionsMenu(answerOn, numSignals);
   \   091A  900095            MOV     DPTR,#numSignals
   \   091D  E0                MOVX    A,@DPTR
   \   091E  FD                MOV     R5,A
   \   091F  900000            MOV     DPTR,#answerOn
   \   0922  E0                MOVX    A,@DPTR
   \   0923  FC                MOV     R4,A
   \   0924  120000            LCALL   $REFFN DispOptionsMenu
    450                                  OptionCursorAt(menuSelection);
   \   0927  900094            MOV     DPTR,#menuSelection
   \   092A  E0                MOVX    A,@DPTR
   \   092B  7D00              MOV     R5,#0
   \   092D  FC                MOV     R4,A
   \   092E  120000            LCALL   $REFFN OptionCursorAt
    451                                  DisplayMenu("  NEXT   SELECT           BACK");
   \   0931  7D9B              MOV     R5,#LOW(?0056)
   \   0933  7E00              MOV     R6,#HIGH(?0056)
   \   0935  7F02              MOV     R7,#2
   \   0937  120000            LCALL   $REFFN DisplayMenu
   \   093A  7402              MOV     A,#2
   \   093C  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   093F  F0                MOVX    @DPTR,A
    452                              } else {
   \   0940  0209D5            LJMP    ?0175
   \   0943            ?0174:
    453                                  CreateLog();
   \   0943  120000            LCALL   $REFFN CreateLog
    454          
    455                                  DispInfoBox("Initializing answering machine", "Please wait...");
   \   0946  7F02              MOV     R7,#2
   \   0948  900000            MOV     DPTR,#$PRMBX DispInfoBox+3
   \   094B  EF                MOV     A,R7
   \   094C  F0                MOVX    @DPTR,A
   \   094D  A3                INC     DPTR
   \   094E  7400              MOV     A,#HIGH(?0002)
   \   0950  F0                MOVX    @DPTR,A
   \   0951  A3                INC     DPTR
   \   0952  7430              MOV     A,#LOW(?0002)
   \   0954  F0                MOVX    @DPTR,A
   \   0955  7D11              MOV     R5,#LOW(?0001)
   \   0957  7E00              MOV     R6,#HIGH(?0001)
   \   0959  120000            LCALL   $REFFN DispInfoBox
    456          
    457                                  if (BuildCallerList()) {
   \   095C  120000            LCALL   $REFFN BuildCallerList
   \   095F  EC                MOV     A,R4
   \   0960  6048              JZ      ?0177
   \   0962            ?0176:
    458                                      ReadCalenderByte(NV_PLAYED_MS, &c);
   \   0962  7D00              MOV     R5,#LOW ($LOCBX WaitForCall+44)
   \   0964  7E00              MOV     R6,#HIGH ($LOCBX WaitForCall+44)
   \   0966  7F01              MOV     R7,#1
   \   0968  7C0A              MOV     R4,#10
   \   096A  120000            LCALL   $REFFN ReadCalenderByte
    459                                      lastPlayed = c << 8;
   \   096D  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0970  E0                MOVX    A,@DPTR
    460                                      ReadCalenderByte(NV_PLAYED_LS, &c);
   \   0971  900003            MOV     DPTR,#lastPlayed
   \   0974  F0                MOVX    @DPTR,A
   \   0975  A3                INC     DPTR
   \   0976  E4                CLR     A
   \   0977  F0                MOVX    @DPTR,A
   \   0978  7D00              MOV     R5,#LOW ($LOCBX WaitForCall+44)
   \   097A  7E00              MOV     R6,#HIGH ($LOCBX WaitForCall+44)
   \   097C  7F01              MOV     R7,#1
   \   097E  7C0B              MOV     R4,#11
   \   0980  120000            LCALL   $REFFN ReadCalenderByte
    461                                      lastPlayed += c;
   \   0983  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0986  E0                MOVX    A,@DPTR
   \   0987  7D00              MOV     R5,#0
   \   0989  FC                MOV     R4,A
   \   098A  900004            MOV     DPTR,#lastPlayed+1
   \   098D  E0                MOVX    A,@DPTR
   \   098E  2C                ADD     A,R4
   \   098F  F0                MOVX    @DPTR,A
   \   0990  900003            MOV     DPTR,#lastPlayed
   \   0993  E0                MOVX    A,@DPTR
   \   0994  3D                ADDC    A,R5
   \   0995  F0                MOVX    @DPTR,A
    462                                      if (lastPlayed == 0xFFFF) lastPlayed = -1;
   \   0996  A3                INC     DPTR
   \   0997  E0                MOVX    A,@DPTR
   \   0998  04                INC     A
   \   0999  7005              JNZ     ?0555
   \   099B  900003            MOV     DPTR,#lastPlayed
   \   099E  E0                MOVX    A,@DPTR
   \   099F  04                INC     A
   \   09A0            ?0555:
   \   09A0  7008              JNZ     ?0179
   \   09A2            ?0178:
   \   09A2  900003            MOV     DPTR,#lastPlayed
   \   09A5  74FF              MOV     A,#255
   \   09A7  F0                MOVX    @DPTR,A
   \   09A8  A3                INC     DPTR
   \   09A9  F0                MOVX    @DPTR,A
   \   09AA            ?0179:
   \   09AA            ?0177:
    463                                  }
    464          
    465                                  menuSelection = 0;
   \   09AA  E4                CLR     A
   \   09AB  900094            MOV     DPTR,#menuSelection
   \   09AE  F0                MOVX    @DPTR,A
    466                                  menuState = MS_LOG;
    467          
    468                                  ClearDisp();
   \   09AF  120000            LCALL   $REFFN ClearDisp
    469                                  FillDispBuffer();
   \   09B2  120000            LCALL   $REFFN FillDispBuffer
    470           
    471                                  cursor = 0;
   \   09B5  900092            MOV     DPTR,#cursor
   \   09B8  E4                CLR     A
   \   09B9  F0                MOVX    @DPTR,A
   \   09BA  A3                INC     DPTR
   \   09BB  F0                MOVX    @DPTR,A
    472                                  LogCursorAt(0, 1);
   \   09BC  7E01              MOV     R6,#1
   \   09BE  FD                MOV     R5,A
   \   09BF  FC                MOV     R4,A
   \   09C0  120000            LCALL   $REFFN LogCursorAt
    473                                  DispMemUsage();
   \   09C3  120000            LCALL   $REFFN DispMemUsage
    474                                  DisplayMenu("  PLAY     UP     DOWN    MENU   PLAY NEW");
   \   09C6  7D52              MOV     R5,#LOW(?0012)
   \   09C8  7E00              MOV     R6,#HIGH(?0012)
   \   09CA  7F02              MOV     R7,#2
   \   09CC  120000            LCALL   $REFFN DisplayMenu
   \   09CF  7401              MOV     A,#1
   \   09D1  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   09D4  F0                MOVX    @DPTR,A
   \   09D5            ?0175:
    475              
    476                              }
    477                              menuState = MS_MENU;
    478                              DispOptionsMenu(answerOn, numSignals);
   \   09D5  900095            MOV     DPTR,#numSignals
   \   09D8  E0                MOVX    A,@DPTR
   \   09D9  FD                MOV     R5,A
   \   09DA  900000            MOV     DPTR,#answerOn
   \   09DD  E0                MOVX    A,@DPTR
   \   09DE  FC                MOV     R4,A
   \   09DF  120000            LCALL   $REFFN DispOptionsMenu
    479                              OptionCursorAt(menuSelection);
   \   09E2  900094            MOV     DPTR,#menuSelection
   \   09E5  E0                MOVX    A,@DPTR
   \   09E6  7D00              MOV     R5,#0
   \   09E8  FC                MOV     R4,A
   \   09E9  120000            LCALL   $REFFN OptionCursorAt
    480                              DisplayMenu("  NEXT   SELECT           BACK");
   \   09EC  7D9B              MOV     R5,#LOW(?0056)
   \   09EE  7E00              MOV     R6,#HIGH(?0056)
   \   09F0  7F02              MOV     R7,#2
   \   09F2  120000            LCALL   $REFFN DisplayMenu
   \   09F5  7402              MOV     A,#2
   \   09F7  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   09FA  F0                MOVX    @DPTR,A
   \   09FB  8029              SJMP    ?0180
   \   09FD            ?0169:
    481                          } else if (lastKey == 8) {
   \   09FD  B40826            CJNE    A,#8,?0182
   \   0A00            ?0181:
    482                              menuState = MS_MENU;
    483                              DispOptionsMenu(answerOn, numSignals);
   \   0A00  900095            MOV     DPTR,#numSignals
   \   0A03  E0                MOVX    A,@DPTR
   \   0A04  FD                MOV     R5,A
   \   0A05  900000            MOV     DPTR,#answerOn
   \   0A08  E0                MOVX    A,@DPTR
   \   0A09  FC                MOV     R4,A
   \   0A0A  120000            LCALL   $REFFN DispOptionsMenu
    484                              OptionCursorAt(menuSelection);
   \   0A0D  900094            MOV     DPTR,#menuSelection
   \   0A10  E0                MOVX    A,@DPTR
   \   0A11  7D00              MOV     R5,#0
   \   0A13  FC                MOV     R4,A
   \   0A14  120000            LCALL   $REFFN OptionCursorAt
    485                              DisplayMenu("  NEXT   SELECT           BACK");
   \   0A17  7D9B              MOV     R5,#LOW(?0056)
   \   0A19  7E00              MOV     R6,#HIGH(?0056)
   \   0A1B  7F02              MOV     R7,#2
   \   0A1D  120000            LCALL   $REFFN DisplayMenu
   \   0A20  7402              MOV     A,#2
   \   0A22  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   0A25  F0                MOVX    @DPTR,A
   \   0A26            ?0182:
   \   0A26            ?0180:
    486                          }
    487                          break;
   \   0A26  805B              SJMP    ?0024
   \   0A28            ?0183:
    488                      case MS_MEMO:
    489                          if (lastKey == 1) {
   \   0A28  900000            MOV     DPTR,#lastKey
   \   0A2B  E0                MOVX    A,@DPTR
   \   0A2C  14                DEC     A
   \   0A2D  7011              JNZ     ?0185
   \   0A2F            ?0184:
    490                              PlayMemo();
   \   0A2F  120000            LCALL   $REFFN PlayMemo
    491                              DispMemoScreen();
   \   0A32  120000            LCALL   $REFFN DispMemoScreen
    492                              DisplayMenu("  PLAY   RECORD            BACK");
   \   0A35  7DBA              MOV     R5,#LOW(?0070)
   \   0A37  7E00              MOV     R6,#HIGH(?0070)
   \   0A39  7F02              MOV     R7,#2
   \   0A3B  120000            LCALL   $REFFN DisplayMenu
   \   0A3E  8041              SJMP    ?0186
   \   0A40            ?0185:
    493                          } else if (lastKey == 2) {
   \   0A40  E0                MOVX    A,@DPTR
   \   0A41  B40214            CJNE    A,#2,?0188
   \   0A44            ?0187:
    494                              RecordMemo();
   \   0A44  120000            LCALL   $REFFN RecordMemo
    495                              DispMemoScreen();
   \   0A47  120000            LCALL   $REFFN DispMemoScreen
    496                              DispMemUsage();
   \   0A4A  120000            LCALL   $REFFN DispMemUsage
    497                              DisplayMenu("  PLAY   RECORD            BACK");
   \   0A4D  7DBA              MOV     R5,#LOW(?0070)
   \   0A4F  7E00              MOV     R6,#HIGH(?0070)
   \   0A51  7F02              MOV     R7,#2
   \   0A53  120000            LCALL   $REFFN DisplayMenu
   \   0A56  8029              SJMP    ?0189
   \   0A58            ?0188:
    498                          } else if (lastKey == 8) {
   \   0A58  B40826            CJNE    A,#8,?0191
   \   0A5B            ?0190:
    499                              menuState = MS_MENU;
    500                              DispOptionsMenu(answerOn, numSignals);
   \   0A5B  900095            MOV     DPTR,#numSignals
   \   0A5E  E0                MOVX    A,@DPTR
   \   0A5F  FD                MOV     R5,A
   \   0A60  900000            MOV     DPTR,#answerOn
   \   0A63  E0                MOVX    A,@DPTR
   \   0A64  FC                MOV     R4,A
   \   0A65  120000            LCALL   $REFFN DispOptionsMenu
    501                              OptionCursorAt(menuSelection);
   \   0A68  900094            MOV     DPTR,#menuSelection
   \   0A6B  E0                MOVX    A,@DPTR
   \   0A6C  7D00              MOV     R5,#0
   \   0A6E  FC                MOV     R4,A
   \   0A6F  120000            LCALL   $REFFN OptionCursorAt
    502                              DisplayMenu("  NEXT   SELECT           BACK");
   \   0A72  7D9B              MOV     R5,#LOW(?0056)
   \   0A74  7E00              MOV     R6,#HIGH(?0056)
   \   0A76  7F02              MOV     R7,#2
   \   0A78  120000            LCALL   $REFFN DisplayMenu
   \   0A7B  7402              MOV     A,#2
   \   0A7D  900000            MOV     DPTR,#$LOCBX WaitForCall+60
   \   0A80  F0                MOVX    @DPTR,A
   \   0A81            ?0191:
   \   0A81            ?0189:
   \   0A81            ?0186:
    503                          }
    504                          break;
   \   0A81  8000              SJMP    ?0024
   \   0A83            ?0024:
    505                      }
    506          
    507                      lastKey = 0;
   \   0A83  E4                CLR     A
   \   0A84  900000            MOV     DPTR,#lastKey
   \   0A87  F0                MOVX    @DPTR,A
   \   0A88  020132            LJMP    ?0017
   \   0A8B            ?0016:
    508           
    509                  }
    510          
    511          //        SendStringEOLRS232("DTMF detected");
    512           
    513                  timer = StartTimer(300);                   //Tre sekunders timout
   \   0A8B  7D01              MOV     R5,#1
   \   0A8D  7C2C              MOV     R4,#44
   \   0A8F  120000            LCALL   $REFFN StartTimer
   \   0A92  EC                MOV     A,R4
   \   0A93  900000            MOV     DPTR,#$LOCBX WaitForCall+68
   \   0A96  F0                MOVX    @DPTR,A
   \   0A97            ?0194:
    514          
    515                  do {
    516                      c = DecodeReceivedDTMF();
   \   0A97  120000            LCALL   $REFFN DecodeReceivedDTMF
   \   0A9A  EC                MOV     A,R4
   \   0A9B  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0A9E  F0                MOVX    @DPTR,A
    517                      WDT = 1;
   \   0A9F  D2AE              SETB    IE.6
    518                      SWDT = 1;
   \   0AA1  D2BE              SETB    IP.6
    519                  } while ((!TimedOut(timer)) && (c != 'C'));
   \   0AA3  900000            MOV     DPTR,#$LOCBX WaitForCall+68
   \   0AA6  E0                MOVX    A,@DPTR
   \   0AA7  FC                MOV     R4,A
   \   0AA8  120000            LCALL   $REFFN TimedOut
   \   0AAB  BC0007            CJNE    R4,#0,?0192
   \   0AAE  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0AB1  E0                MOVX    A,@DPTR
   \   0AB2  B443E2            CJNE    A,#67,?0194
   \   0AB5            ?0192:
    520                  
    521                  KillTimer(timer);
   \   0AB5  900000            MOV     DPTR,#$LOCBX WaitForCall+68
   \   0AB8  E0                MOVX    A,@DPTR
   \   0AB9  FC                MOV     R4,A
   \   0ABA  120000            LCALL   $REFFN KillTimer
    522                  
    523                  if (c == 'C') legalCallNumber = 1;
   \   0ABD  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0AC0  E0                MOVX    A,@DPTR
   \   0AC1  B44306            CJNE    A,#67,?0198
   \   0AC4            ?0197:
   \   0AC4  7401              MOV     A,#1
   \   0AC6  900000            MOV     DPTR,#$LOCBX WaitForCall+69
   \   0AC9  F0                MOVX    @DPTR,A
   \   0ACA            ?0198:
    524          
    525              } while (!legalCallNumber);
   \   0ACA  900000            MOV     DPTR,#$LOCBX WaitForCall+69
   \   0ACD  E0                MOVX    A,@DPTR
   \   0ACE  7003              JNZ     $+5
   \   0AD0  02012A            LJMP    ?0015
   \   0AD3            ?0013:
    526          
    527          //    SendStringEOLRS232("Legal call detected");
    528           
    529              j = 0;
   \   0AD3  900000            MOV     DPTR,#$LOCBX WaitForCall+42
   \   0AD6  E4                CLR     A
   \   0AD7  F0                MOVX    @DPTR,A
   \   0AD8  A3                INC     DPTR
   \   0AD9  F0                MOVX    @DPTR,A
   \   0ADA            ?0200:
    530          
    531              while (c = GetNextDTMF()) {
   \   0ADA  120000            LCALL   $REFFN GetNextDTMF
   \   0ADD  EC                MOV     A,R4
   \   0ADE  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0AE1  F0                MOVX    @DPTR,A
   \   0AE2  6033              JZ      ?0199
   \   0AE4            ?0201:
    532                  if ((c >= '0') && (c <= '9')) DTMFString[j++] = c;
   \   0AE4  24D0              ADD     A,#208
   \   0AE6  5029              JNC     ?0203
   \   0AE8  E0                MOVX    A,@DPTR
   \   0AE9  24C6              ADD     A,#198
   \   0AEB  4024              JC      ?0203
   \   0AED            ?0205:
   \   0AED            ?0204:
   \   0AED            ?0202:
   \   0AED  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0AF0  E0                MOVX    A,@DPTR
   \   0AF1  900000            MOV     DPTR,#$LOCBX WaitForCall+42
   \   0AF4  FE                MOV     R6,A
   \   0AF5  E0                MOVX    A,@DPTR
   \   0AF6  FD                MOV     R5,A
   \   0AF7  A3                INC     DPTR
   \   0AF8  E0                MOVX    A,@DPTR
   \   0AF9  FC                MOV     R4,A
   \   0AFA  E0                MOVX    A,@DPTR
   \   0AFB  04                INC     A
   \   0AFC  F0                MOVX    @DPTR,A
   \   0AFD  900000            MOV     DPTR,#$LOCBX WaitForCall+42
   \   0B00  7003              JNZ     ?0556
   \   0B02  E0                MOVX    A,@DPTR
   \   0B03  04                INC     A
   \   0B04  F0                MOVX    @DPTR,A
   \   0B05            ?0556:
   \   0B05  EC                MOV     A,R4
   \   0B06  2400              ADD     A,#LOW $LOCBX WaitForCall
   \   0B08  F582              MOV     DPL,A
   \   0B0A  E4                CLR     A
   \   0B0B  3400              ADDC    A,#HIGH $LOCBX WaitForCall
   \   0B0D  F583              MOV     DPH,A
   \   0B0F  EE                MOV     A,R6
   \   0B10  F0                MOVX    @DPTR,A
   \   0B11            ?0203:
    533                  WDT = 1;
   \   0B11  D2AE              SETB    IE.6
    534                  SWDT = 1;
   \   0B13  D2BE              SETB    IP.6
   \   0B15  80C3              SJMP    ?0200
   \   0B17            ?0199:
    535              } 
    536              
    537           
    538              DTMFString[j] = 0x00;
   \   0B17  900000            MOV     DPTR,#$LOCBX WaitForCall+43
   \   0B1A  E0                MOVX    A,@DPTR
   \   0B1B  2400              ADD     A,#LOW $LOCBX WaitForCall
   \   0B1D  F582              MOV     DPL,A
   \   0B1F  E4                CLR     A
   \   0B20  3400              ADDC    A,#HIGH $LOCBX WaitForCall
   \   0B22  F583              MOV     DPH,A
   \   0B24  E4                CLR     A
   \   0B25  F0                MOVX    @DPTR,A
    539          
    540          //    SendStringRS232("Number: ");
    541          //    SendStringEOLRS232(DTMFString);
    542              
    543              callerCategory = 0;
   \   0B26  900005            MOV     DPTR,#callerCategory
   \   0B29  F0                MOVX    @DPTR,A
    544              LookUpCaller(DTMFString, callerName, &callerCategory);
   \   0B2A  7F01              MOV     R7,#1
   \   0B2C  900000            MOV     DPTR,#$PRMBX LookUpCaller+6
   \   0B2F  EF                MOV     A,R7
   \   0B30  F0                MOVX    @DPTR,A
   \   0B31  A3                INC     DPTR
   \   0B32  7400              MOV     A,#HIGH(callerCategory)
   \   0B34  F0                MOVX    @DPTR,A
   \   0B35  A3                INC     DPTR
   \   0B36  7405              MOV     A,#LOW(callerCategory)
   \   0B38  F0                MOVX    @DPTR,A
   \   0B39  900000            MOV     DPTR,#$PRMBX LookUpCaller+3
   \   0B3C  EF                MOV     A,R7
   \   0B3D  F0                MOVX    @DPTR,A
   \   0B3E  A3                INC     DPTR
   \   0B3F  7440              MOV     A,#HIGH(callerName)
   \   0B41  F0                MOVX    @DPTR,A
   \   0B42  A3                INC     DPTR
   \   0B43  74A5              MOV     A,#LOW(callerName)
   \   0B45  F0                MOVX    @DPTR,A
   \   0B46  7D00              MOV     R5,#LOW $LOCBX WaitForCall
   \   0B48  7E00              MOV     R6,#HIGH $LOCBX WaitForCall
   \   0B4A  120000            LCALL   $REFFN LookUpCaller
    545          
    546              WDT = 1;
   \   0B4D  D2AE              SETB    IE.6
    547              SWDT = 1;
   \   0B4F  D2BE              SETB    IP.6
    548              
    549          //    i = ftell(logFilePtr);
    550              i = logOffset;
   \   0B51  900002            MOV     DPTR,#logOffset+2
   \   0B54  E0                MOVX    A,@DPTR
   \   0B55  FD                MOV     R5,A
   \   0B56  A3                INC     DPTR
   \   0B57  E0                MOVX    A,@DPTR
    551              callIndex[numOfCalls++] = i + 4;
   \   0B58  900000            MOV     DPTR,#$LOCBX WaitForCall+40
   \   0B5B  CD                XCH     A,R5
   \   0B5C  F0                MOVX    @DPTR,A
   \   0B5D  A3                INC     DPTR
   \   0B5E  CD                XCH     A,R5
   \   0B5F  F0                MOVX    @DPTR,A
   \   0B60  2404              ADD     A,#4
   \   0B62  FC                MOV     R4,A
   \   0B63  E4                CLR     A
   \   0B64  3D                ADDC    A,R5
   \   0B65  FD                MOV     R5,A
   \   0B66  900001            MOV     DPTR,#numOfCalls
   \   0B69  E0                MOVX    A,@DPTR
   \   0B6A  FF                MOV     R7,A
   \   0B6B  A3                INC     DPTR
   \   0B6C  E0                MOVX    A,@DPTR
   \   0B6D  FE                MOV     R6,A
   \   0B6E  E0                MOVX    A,@DPTR
   \   0B6F  04                INC     A
   \   0B70  F0                MOVX    @DPTR,A
   \   0B71  900001            MOV     DPTR,#numOfCalls
   \   0B74  7003              JNZ     ?0557
   \   0B76  E0                MOVX    A,@DPTR
   \   0B77  04                INC     A
   \   0B78  F0                MOVX    @DPTR,A
   \   0B79            ?0557:
   \   0B79  EE                MOV     A,R6
   \   0B7A  25E0              ADD     A,ACC
   \   0B7C  CF                XCH     A,R7
   \   0B7D  33                RLC     A
   \   0B7E  CF                XCH     A,R7
   \   0B7F  FE                MOV     R6,A
   \   0B80  2400              ADD     A,#LOW(callIndex)
   \   0B82  F582              MOV     DPL,A
   \   0B84  EF                MOV     A,R7
   \   0B85  3400              ADDC    A,#HIGH(callIndex)
   \   0B87  F583              MOV     DPH,A
   \   0B89  FF                MOV     R7,A
   \   0B8A  ED                MOV     A,R5
   \   0B8B  F0                MOVX    @DPTR,A
   \   0B8C  A3                INC     DPTR
   \   0B8D  EC                MOV     A,R4
   \   0B8E  F0                MOVX    @DPTR,A
    552          
    553              WDT = 1;
   \   0B8F  D2AE              SETB    IE.6
    554              SWDT = 1;
   \   0B91  D2BE              SETB    IP.6
    555          
    556              GetDateNow(&dateNow);
   \   0B93  7D00              MOV     R5,#LOW ($LOCBX WaitForCall+61)
   \   0B95  7E00              MOV     R6,#HIGH ($LOCBX WaitForCall+61)
   \   0B97  7F01              MOV     R7,#1
   \   0B99  120000            LCALL   $REFFN GetDateNow
    557              CreateDateString2(&dateNow, msg);
   \   0B9C  7F01              MOV     R7,#1
   \   0B9E  900000            MOV     DPTR,#$PRMBX CreateDateString2+3
   \   0BA1  EF                MOV     A,R7
   \   0BA2  F0                MOVX    @DPTR,A
   \   0BA3  A3                INC     DPTR
   \   0BA4  7400              MOV     A,#HIGH(msg)
   \   0BA6  F0                MOVX    @DPTR,A
   \   0BA7  A3                INC     DPTR
   \   0BA8  7400              MOV     A,#LOW(msg)
   \   0BAA  F0                MOVX    @DPTR,A
   \   0BAB  7D00              MOV     R5,#LOW ($LOCBX WaitForCall+61)
   \   0BAD  7E00              MOV     R6,#HIGH ($LOCBX WaitForCall+61)
   \   0BAF  120000            LCALL   $REFFN CreateDateString2
    558              msg[6] = ' ';
   \   0BB2  7420              MOV     A,#32
   \   0BB4  900006            MOV     DPTR,#msg+6
   \   0BB7  F0                MOVX    @DPTR,A
    559          
    560              WDT = 1;
   \   0BB8  D2AE              SETB    IE.6
    561              SWDT = 1;
   \   0BBA  D2BE              SETB    IP.6
    562          
    563              GetTimeNow(&timeNow);
   \   0BBC  7D00              MOV     R5,#LOW ($LOCBX WaitForCall+65)
   \   0BBE  7E00              MOV     R6,#HIGH ($LOCBX WaitForCall+65)
   \   0BC0  7F01              MOV     R7,#1
   \   0BC2  120000            LCALL   $REFFN GetTimeNow
    564          
    565              CreateTimeString(&timeNow, timeStr);
   \   0BC5  7F01              MOV     R7,#1
   \   0BC7  900000            MOV     DPTR,#$PRMBX CreateTimeString+3
   \   0BCA  EF                MOV     A,R7
   \   0BCB  F0                MOVX    @DPTR,A
   \   0BCC  A3                INC     DPTR
   \   0BCD  7400              MOV     A,#HIGH ($LOCBX WaitForCall+45)
   \   0BCF  F0                MOVX    @DPTR,A
   \   0BD0  A3                INC     DPTR
   \   0BD1  7400              MOV     A,#LOW ($LOCBX WaitForCall+45)
   \   0BD3  F0                MOVX    @DPTR,A
   \   0BD4  7D00              MOV     R5,#LOW ($LOCBX WaitForCall+65)
   \   0BD6  7E00              MOV     R6,#HIGH ($LOCBX WaitForCall+65)
   \   0BD8  120000            LCALL   $REFFN CreateTimeString
    566          
    567              WDT = 1;
   \   0BDB  D2AE              SETB    IE.6
    568              SWDT = 1;
   \   0BDD  D2BE              SETB    IP.6
    569          
    570              msg[7] = timeStr[0];
   \   0BDF  900000            MOV     DPTR,#$LOCBX WaitForCall+45
   \   0BE2  E0                MOVX    A,@DPTR
   \   0BE3  900007            MOV     DPTR,#msg+7
   \   0BE6  F0                MOVX    @DPTR,A
    571              msg[8] = timeStr[1];
   \   0BE7  900000            MOV     DPTR,#$LOCBX WaitForCall+46
   \   0BEA  E0                MOVX    A,@DPTR
   \   0BEB  900008            MOV     DPTR,#msg+8
   \   0BEE  F0                MOVX    @DPTR,A
    572              msg[9] = timeStr[2];
   \   0BEF  900000            MOV     DPTR,#$LOCBX WaitForCall+47
   \   0BF2  E0                MOVX    A,@DPTR
   \   0BF3  900009            MOV     DPTR,#msg+9
   \   0BF6  F0                MOVX    @DPTR,A
    573              msg[10] = timeStr[3];
   \   0BF7  900000            MOV     DPTR,#$LOCBX WaitForCall+48
   \   0BFA  E0                MOVX    A,@DPTR
   \   0BFB  90000A            MOV     DPTR,#msg+10
   \   0BFE  F0                MOVX    @DPTR,A
    574              msg[11] = timeStr[4];
   \   0BFF  900000            MOV     DPTR,#$LOCBX WaitForCall+49
   \   0C02  E0                MOVX    A,@DPTR
   \   0C03  90000B            MOV     DPTR,#msg+11
   \   0C06  F0                MOVX    @DPTR,A
    575              msg[12] = 0x00; 
   \   0C07  E4                CLR     A
   \   0C08  A3                INC     DPTR
   \   0C09  F0                MOVX    @DPTR,A
    576           
    577              ReadCalenderByte(0x07, &c);
   \   0C0A  7D00              MOV     R5,#LOW ($LOCBX WaitForCall+44)
   \   0C0C  7E00              MOV     R6,#HIGH ($LOCBX WaitForCall+44)
   \   0C0E  7F01              MOV     R7,#1
   \   0C10  7C07              MOV     R4,#7
   \   0C12  120000            LCALL   $REFFN ReadCalenderByte
    578              if (c == 0x80) WriteCalenderByte(0x07, 0);  //Tänd diod
   \   0C15  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0C18  E0                MOVX    A,@DPTR
   \   0C19  B48007            CJNE    A,#128,?0207
   \   0C1C            ?0206:
   \   0C1C  7D00              MOV     R5,#0
   \   0C1E  7C07              MOV     R4,#7
   \   0C20  120000            LCALL   $REFFN WriteCalenderByte
   \   0C23            ?0207:
    579          
    580              DispInfoBox("Now calling:", callerName);
   \   0C23  7F01              MOV     R7,#1
   \   0C25  900000            MOV     DPTR,#$PRMBX DispInfoBox+3
   \   0C28  EF                MOV     A,R7
   \   0C29  F0                MOVX    @DPTR,A
   \   0C2A  A3                INC     DPTR
   \   0C2B  7440              MOV     A,#HIGH(callerName)
   \   0C2D  F0                MOVX    @DPTR,A
   \   0C2E  A3                INC     DPTR
   \   0C2F  74A5              MOV     A,#LOW(callerName)
   \   0C31  F0                MOVX    @DPTR,A
   \   0C32  7D1F              MOV     R5,#LOW(?0208)
   \   0C34  7E01              MOV     R6,#HIGH(?0208)
   \   0C36  0F                INC     R7
   \   0C37  120000            LCALL   $REFFN DispInfoBox
    581              
    582              if (answerOn) i = numSignals;
   \   0C3A  900000            MOV     DPTR,#answerOn
   \   0C3D  E0                MOVX    A,@DPTR
   \   0C3E  6010              JZ      ?0210
   \   0C40            ?0209:
   \   0C40  900095            MOV     DPTR,#numSignals
   \   0C43  E0                MOVX    A,@DPTR
   \   0C44  7D00              MOV     R5,#0
   \   0C46  900000            MOV     DPTR,#$LOCBX WaitForCall+40
   \   0C49  CD                XCH     A,R5
   \   0C4A  F0                MOVX    @DPTR,A
   \   0C4B  A3                INC     DPTR
   \   0C4C  CD                XCH     A,R5
   \   0C4D  F0                MOVX    @DPTR,A
   \   0C4E  8009              SJMP    ?0211
   \   0C50            ?0210:
    583              else i = 10;
   \   0C50  900000            MOV     DPTR,#$LOCBX WaitForCall+40
   \   0C53  E4                CLR     A
   \   0C54  F0                MOVX    @DPTR,A
   \   0C55  A3                INC     DPTR
   \   0C56  740A              MOV     A,#10
   \   0C58  F0                MOVX    @DPTR,A
   \   0C59            ?0211:
    584              c =  WaitForRingSignals(i);
   \   0C59  900000            MOV     DPTR,#$LOCBX WaitForCall+40
   \   0C5C  E0                MOVX    A,@DPTR
   \   0C5D  FD                MOV     R5,A
   \   0C5E  A3                INC     DPTR
   \   0C5F  E0                MOVX    A,@DPTR
   \   0C60  FC                MOV     R4,A
   \   0C61  120000            LCALL   $REFFN WaitForRingSignals
   \   0C64  EC                MOV     A,R4
   \   0C65  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0C68  F0                MOVX    @DPTR,A
    585          
    586              LogMessage("NWC", callerName);
   \   0C69  7F01              MOV     R7,#1
   \   0C6B  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0C6E  EF                MOV     A,R7
   \   0C6F  F0                MOVX    @DPTR,A
   \   0C70  A3                INC     DPTR
   \   0C71  7440              MOV     A,#HIGH(callerName)
   \   0C73  F0                MOVX    @DPTR,A
   \   0C74  A3                INC     DPTR
   \   0C75  74A5              MOV     A,#LOW(callerName)
   \   0C77  F0                MOVX    @DPTR,A
   \   0C78  7D2C              MOV     R5,#LOW(?0212)
   \   0C7A  7E01              MOV     R6,#HIGH(?0212)
   \   0C7C  0F                INC     R7
   \   0C7D  120000            LCALL   $REFFN LogMessage
    587              LogMessage("TIM", msg);
   \   0C80  7F01              MOV     R7,#1
   \   0C82  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0C85  EF                MOV     A,R7
   \   0C86  F0                MOVX    @DPTR,A
   \   0C87  A3                INC     DPTR
   \   0C88  7400              MOV     A,#HIGH(msg)
   \   0C8A  F0                MOVX    @DPTR,A
   \   0C8B  A3                INC     DPTR
   \   0C8C  7400              MOV     A,#LOW(msg)
   \   0C8E  F0                MOVX    @DPTR,A
   \   0C8F  7D30              MOV     R5,#LOW(?0213)
   \   0C91  7E01              MOV     R6,#HIGH(?0213)
   \   0C93  0F                INC     R7
   \   0C94  120000            LCALL   $REFFN LogMessage
    588          
    589              if (c == 1) {
   \   0C97  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0C9A  E0                MOVX    A,@DPTR
   \   0C9B  14                DEC     A
   \   0C9C  7023              JNZ     ?0215
   \   0C9E            ?0214:
    590                  LogMessage("DSC", NULL);
   \   0C9E  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0CA1  E4                CLR     A
   \   0CA2  F0                MOVX    @DPTR,A
   \   0CA3  A3                INC     DPTR
   \   0CA4  F0                MOVX    @DPTR,A
   \   0CA5  A3                INC     DPTR
   \   0CA6  F0                MOVX    @DPTR,A
   \   0CA7  7D34              MOV     R5,#LOW(?0216)
   \   0CA9  7E01              MOV     R6,#HIGH(?0216)
   \   0CAB  7F02              MOV     R7,#2
   \   0CAD  120000            LCALL   $REFFN LogMessage
    591                  if (labTimeout[0] != 0) {
   \   0CB0  900080            MOV     DPTR,#labTimeout
   \   0CB3  E0                MOVX    A,@DPTR
   \   0CB4  6009              JZ      ?0218
   \   0CB6            ?0217:
    592                      GotoLabel(labTimeout);
   \   0CB6  7D80              MOV     R5,#LOW(labTimeout)
   \   0CB8  7E00              MOV     R6,#HIGH(labTimeout)
   \   0CBA  7F01              MOV     R7,#1
   \   0CBC  120000            LCALL   $REFFN GotoLabel
   \   0CBF            ?0218:
   \   0CBF  8015              SJMP    ?0219
   \   0CC1            ?0215:
    593                  }
    594              } else if (c == 0) {
   \   0CC1  900000            MOV     DPTR,#$LOCBX WaitForCall+44
   \   0CC4  E0                MOVX    A,@DPTR
   \   0CC5  700F              JNZ     ?0221
   \   0CC7            ?0220:
    595                  if (labStar[0] != 0) {
   \   0CC7  900068            MOV     DPTR,#labStar
   \   0CCA  E0                MOVX    A,@DPTR
   \   0CCB  6009              JZ      ?0223
   \   0CCD            ?0222:
    596                      GotoLabel(labStar);
   \   0CCD  7D68              MOV     R5,#LOW(labStar)
   \   0CCF  7E00              MOV     R6,#HIGH(labStar)
   \   0CD1  7F01              MOV     R7,#1
   \   0CD3  120000            LCALL   $REFFN GotoLabel
   \   0CD6            ?0223:
   \   0CD6            ?0221:
   \   0CD6            ?0219:
    597                  }
    598              }
    599          }
   \   0CD6  900000            MOV     DPTR,#$LOCBX WaitForCall+73
   \   0CD9  E0                MOVX    A,@DPTR
   \   0CDA  F8                MOV     R0,A
   \   0CDB  A3                INC     DPTR
   \   0CDC  E0                MOVX    A,@DPTR
   \   0CDD  C0E0              PUSH    ACC
   \   0CDF  E8                MOV     A,R0
   \   0CE0  C0E0              PUSH    ACC
   \   0CE2  22                RET
    600          
    601          void    CorrectDate(char changedDate)
    602          {
   \   0CE3            CorrectDate:
    603              xdata char    topDate;
    604              
    605              if ((month == 1) || (month == 3) || (month == 5) || (month == 7) || (month == 8) || (month == 10) || (month == 12)) topDate = 31;
   \   0CE3  EC                MOV     A,R4
   \   0CE4  900000            MOV     DPTR,#$LOCBX CorrectDate+1
   \   0CE7  F0                MOVX    @DPTR,A
   \   0CE8  90009B            MOV     DPTR,#month
   \   0CEB  E0                MOVX    A,@DPTR
   \   0CEC  14                DEC     A
   \   0CED  601D              JZ      ?0224
   \   0CEF  E0                MOVX    A,@DPTR
   \   0CF0  6403              XRL     A,#3
   \   0CF2  6018              JZ      ?0224
   \   0CF4  E0                MOVX    A,@DPTR
   \   0CF5  6405              XRL     A,#5
   \   0CF7  6013              JZ      ?0224
   \   0CF9  E0                MOVX    A,@DPTR
   \   0CFA  6407              XRL     A,#7
   \   0CFC  600E              JZ      ?0224
   \   0CFE  E0                MOVX    A,@DPTR
   \   0CFF  6408              XRL     A,#8
   \   0D01  6009              JZ      ?0224
   \   0D03  E0                MOVX    A,@DPTR
   \   0D04  640A              XRL     A,#10
   \   0D06  6004              JZ      ?0224
   \   0D08  E0                MOVX    A,@DPTR
   \   0D09  B40C08            CJNE    A,#12,?0225
   \   0D0C            ?0226:
   \   0D0C            ?0227:
   \   0D0C            ?0224:
   \   0D0C  741F              MOV     A,#31
   \   0D0E  900000            MOV     DPTR,#$LOCBX CorrectDate
   \   0D11  F0                MOVX    @DPTR,A
   \   0D12  804C              SJMP    ?0228
   \   0D14            ?0225:
    606              else if ((month == 4) || (month == 6) || (month == 9) || (month == 11)) topDate = 30;
   \   0D14  6404              XRL     A,#4
   \   0D16  600E              JZ      ?0229
   \   0D18  E0                MOVX    A,@DPTR
   \   0D19  6406              XRL     A,#6
   \   0D1B  6009              JZ      ?0229
   \   0D1D  E0                MOVX    A,@DPTR
   \   0D1E  6409              XRL     A,#9
   \   0D20  6004              JZ      ?0229
   \   0D22  E0                MOVX    A,@DPTR
   \   0D23  B40B08            CJNE    A,#11,?0230
   \   0D26            ?0231:
   \   0D26            ?0232:
   \   0D26            ?0229:
   \   0D26  741E              MOV     A,#30
   \   0D28  900000            MOV     DPTR,#$LOCBX CorrectDate
   \   0D2B  F0                MOVX    @DPTR,A
    607              else {
   \   0D2C  8032              SJMP    ?0233
   \   0D2E            ?0230:
    608                  if ((year-(4*(year/4))) == 0) {
   \   0D2E  90009A            MOV     DPTR,#year
   \   0D31  E0                MOVX    A,@DPTR
   \   0D32  FF                MOV     R7,A
   \   0D33  C3                CLR     C
   \   0D34  13                RRC     A
   \   0D35  C3                CLR     C
   \   0D36  13                RRC     A
   \   0D37  75F004            MOV     B,#4
   \   0D3A  A4                MUL     AB
   \   0D3B  ADF0              MOV     R5,B
   \   0D3D  FC                MOV     R4,A
   \   0D3E  C3                CLR     C
   \   0D3F  E4                CLR     A
   \   0D40  9C                SUBB    A,R4
   \   0D41  FC                MOV     R4,A
   \   0D42  E4                CLR     A
   \   0D43  9D                SUBB    A,R5
   \   0D44  FD                MOV     R5,A
   \   0D45  EF                MOV     A,R7
   \   0D46  7B00              MOV     R3,#0
   \   0D48  FA                MOV     R2,A
   \   0D49  EC                MOV     A,R4
   \   0D4A  2A                ADD     A,R2
   \   0D4B  FC                MOV     R4,A
   \   0D4C  ED                MOV     A,R5
   \   0D4D  3B                ADDC    A,R3
   \   0D4E  4C                ORL     A,R4
   \   0D4F  FD                MOV     R5,A
   \   0D50  7008              JNZ     ?0235
   \   0D52            ?0234:
    609                      topDate = 29;
   \   0D52  741D              MOV     A,#29
   \   0D54  900000            MOV     DPTR,#$LOCBX CorrectDate
   \   0D57  F0                MOVX    @DPTR,A
    610                  } else {
   \   0D58  8006              SJMP    ?0236
   \   0D5A            ?0235:
    611                      topDate = 28;
   \   0D5A  741C              MOV     A,#28
   \   0D5C  900000            MOV     DPTR,#$LOCBX CorrectDate
   \   0D5F  F0                MOVX    @DPTR,A
   \   0D60            ?0236:
   \   0D60            ?0233:
   \   0D60            ?0228:
    612                  }
    613              }
    614              if (date < 1) date = topDate;
   \   0D60  90009C            MOV     DPTR,#date
   \   0D63  E0                MOVX    A,@DPTR
   \   0D64  700A              JNZ     ?0238
   \   0D66            ?0237:
   \   0D66  900000            MOV     DPTR,#$LOCBX CorrectDate
   \   0D69  E0                MOVX    A,@DPTR
   \   0D6A  90009C            MOV     DPTR,#date
   \   0D6D  F0                MOVX    @DPTR,A
   \   0D6E  801F              SJMP    ?0239
   \   0D70            ?0238:
    615              else if (date > topDate) {
   \   0D70  FC                MOV     R4,A
   \   0D71  900000            MOV     DPTR,#$LOCBX CorrectDate
   \   0D74  E0                MOVX    A,@DPTR
   \   0D75  C3                CLR     C
   \   0D76  9C                SUBB    A,R4
   \   0D77  5016              JNC     ?0241
   \   0D79            ?0240:
    616                  if (changedDate) date = 1;
   \   0D79  A3                INC     DPTR
   \   0D7A  E0                MOVX    A,@DPTR
   \   0D7B  6009              JZ      ?0243
   \   0D7D            ?0242:
   \   0D7D  7C01              MOV     R4,#1
   \   0D7F  EC                MOV     A,R4
   \   0D80  90009C            MOV     DPTR,#date
   \   0D83  F0                MOVX    @DPTR,A
   \   0D84  8009              SJMP    ?0244
   \   0D86            ?0243:
    617                  else date = topDate;
   \   0D86  900000            MOV     DPTR,#$LOCBX CorrectDate
   \   0D89  E0                MOVX    A,@DPTR
   \   0D8A  FC                MOV     R4,A
   \   0D8B  90009C            MOV     DPTR,#date
   \   0D8E  F0                MOVX    @DPTR,A
   \   0D8F            ?0244:
   \   0D8F            ?0241:
   \   0D8F            ?0239:
    618              }
    619          }
   \   0D8F  22                RET
    620          
    621          
    622          
    623          
    624          void    RecordCallerMessage( void )
    625          /*
    626          Kommandorad:
    627          
    628          RECMSG LD=DTMF_ABORT_LABEL LH=HUNGUP_LABEL
    629          
    630          */
    631          {
   \   0D90            RecordCallerMessage:
   \   0D90  900000            MOV     DPTR,#$LOCBX RecordCallerMessage+15
   \   0D93  D0E0              POP     ACC
   \   0D95  F0                MOVX    @DPTR,A
   \   0D96  A3                INC     DPTR
   \   0D97  D0E0              POP     ACC
   \   0D99  F0                MOVX    @DPTR,A
    632              xdata char    fileName[15];
    633          
    634              WDT = 1;
   \   0D9A  D2AE              SETB    IE.6
    635              SWDT = 1;
   \   0D9C  D2BE              SETB    IP.6
    636          
    637              SetupUpQLabels();
   \   0D9E  120000            LCALL   $REFFN SetupUpQLabels
    638              CreateUniqueFilename(fileName);
   \   0DA1  7D00              MOV     R5,#LOW $LOCBX RecordCallerMessage
   \   0DA3  7E00              MOV     R6,#HIGH $LOCBX RecordCallerMessage
   \   0DA5  7F01              MOV     R7,#1
   \   0DA7  120000            LCALL   $REFFN CreateUniqueFilename
    639          
    640              WDT = 1;
   \   0DAA  D2AE              SETB    IE.6
    641              SWDT = 1;
   \   0DAC  D2BE              SETB    IP.6
    642          
    643              RecPhoneFile(fileName);
   \   0DAE  7D00              MOV     R5,#LOW $LOCBX RecordCallerMessage
   \   0DB0  7E00              MOV     R6,#HIGH $LOCBX RecordCallerMessage
   \   0DB2  7F01              MOV     R7,#1
   \   0DB4  120000            LCALL   $REFFN RecPhoneFile
    644           
    645              LogMessage("RCM", fileName);
   \   0DB7  7F01              MOV     R7,#1
   \   0DB9  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0DBC  EF                MOV     A,R7
   \   0DBD  F0                MOVX    @DPTR,A
   \   0DBE  A3                INC     DPTR
   \   0DBF  7400              MOV     A,#HIGH $LOCBX RecordCallerMessage
   \   0DC1  F0                MOVX    @DPTR,A
   \   0DC2  A3                INC     DPTR
   \   0DC3  7400              MOV     A,#LOW $LOCBX RecordCallerMessage
   \   0DC5  F0                MOVX    @DPTR,A
   \   0DC6  7D38              MOV     R5,#LOW(?0245)
   \   0DC8  7E01              MOV     R6,#HIGH(?0245)
   \   0DCA  0F                INC     R7
   \   0DCB  120000            LCALL   $REFFN LogMessage
    646              WriteCalenderByte(0x07, 0x10);  //Blinka diod
   \   0DCE  7D10              MOV     R5,#16
   \   0DD0  7C07              MOV     R4,#7
   \   0DD2  120000            LCALL   $REFFN WriteCalenderByte
    647          
    648              WDT = 1;
   \   0DD5  D2AE              SETB    IE.6
    649              SWDT = 1;
   \   0DD7  D2BE              SETB    IP.6
    650          
    651              if (receivedDTMF) {
   \   0DD9  900000            MOV     DPTR,#receivedDTMF
   \   0DDC  E0                MOVX    A,@DPTR
   \   0DDD  6028              JZ      ?0247
   \   0DDF            ?0246:
    652                  LogMessage("DTM", NULL);
   \   0DDF  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0DE2  E4                CLR     A
   \   0DE3  F0                MOVX    @DPTR,A
   \   0DE4  A3                INC     DPTR
   \   0DE5  F0                MOVX    @DPTR,A
   \   0DE6  A3                INC     DPTR
   \   0DE7  F0                MOVX    @DPTR,A
   \   0DE8  7D3C              MOV     R5,#LOW(?0248)
   \   0DEA  7E01              MOV     R6,#HIGH(?0248)
   \   0DEC  7F02              MOV     R7,#2
   \   0DEE  120000            LCALL   $REFFN LogMessage
    653                  receivedDTMF = 0;
   \   0DF1  E4                CLR     A
   \   0DF2  900000            MOV     DPTR,#receivedDTMF
   \   0DF5  F0                MOVX    @DPTR,A
    654          //        SendStringEOLRS232("Received DTMF");
    655                  if (labDTMF[0] != 0x00) {
   \   0DF6  900008            MOV     DPTR,#labDTMF
   \   0DF9  E0                MOVX    A,@DPTR
   \   0DFA  6009              JZ      ?0250
   \   0DFC            ?0249:
    656                      GotoLabel(labDTMF);
   \   0DFC  7D08              MOV     R5,#LOW(labDTMF)
   \   0DFE  7E00              MOV     R6,#HIGH(labDTMF)
   \   0E00  7F01              MOV     R7,#1
   \   0E02  120000            LCALL   $REFFN GotoLabel
   \   0E05            ?0250:
   \   0E05  8015              SJMP    ?0251
   \   0E07            ?0247:
    657                  }
    658              } else if (terminateAnswer) {
   \   0E07  900000            MOV     DPTR,#terminateAnswer
   \   0E0A  E0                MOVX    A,@DPTR
   \   0E0B  600F              JZ      ?0253
   \   0E0D            ?0252:
    659                  if (labHungUp[0] != 0x00) {
   \   0E0D  900088            MOV     DPTR,#labHungUp
   \   0E10  E0                MOVX    A,@DPTR
   \   0E11  6009              JZ      ?0255
   \   0E13            ?0254:
    660                      GotoLabel(labHungUp);
   \   0E13  7D88              MOV     R5,#LOW(labHungUp)
   \   0E15  7E00              MOV     R6,#HIGH(labHungUp)
   \   0E17  7F01              MOV     R7,#1
   \   0E19  120000            LCALL   $REFFN GotoLabel
   \   0E1C            ?0255:
   \   0E1C            ?0253:
   \   0E1C            ?0251:
    661                  }
    662          //        LogMessage("End call");                //Skall denna ligga här eller vid någon "hangup" rutin???????
    663              }
    664              WDT = 1;
   \   0E1C  D2AE              SETB    IE.6
    665              SWDT = 1;
   \   0E1E  D2BE              SETB    IP.6
    666          }
   \   0E20  900000            MOV     DPTR,#$LOCBX RecordCallerMessage+15
   \   0E23  E0                MOVX    A,@DPTR
   \   0E24  F8                MOV     R0,A
   \   0E25  A3                INC     DPTR
   \   0E26  E0                MOVX    A,@DPTR
   \   0E27  C0E0              PUSH    ACC
   \   0E29  E8                MOV     A,R0
   \   0E2A  C0E0              PUSH    ACC
   \   0E2C  22                RET
    667          
    668          
    669          
    670          
    671          
    672          
    673          void    AskQuestionMsg( void )
    674          /*
    675          Kommandorad:
    676          
    677          QUESTION QUEST1.WAW L1=LABEL1 L0=LABEL0 ... LS=LABELSTAR LP=LABELPOUND TV=10 LT=LABELTIMEOUT LH=LABELHUNGUP
    678          
    679          */
    680          {
   \   0E2D            AskQuestionMsg:
   \   0E2D  900000            MOV     DPTR,#$LOCBX AskQuestionMsg+5
   \   0E30  D0E0              POP     ACC
   \   0E32  F0                MOVX    @DPTR,A
   \   0E33  A3                INC     DPTR
   \   0E34  D0E0              POP     ACC
   \   0E36  F0                MOVX    @DPTR,A
    681              xdata char    timer;
    682              xdata char    abort;
    683              xdata char    c;
    684              xdata unsigned int     rt;
    685           
    686          
    687              SetupUpQLabels();
   \   0E37  120000            LCALL   $REFFN SetupUpQLabels
    688              
    689              PlayFile(commandLine[1]);
    690           
   \   0E3A  7D10              MOV     R5,#LOW(commandLine+16)
   \   0E3C  7E00              MOV     R6,#HIGH(commandLine+16)
   \   0E3E  7F01              MOV     R7,#1
   \   0E40  120000            LCALL   $REFFN PlayFile
    691              abort = 0;
    692              
    693              rt = timeoutValue * (unsigned int) 100;         //Blir fel
   \   0E43  900090            MOV     DPTR,#timeoutValue
   \   0E46  E0                MOVX    A,@DPTR
   \   0E47  FD                MOV     R5,A
   \   0E48  A3                INC     DPTR
   \   0E49  E0                MOVX    A,@DPTR
   \   0E4A  75F064            MOV     B,#100
   \   0E4D  A4                MUL     AB
   \   0E4E  FC                MOV     R4,A
   \   0E4F  E5F0              MOV     A,B
   \   0E51  CD                XCH     A,R5
   \   0E52  75F064            MOV     B,#100
   \   0E55  A4                MUL     AB
   \   0E56  2D                ADD     A,R5
   \   0E57  900000            MOV     DPTR,#$LOCBX AskQuestionMsg+3
   \   0E5A  F0                MOVX    @DPTR,A
   \   0E5B  A3                INC     DPTR
   \   0E5C  EC                MOV     A,R4
   \   0E5D  F0                MOVX    @DPTR,A
    694          
    695          //    myLong2HexStr(timeoutValue, msg);
    696          //    SendStringEOLRS232(msg);
    697                          
    698              timer = StartTimer(2000);
   \   0E5E  7D07              MOV     R5,#7
   \   0E60  7CD0              MOV     R4,#208
   \   0E62  120000            LCALL   $REFFN StartTimer
   \   0E65  EC                MOV     A,R4
   \   0E66  900000            MOV     DPTR,#$LOCBX AskQuestionMsg
   \   0E69  F0                MOVX    @DPTR,A
   \   0E6A  E4                CLR     A
   \   0E6B  A3                INC     DPTR
   \   0E6C  F0                MOVX    @DPTR,A
   \   0E6D            ?0257:
    699              
    700              while (!abort) {
   \   0E6D  900000            MOV     DPTR,#$LOCBX AskQuestionMsg+1
   \   0E70  E0                MOVX    A,@DPTR
   \   0E71  6003              JZ      $+5
   \   0E73  0210DD            LJMP    ?0256
   \   0E76            ?0258:
    701                  WDT = 1;
   \   0E76  D2AE              SETB    IE.6
    702                  SWDT = 1;
   \   0E78  D2BE              SETB    IP.6
    703                  if (receivedDTMF) {
   \   0E7A  900000            MOV     DPTR,#receivedDTMF
   \   0E7D  E0                MOVX    A,@DPTR
   \   0E7E  7003              JNZ     $+5
   \   0E80  021094            LJMP    ?0260
   \   0E83            ?0259:
    704                      c = DecodeReceivedDTMF();
   \   0E83  120000            LCALL   $REFFN DecodeReceivedDTMF
    705                      if ((c == '0') && (lab0[0] != 0x00)) {
   \   0E86  EC                MOV     A,R4
   \   0E87  900000            MOV     DPTR,#$LOCBX AskQuestionMsg+2
   \   0E8A  F0                MOVX    @DPTR,A
   \   0E8B  B43024            CJNE    A,#48,?0262
   \   0E8E  900010            MOV     DPTR,#lab0
   \   0E91  E0                MOVX    A,@DPTR
   \   0E92  601E              JZ      ?0262
   \   0E94            ?0264:
   \   0E94            ?0263:
   \   0E94            ?0261:
    706                          GotoLabel(lab0);
   \   0E94  7D10              MOV     R5,#LOW(lab0)
   \   0E96  7E00              MOV     R6,#HIGH(lab0)
   \   0E98  7F01              MOV     R7,#1
   \   0E9A  120000            LCALL   $REFFN GotoLabel
    707                          LogMessage("DTM 0", NULL);
   \   0E9D  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0EA0  E4                CLR     A
   \   0EA1  F0                MOVX    @DPTR,A
   \   0EA2  A3                INC     DPTR
   \   0EA3  F0                MOVX    @DPTR,A
   \   0EA4  A3                INC     DPTR
   \   0EA5  F0                MOVX    @DPTR,A
   \   0EA6  7D40              MOV     R5,#LOW(?0265)
   \   0EA8  7E01              MOV     R6,#HIGH(?0265)
   \   0EAA  7F02              MOV     R7,#2
   \   0EAC  120000            LCALL   $REFFN LogMessage
   \   0EAF  021088            LJMP    ?0266
   \   0EB2            ?0262:
    708                      } else if ((c == '1') && (lab1[0] != 0x00)) {
   \   0EB2  EC                MOV     A,R4
   \   0EB3  B43124            CJNE    A,#49,?0268
   \   0EB6  900018            MOV     DPTR,#lab1
   \   0EB9  E0                MOVX    A,@DPTR
   \   0EBA  601E              JZ      ?0268
   \   0EBC            ?0270:
   \   0EBC            ?0269:
   \   0EBC            ?0267:
    709                          GotoLabel(lab1);
   \   0EBC  7D18              MOV     R5,#LOW(lab1)
   \   0EBE  7E00              MOV     R6,#HIGH(lab1)
   \   0EC0  7F01              MOV     R7,#1
   \   0EC2  120000            LCALL   $REFFN GotoLabel
    710                          LogMessage("DTM 1", NULL);
   \   0EC5  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0EC8  E4                CLR     A
   \   0EC9  F0                MOVX    @DPTR,A
   \   0ECA  A3                INC     DPTR
   \   0ECB  F0                MOVX    @DPTR,A
   \   0ECC  A3                INC     DPTR
   \   0ECD  F0                MOVX    @DPTR,A
   \   0ECE  7D46              MOV     R5,#LOW(?0271)
   \   0ED0  7E01              MOV     R6,#HIGH(?0271)
   \   0ED2  7F02              MOV     R7,#2
   \   0ED4  120000            LCALL   $REFFN LogMessage
   \   0ED7  021088            LJMP    ?0272
   \   0EDA            ?0268:
    711                      } else if ((c == '2') && (lab2[0] != 0x00)) {
   \   0EDA  EC                MOV     A,R4
   \   0EDB  B43224            CJNE    A,#50,?0274
   \   0EDE  900020            MOV     DPTR,#lab2
   \   0EE1  E0                MOVX    A,@DPTR
   \   0EE2  601E              JZ      ?0274
   \   0EE4            ?0276:
   \   0EE4            ?0275:
   \   0EE4            ?0273:
    712                          GotoLabel(lab2);
   \   0EE4  7D20              MOV     R5,#LOW(lab2)
   \   0EE6  7E00              MOV     R6,#HIGH(lab2)
   \   0EE8  7F01              MOV     R7,#1
   \   0EEA  120000            LCALL   $REFFN GotoLabel
    713                          LogMessage("DTM 2", NULL);
   \   0EED  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0EF0  E4                CLR     A
   \   0EF1  F0                MOVX    @DPTR,A
   \   0EF2  A3                INC     DPTR
   \   0EF3  F0                MOVX    @DPTR,A
   \   0EF4  A3                INC     DPTR
   \   0EF5  F0                MOVX    @DPTR,A
   \   0EF6  7D4C              MOV     R5,#LOW(?0277)
   \   0EF8  7E01              MOV     R6,#HIGH(?0277)
   \   0EFA  7F02              MOV     R7,#2
   \   0EFC  120000            LCALL   $REFFN LogMessage
   \   0EFF  021088            LJMP    ?0278
   \   0F02            ?0274:
    714                      } else if ((c == '3') && (lab3[0] != 0x00)) {
   \   0F02  EC                MOV     A,R4
   \   0F03  B43324            CJNE    A,#51,?0280
   \   0F06  900028            MOV     DPTR,#lab3
   \   0F09  E0                MOVX    A,@DPTR
   \   0F0A  601E              JZ      ?0280
   \   0F0C            ?0282:
   \   0F0C            ?0281:
   \   0F0C            ?0279:
    715                          GotoLabel(lab3);
   \   0F0C  7D28              MOV     R5,#LOW(lab3)
   \   0F0E  7E00              MOV     R6,#HIGH(lab3)
   \   0F10  7F01              MOV     R7,#1
   \   0F12  120000            LCALL   $REFFN GotoLabel
    716                          LogMessage("DTM 3", NULL);
   \   0F15  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0F18  E4                CLR     A
   \   0F19  F0                MOVX    @DPTR,A
   \   0F1A  A3                INC     DPTR
   \   0F1B  F0                MOVX    @DPTR,A
   \   0F1C  A3                INC     DPTR
   \   0F1D  F0                MOVX    @DPTR,A
   \   0F1E  7D52              MOV     R5,#LOW(?0283)
   \   0F20  7E01              MOV     R6,#HIGH(?0283)
   \   0F22  7F02              MOV     R7,#2
   \   0F24  120000            LCALL   $REFFN LogMessage
   \   0F27  021088            LJMP    ?0284
   \   0F2A            ?0280:
    717                      } else if ((c == '4') && (lab4[0] != 0x00)) {
   \   0F2A  EC                MOV     A,R4
   \   0F2B  B43424            CJNE    A,#52,?0286
   \   0F2E  900030            MOV     DPTR,#lab4
   \   0F31  E0                MOVX    A,@DPTR
   \   0F32  601E              JZ      ?0286
   \   0F34            ?0288:
   \   0F34            ?0287:
   \   0F34            ?0285:
    718                          GotoLabel(lab4);
   \   0F34  7D30              MOV     R5,#LOW(lab4)
   \   0F36  7E00              MOV     R6,#HIGH(lab4)
   \   0F38  7F01              MOV     R7,#1
   \   0F3A  120000            LCALL   $REFFN GotoLabel
    719                          LogMessage("DTM 4", NULL);
   \   0F3D  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0F40  E4                CLR     A
   \   0F41  F0                MOVX    @DPTR,A
   \   0F42  A3                INC     DPTR
   \   0F43  F0                MOVX    @DPTR,A
   \   0F44  A3                INC     DPTR
   \   0F45  F0                MOVX    @DPTR,A
   \   0F46  7D58              MOV     R5,#LOW(?0289)
   \   0F48  7E01              MOV     R6,#HIGH(?0289)
   \   0F4A  7F02              MOV     R7,#2
   \   0F4C  120000            LCALL   $REFFN LogMessage
   \   0F4F  021088            LJMP    ?0290
   \   0F52            ?0286:
    720                      } else if ((c == '5') && (lab5[0] != 0x00)) {
   \   0F52  EC                MOV     A,R4
   \   0F53  B43524            CJNE    A,#53,?0292
   \   0F56  900038            MOV     DPTR,#lab5
   \   0F59  E0                MOVX    A,@DPTR
   \   0F5A  601E              JZ      ?0292
   \   0F5C            ?0294:
   \   0F5C            ?0293:
   \   0F5C            ?0291:
    721                          GotoLabel(lab5);
   \   0F5C  7D38              MOV     R5,#LOW(lab5)
   \   0F5E  7E00              MOV     R6,#HIGH(lab5)
   \   0F60  7F01              MOV     R7,#1
   \   0F62  120000            LCALL   $REFFN GotoLabel
    722                          LogMessage("DTM 5", NULL);
   \   0F65  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0F68  E4                CLR     A
   \   0F69  F0                MOVX    @DPTR,A
   \   0F6A  A3                INC     DPTR
   \   0F6B  F0                MOVX    @DPTR,A
   \   0F6C  A3                INC     DPTR
   \   0F6D  F0                MOVX    @DPTR,A
   \   0F6E  7D5E              MOV     R5,#LOW(?0295)
   \   0F70  7E01              MOV     R6,#HIGH(?0295)
   \   0F72  7F02              MOV     R7,#2
   \   0F74  120000            LCALL   $REFFN LogMessage
   \   0F77  021088            LJMP    ?0296
   \   0F7A            ?0292:
    723                      } else if ((c == '6') && (lab6[0] != 0x00)) {
   \   0F7A  EC                MOV     A,R4
   \   0F7B  B43624            CJNE    A,#54,?0298
   \   0F7E  900040            MOV     DPTR,#lab6
   \   0F81  E0                MOVX    A,@DPTR
   \   0F82  601E              JZ      ?0298
   \   0F84            ?0300:
   \   0F84            ?0299:
   \   0F84            ?0297:
    724                          GotoLabel(lab6);
   \   0F84  7D40              MOV     R5,#LOW(lab6)
   \   0F86  7E00              MOV     R6,#HIGH(lab6)
   \   0F88  7F01              MOV     R7,#1
   \   0F8A  120000            LCALL   $REFFN GotoLabel
    725                          LogMessage("DTM 6", NULL);
   \   0F8D  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0F90  E4                CLR     A
   \   0F91  F0                MOVX    @DPTR,A
   \   0F92  A3                INC     DPTR
   \   0F93  F0                MOVX    @DPTR,A
   \   0F94  A3                INC     DPTR
   \   0F95  F0                MOVX    @DPTR,A
   \   0F96  7D64              MOV     R5,#LOW(?0301)
   \   0F98  7E01              MOV     R6,#HIGH(?0301)
   \   0F9A  7F02              MOV     R7,#2
   \   0F9C  120000            LCALL   $REFFN LogMessage
   \   0F9F  021088            LJMP    ?0302
   \   0FA2            ?0298:
    726                      } else if ((c == '7') && (lab7[0] != 0x00)) {
   \   0FA2  EC                MOV     A,R4
   \   0FA3  B43724            CJNE    A,#55,?0304
   \   0FA6  900048            MOV     DPTR,#lab7
   \   0FA9  E0                MOVX    A,@DPTR
   \   0FAA  601E              JZ      ?0304
   \   0FAC            ?0306:
   \   0FAC            ?0305:
   \   0FAC            ?0303:
    727                          GotoLabel(lab7);
   \   0FAC  7D48              MOV     R5,#LOW(lab7)
   \   0FAE  7E00              MOV     R6,#HIGH(lab7)
   \   0FB0  7F01              MOV     R7,#1
   \   0FB2  120000            LCALL   $REFFN GotoLabel
    728                          LogMessage("DTM 7", NULL);
   \   0FB5  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0FB8  E4                CLR     A
   \   0FB9  F0                MOVX    @DPTR,A
   \   0FBA  A3                INC     DPTR
   \   0FBB  F0                MOVX    @DPTR,A
   \   0FBC  A3                INC     DPTR
   \   0FBD  F0                MOVX    @DPTR,A
   \   0FBE  7D6A              MOV     R5,#LOW(?0307)
   \   0FC0  7E01              MOV     R6,#HIGH(?0307)
   \   0FC2  7F02              MOV     R7,#2
   \   0FC4  120000            LCALL   $REFFN LogMessage
   \   0FC7  021088            LJMP    ?0308
   \   0FCA            ?0304:
    729                      } else if ((c == '8') && (lab8[0] != 0x00)) {
   \   0FCA  EC                MOV     A,R4
   \   0FCB  B43824            CJNE    A,#56,?0310
   \   0FCE  900050            MOV     DPTR,#lab8
   \   0FD1  E0                MOVX    A,@DPTR
   \   0FD2  601E              JZ      ?0310
   \   0FD4            ?0312:
   \   0FD4            ?0311:
   \   0FD4            ?0309:
    730                          GotoLabel(lab8);
   \   0FD4  7D50              MOV     R5,#LOW(lab8)
   \   0FD6  7E00              MOV     R6,#HIGH(lab8)
   \   0FD8  7F01              MOV     R7,#1
   \   0FDA  120000            LCALL   $REFFN GotoLabel
    731                          LogMessage("DTM 8", NULL);
   \   0FDD  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   0FE0  E4                CLR     A
   \   0FE1  F0                MOVX    @DPTR,A
   \   0FE2  A3                INC     DPTR
   \   0FE3  F0                MOVX    @DPTR,A
   \   0FE4  A3                INC     DPTR
   \   0FE5  F0                MOVX    @DPTR,A
   \   0FE6  7D70              MOV     R5,#LOW(?0313)
   \   0FE8  7E01              MOV     R6,#HIGH(?0313)
   \   0FEA  7F02              MOV     R7,#2
   \   0FEC  120000            LCALL   $REFFN LogMessage
   \   0FEF  021088            LJMP    ?0314
   \   0FF2            ?0310:
    732                      } else if ((c == '9') && (lab9[0] != 0x00)) {
   \   0FF2  EC                MOV     A,R4
   \   0FF3  B43923            CJNE    A,#57,?0316
   \   0FF6  900058            MOV     DPTR,#lab9
   \   0FF9  E0                MOVX    A,@DPTR
   \   0FFA  601D              JZ      ?0316
   \   0FFC            ?0318:
   \   0FFC            ?0317:
   \   0FFC            ?0315:
    733                          GotoLabel(lab9);
   \   0FFC  7D58              MOV     R5,#LOW(lab9)
   \   0FFE  7E00              MOV     R6,#HIGH(lab9)
   \   1000  7F01              MOV     R7,#1
   \   1002  120000            LCALL   $REFFN GotoLabel
    734                          LogMessage("DTM 9", NULL);
   \   1005  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   1008  E4                CLR     A
   \   1009  F0                MOVX    @DPTR,A
   \   100A  A3                INC     DPTR
   \   100B  F0                MOVX    @DPTR,A
   \   100C  A3                INC     DPTR
   \   100D  F0                MOVX    @DPTR,A
   \   100E  7D76              MOV     R5,#LOW(?0319)
   \   1010  7E01              MOV     R6,#HIGH(?0319)
   \   1012  7F02              MOV     R7,#2
   \   1014  120000            LCALL   $REFFN LogMessage
   \   1017  806F              SJMP    ?0320
   \   1019            ?0316:
    735                      } else if ((c == '*') && (labStar[0] != 0x00)) {
   \   1019  EC                MOV     A,R4
   \   101A  B42A23            CJNE    A,#42,?0322
   \   101D  900068            MOV     DPTR,#labStar
   \   1020  E0                MOVX    A,@DPTR
   \   1021  601D              JZ      ?0322
   \   1023            ?0324:
   \   1023            ?0323:
   \   1023            ?0321:
    736                          GotoLabel(labStar);
   \   1023  7D68              MOV     R5,#LOW(labStar)
   \   1025  7E00              MOV     R6,#HIGH(labStar)
   \   1027  7F01              MOV     R7,#1
   \   1029  120000            LCALL   $REFFN GotoLabel
    737                          LogMessage("DTM *", NULL);
   \   102C  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   102F  E4                CLR     A
   \   1030  F0                MOVX    @DPTR,A
   \   1031  A3                INC     DPTR
   \   1032  F0                MOVX    @DPTR,A
   \   1033  A3                INC     DPTR
   \   1034  F0                MOVX    @DPTR,A
   \   1035  7D7C              MOV     R5,#LOW(?0325)
   \   1037  7E01              MOV     R6,#HIGH(?0325)
   \   1039  7F02              MOV     R7,#2
   \   103B  120000            LCALL   $REFFN LogMessage
   \   103E  8048              SJMP    ?0326
   \   1040            ?0322:
    738                      } else if ((c == '#') && (labPound[0] != 0x00)) {
   \   1040  EC                MOV     A,R4
   \   1041  B42323            CJNE    A,#35,?0328
   \   1044  900060            MOV     DPTR,#labPound
   \   1047  E0                MOVX    A,@DPTR
   \   1048  601D              JZ      ?0328
   \   104A            ?0330:
   \   104A            ?0329:
   \   104A            ?0327:
    739                          GotoLabel(labPound);
   \   104A  7D60              MOV     R5,#LOW(labPound)
   \   104C  7E00              MOV     R6,#HIGH(labPound)
   \   104E  7F01              MOV     R7,#1
   \   1050  120000            LCALL   $REFFN GotoLabel
    740                          LogMessage("DTM #", NULL);
   \   1053  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   1056  E4                CLR     A
   \   1057  F0                MOVX    @DPTR,A
   \   1058  A3                INC     DPTR
   \   1059  F0                MOVX    @DPTR,A
   \   105A  A3                INC     DPTR
   \   105B  F0                MOVX    @DPTR,A
   \   105C  7D82              MOV     R5,#LOW(?0331)
   \   105E  7E01              MOV     R6,#HIGH(?0331)
   \   1060  7F02              MOV     R7,#2
   \   1062  120000            LCALL   $REFFN LogMessage
   \   1065  8021              SJMP    ?0332
   \   1067            ?0328:
    741                      } else if (labDTMF[0] != 0x00) {
   \   1067  900008            MOV     DPTR,#labDTMF
   \   106A  E0                MOVX    A,@DPTR
   \   106B  601B              JZ      ?0334
   \   106D            ?0333:
    742                          GotoLabel(labDTMF);
   \   106D  7D08              MOV     R5,#LOW(labDTMF)
   \   106F  7E00              MOV     R6,#HIGH(labDTMF)
   \   1071  7F01              MOV     R7,#1
   \   1073  120000            LCALL   $REFFN GotoLabel
    743                          LogMessage("DTM", NULL);
   \   1076  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   1079  E4                CLR     A
   \   107A  F0                MOVX    @DPTR,A
   \   107B  A3                INC     DPTR
   \   107C  F0                MOVX    @DPTR,A
   \   107D  A3                INC     DPTR
   \   107E  F0                MOVX    @DPTR,A
   \   107F  7D3C              MOV     R5,#LOW(?0248)
   \   1081  7E01              MOV     R6,#HIGH(?0248)
   \   1083  7F02              MOV     R7,#2
   \   1085  120000            LCALL   $REFFN LogMessage
   \   1088            ?0334:
   \   1088            ?0332:
   \   1088            ?0326:
   \   1088            ?0320:
   \   1088            ?0314:
   \   1088            ?0308:
   \   1088            ?0302:
   \   1088            ?0296:
   \   1088            ?0290:
   \   1088            ?0284:
   \   1088            ?0278:
   \   1088            ?0272:
   \   1088            ?0266:
    744                      }
    745                      abort = 1;
    746                      receivedDTMF = 0x00;
   \   1088  E4                CLR     A
   \   1089  900000            MOV     DPTR,#receivedDTMF
   \   108C  F0                MOVX    @DPTR,A
   \   108D  04                INC     A
   \   108E  900000            MOV     DPTR,#$LOCBX AskQuestionMsg+1
   \   1091  F0                MOVX    @DPTR,A
   \   1092  8046              SJMP    ?0335
   \   1094            ?0260:
    747                  } else if (terminateAnswer){
   \   1094  900000            MOV     DPTR,#terminateAnswer
   \   1097  E0                MOVX    A,@DPTR
   \   1098  6017              JZ      ?0337
   \   109A            ?0336:
    748          
    749                      if (labHungUp[0] != 0x00) {
   \   109A  900088            MOV     DPTR,#labHungUp
   \   109D  E0                MOVX    A,@DPTR
   \   109E  6009              JZ      ?0339
   \   10A0            ?0338:
    750                          GotoLabel(labHungUp);
   \   10A0  7D88              MOV     R5,#LOW(labHungUp)
   \   10A2  7E00              MOV     R6,#HIGH(labHungUp)
   \   10A4  7F01              MOV     R7,#1
   \   10A6  120000            LCALL   $REFFN GotoLabel
   \   10A9            ?0339:
    751                      }
    752          
    753                      abort = 1;
   \   10A9  7401              MOV     A,#1
   \   10AB  900000            MOV     DPTR,#$LOCBX AskQuestionMsg+1
   \   10AE  F0                MOVX    @DPTR,A
   \   10AF  8029              SJMP    ?0340
   \   10B1            ?0337:
    754                  } else if (TimedOut(timer)) {
   \   10B1  900000            MOV     DPTR,#$LOCBX AskQuestionMsg
   \   10B4  E0                MOVX    A,@DPTR
   \   10B5  FC                MOV     R4,A
   \   10B6  120000            LCALL   $REFFN TimedOut
   \   10B9  EC                MOV     A,R4
   \   10BA  601E              JZ      ?0342
   \   10BC            ?0341:
    755                      if (labTimeout[0] != 0x00) {
   \   10BC  900080            MOV     DPTR,#labTimeout
   \   10BF  E0                MOVX    A,@DPTR
   \   10C0  6012              JZ      ?0344
   \   10C2            ?0343:
    756                          SendStringEOLRS232("Quest timed out");
   \   10C2  7D88              MOV     R5,#LOW(?0345)
   \   10C4  7E01              MOV     R6,#HIGH(?0345)
   \   10C6  7F02              MOV     R7,#2
   \   10C8  120000            LCALL   $REFFN SendStringEOLRS232
    757                          GotoLabel(labTimeout);
   \   10CB  7D80              MOV     R5,#LOW(labTimeout)
   \   10CD  7E00              MOV     R6,#HIGH(labTimeout)
   \   10CF  7F01              MOV     R7,#1
   \   10D1  120000            LCALL   $REFFN GotoLabel
   \   10D4            ?0344:
    758                      }
    759                      abort = 1;
   \   10D4  7401              MOV     A,#1
   \   10D6  900000            MOV     DPTR,#$LOCBX AskQuestionMsg+1
   \   10D9  F0                MOVX    @DPTR,A
   \   10DA            ?0342:
   \   10DA            ?0340:
   \   10DA            ?0335:
   \   10DA  020E6D            LJMP    ?0257
   \   10DD            ?0256:
    760                  }
    761              }
    762              KillTimer(timer);
   \   10DD  900000            MOV     DPTR,#$LOCBX AskQuestionMsg
   \   10E0  E0                MOVX    A,@DPTR
   \   10E1  FC                MOV     R4,A
   \   10E2  120000            LCALL   $REFFN KillTimer
    763          }
   \   10E5  900000            MOV     DPTR,#$LOCBX AskQuestionMsg+5
   \   10E8  E0                MOVX    A,@DPTR
   \   10E9  F8                MOV     R0,A
   \   10EA  A3                INC     DPTR
   \   10EB  E0                MOVX    A,@DPTR
   \   10EC  C0E0              PUSH    ACC
   \   10EE  E8                MOV     A,R0
   \   10EF  C0E0              PUSH    ACC
   \   10F1  22                RET
    764          
    765          
    766          
    767          
    768          void    EnterCode( void )
    769          /*
    770          Kommandorad:
    771          
    772          ENTERCODE CODE.WAW 243875 LC=CORRECT_C_LABEL LI=INCORRECT_C_LABEL LH=LABELHUNGUP LT=LABELTIMEOUT
    773          
    774          OBS: Alla kodinmatningar skall avslutas med fyrkant '#'
    775          
    776          */
    777          {
   \   10F2            EnterCode:
   \   10F2  900000            MOV     DPTR,#$LOCBX EnterCode+27
   \   10F5  D0E0              POP     ACC
   \   10F7  F0                MOVX    @DPTR,A
   \   10F8  A3                INC     DPTR
   \   10F9  D0E0              POP     ACC
   \   10FB  F0                MOVX    @DPTR,A
    778              xdata char    abort = 0;
    779              xdata char    enteredCode[20];
    780              xdata char    timer;
    781              xdata char    c;
    782              xdata char    i = 0;
    783              xdata char*   cmp;
    784          
    785              SetupUpQLabels();
   \   10FC  120000            LCALL   $REFFN SetupUpQLabels
    786          
    787              PlayFile(commandLine[1]);
   \   10FF  7D10              MOV     R5,#LOW(commandLine+16)
   \   1101  7E00              MOV     R6,#HIGH(commandLine+16)
   \   1103  7F01              MOV     R7,#1
   \   1105  120000            LCALL   $REFFN PlayFile
    788           
    789              receivedDTMF = 0;
   \   1108  E4                CLR     A
   \   1109  900000            MOV     DPTR,#receivedDTMF
   \   110C  F0                MOVX    @DPTR,A
    790              ResetDTMFIndex();
   \   110D  120000            LCALL   $REFFN ResetDTMFIndex
    791              cmp = commandLine[2];
   \   1110  7401              MOV     A,#1
   \   1112  900000            MOV     DPTR,#$LOCBX EnterCode+24
   \   1115  F0                MOVX    @DPTR,A
   \   1116  A3                INC     DPTR
   \   1117  7400              MOV     A,#HIGH(commandLine+32)
   \   1119  F0                MOVX    @DPTR,A
   \   111A  A3                INC     DPTR
   \   111B  7420              MOV     A,#LOW(commandLine+32)
   \   111D  F0                MOVX    @DPTR,A
    792          
    793              timer = StartTimer(2000);                  //Trettio sekunders timeout
   \   111E  7D07              MOV     R5,#7
   \   1120  7CD0              MOV     R4,#208
   \   1122  120000            LCALL   $REFFN StartTimer
   \   1125  EC                MOV     A,R4
   \   1126  900000            MOV     DPTR,#$LOCBX EnterCode+21
   \   1129  F0                MOVX    @DPTR,A
   \   112A  E4                CLR     A
   \   112B  900000            MOV     DPTR,#$LOCBX EnterCode
   \   112E  F0                MOVX    @DPTR,A
   \   112F  900000            MOV     DPTR,#$LOCBX EnterCode+23
   \   1132  F0                MOVX    @DPTR,A
   \   1133            ?0347:
    794          
    795              while (!abort) {
   \   1133  900000            MOV     DPTR,#$LOCBX EnterCode
   \   1136  E0                MOVX    A,@DPTR
   \   1137  7053              JNZ     ?0346
   \   1139            ?0348:
    796                  c = DecodeReceivedDTMF();
   \   1139  120000            LCALL   $REFFN DecodeReceivedDTMF
    797                  if (c != 'e') {
   \   113C  EC                MOV     A,R4
   \   113D  900000            MOV     DPTR,#$LOCBX EnterCode+22
   \   1140  F0                MOVX    @DPTR,A
   \   1141  6465              XRL     A,#101
   \   1143  6016              JZ      ?0350
   \   1145            ?0349:
    798                      i++;
   \   1145  A3                INC     DPTR
   \   1146  E0                MOVX    A,@DPTR
   \   1147  04                INC     A
   \   1148  F0                MOVX    @DPTR,A
    799                      receivedDTMF = 0x00;
   \   1149  E4                CLR     A
   \   114A  900000            MOV     DPTR,#receivedDTMF
   \   114D  F0                MOVX    @DPTR,A
    800                      if (c == '#') abort = 1;
   \   114E  EC                MOV     A,R4
   \   114F  B42306            CJNE    A,#35,?0352
   \   1152            ?0351:
   \   1152  7401              MOV     A,#1
   \   1154  900000            MOV     DPTR,#$LOCBX EnterCode
   \   1157  F0                MOVX    @DPTR,A
   \   1158            ?0352:
    801                      SendRS232(c);
   \   1158  120000            LCALL   $REFFN SendRS232
   \   115B            ?0350:
    802                  }
    803                  if (TimedOut(timer)) abort = 2;
   \   115B  900000            MOV     DPTR,#$LOCBX EnterCode+21
   \   115E  E0                MOVX    A,@DPTR
   \   115F  FC                MOV     R4,A
   \   1160  120000            LCALL   $REFFN TimedOut
   \   1163  EC                MOV     A,R4
   \   1164  6006              JZ      ?0354
   \   1166            ?0353:
   \   1166  7402              MOV     A,#2
   \   1168  900000            MOV     DPTR,#$LOCBX EnterCode
   \   116B  F0                MOVX    @DPTR,A
   \   116C            ?0354:
    804                  if (i >= 20) abort = 3;
   \   116C  900000            MOV     DPTR,#$LOCBX EnterCode+23
   \   116F  E0                MOVX    A,@DPTR
   \   1170  24EC              ADD     A,#236
   \   1172  5006              JNC     ?0356
   \   1174            ?0355:
   \   1174  7403              MOV     A,#3
   \   1176  900000            MOV     DPTR,#$LOCBX EnterCode
   \   1179  F0                MOVX    @DPTR,A
   \   117A            ?0356:
    805                  if (terminateAnswer) abort = 4;
   \   117A  900000            MOV     DPTR,#terminateAnswer
   \   117D  E0                MOVX    A,@DPTR
   \   117E  6006              JZ      ?0358
   \   1180            ?0357:
   \   1180  7404              MOV     A,#4
   \   1182  900000            MOV     DPTR,#$LOCBX EnterCode
   \   1185  F0                MOVX    @DPTR,A
   \   1186            ?0358:
    806                  WDT = 1;
   \   1186  D2AE              SETB    IE.6
    807                  SWDT = 1;
   \   1188  D2BE              SETB    IP.6
   \   118A  80A7              SJMP    ?0347
   \   118C            ?0346:
    808              }
    809              
    810          //    SendStringRS232("Abort code: ");
    811          //    SendRS232('0' + abort);
    812          
    813              if (abort == 1) {
   \   118C  14                DEC     A
   \   118D  6003              JZ      $+5
   \   118F  02122D            LJMP    ?0360
   \   1192            ?0359:
    814                  //Check code
    815                  i = 0;
   \   1192  E4                CLR     A
   \   1193  900000            MOV     DPTR,#$LOCBX EnterCode+23
   \   1196  F0                MOVX    @DPTR,A
   \   1197            ?0363:
    816                  do {
    817                      c = GetNextDTMF();
   \   1197  120000            LCALL   $REFFN GetNextDTMF
    818                      enteredCode[i++] = c;
   \   119A  900000            MOV     DPTR,#$LOCBX EnterCode+23
   \   119D  E0                MOVX    A,@DPTR
   \   119E  FD                MOV     R5,A
   \   119F  04                INC     A
   \   11A0  F0                MOVX    @DPTR,A
   \   11A1  ED                MOV     A,R5
   \   11A2  2400              ADD     A,#LOW ($LOCBX EnterCode+1)
   \   11A4  F582              MOV     DPL,A
   \   11A6  E4                CLR     A
   \   11A7  3400              ADDC    A,#HIGH ($LOCBX EnterCode+1)
   \   11A9  F583              MOV     DPH,A
   \   11AB  EC                MOV     A,R4
   \   11AC  F0                MOVX    @DPTR,A
    819                      WDT = 1;
   \   11AD  D2AE              SETB    IE.6
    820                      SWDT = 1;
   \   11AF  D2BE              SETB    IP.6
    821                  } while (c != '#');
   \   11B1  900000            MOV     DPTR,#$LOCBX EnterCode+22
   \   11B4  F0                MOVX    @DPTR,A
   \   11B5  B423DF            CJNE    A,#35,?0363
   \   11B8            ?0361:
    822              
    823                  enteredCode[i-1] = 0x00;
   \   11B8  A3                INC     DPTR
   \   11B9  E0                MOVX    A,@DPTR
   \   11BA  2400              ADD     A,#LOW $LOCBX EnterCode
   \   11BC  F582              MOV     DPL,A
   \   11BE  E4                CLR     A
   \   11BF  3400              ADDC    A,#HIGH ($LOCBX EnterCode+1)
   \   11C1  F583              MOV     DPH,A
   \   11C3  E4                CLR     A
   \   11C4  F0                MOVX    @DPTR,A
    824          /*        
    825                  SendStringEOLRS232(" ");
    826                  SendStringEOLRS232("Entered code: ");
    827                  SendStringEOLRS232(enteredCode);
    828                  SendStringEOLRS232(" ");
    829          */ 
    830                  if (!myStrCmpNoCase(enteredCode, cmp)) {
   \   11C5  900000            MOV     DPTR,#$LOCBX EnterCode+24
   \   11C8  E0                MOVX    A,@DPTR
   \   11C9  FF                MOV     R7,A
   \   11CA  A3                INC     DPTR
   \   11CB  E0                MOVX    A,@DPTR
   \   11CC  FE                MOV     R6,A
   \   11CD  A3                INC     DPTR
   \   11CE  E0                MOVX    A,@DPTR
   \   11CF  FD                MOV     R5,A
   \   11D0  900000            MOV     DPTR,#$PRMBX myStrCmpNoCase+3
   \   11D3  EF                MOV     A,R7
   \   11D4  F0                MOVX    @DPTR,A
   \   11D5  A3                INC     DPTR
   \   11D6  EE                MOV     A,R6
   \   11D7  F0                MOVX    @DPTR,A
   \   11D8  A3                INC     DPTR
   \   11D9  ED                MOV     A,R5
   \   11DA  F0                MOVX    @DPTR,A
   \   11DB  7D00              MOV     R5,#LOW ($LOCBX EnterCode+1)
   \   11DD  7E00              MOV     R6,#HIGH ($LOCBX EnterCode+1)
   \   11DF  7F01              MOV     R7,#1
   \   11E1  120000            LCALL   $REFFN myStrCmpNoCase
   \   11E4  BC0023            CJNE    R4,#0,?0365
   \   11E7            ?0364:
    831          //            SendStringRS232("Code OK ");
    832          //            SendStringEOLRS232(labCorrectc);
    833                      if (labCorrectc[0] != 0x00) {                //Code OK
   \   11E7  900070            MOV     DPTR,#labCorrectc
   \   11EA  E0                MOVX    A,@DPTR
   \   11EB  601B              JZ      ?0367
   \   11ED            ?0366:
    834                          GotoLabel(labCorrectc);
   \   11ED  7D70              MOV     R5,#LOW(labCorrectc)
   \   11EF  7E00              MOV     R6,#HIGH(labCorrectc)
   \   11F1  7F01              MOV     R7,#1
   \   11F3  120000            LCALL   $REFFN GotoLabel
    835                          LogMessage("COK", NULL);
   \   11F6  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   11F9  E4                CLR     A
   \   11FA  F0                MOVX    @DPTR,A
   \   11FB  A3                INC     DPTR
   \   11FC  F0                MOVX    @DPTR,A
   \   11FD  A3                INC     DPTR
   \   11FE  F0                MOVX    @DPTR,A
   \   11FF  7D98              MOV     R5,#LOW(?0368)
   \   1201  7E01              MOV     R6,#HIGH(?0368)
   \   1203  7F02              MOV     R7,#2
   \   1205  120000            LCALL   $REFFN LogMessage
   \   1208            ?0367:
    836                      }
    837                  } else { 
   \   1208  8021              SJMP    ?0369
   \   120A            ?0365:
    838          //            SendStringRS232("Code Not OK ");
    839          //            SendStringEOLRS232(labIncorrectc);
    840                      if (labIncorrectc[0] != 0x00) {             //Code not OK
   \   120A  900078            MOV     DPTR,#labIncorrectc
   \   120D  E0                MOVX    A,@DPTR
   \   120E  601B              JZ      ?0371
   \   1210            ?0370:
    841                          GotoLabel(labIncorrectc);
   \   1210  7D78              MOV     R5,#LOW(labIncorrectc)
   \   1212  7E00              MOV     R6,#HIGH(labIncorrectc)
   \   1214  7F01              MOV     R7,#1
   \   1216  120000            LCALL   $REFFN GotoLabel
    842                          LogMessage("CNO", NULL);
   \   1219  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   121C  E4                CLR     A
   \   121D  F0                MOVX    @DPTR,A
   \   121E  A3                INC     DPTR
   \   121F  F0                MOVX    @DPTR,A
   \   1220  A3                INC     DPTR
   \   1221  F0                MOVX    @DPTR,A
   \   1222  7D9C              MOV     R5,#LOW(?0372)
   \   1224  7E01              MOV     R6,#HIGH(?0372)
   \   1226  7F02              MOV     R7,#2
   \   1228  120000            LCALL   $REFFN LogMessage
   \   122B            ?0371:
   \   122B            ?0369:
   \   122B  804D              SJMP    ?0373
   \   122D            ?0360:
    843                      }
    844                  }
    845              } else if (abort == 2) {
   \   122D  E0                MOVX    A,@DPTR
   \   122E  B40211            CJNE    A,#2,?0375
   \   1231            ?0374:
    846                  if (labTimeout[0] != 0x00) {                    //Timed out
   \   1231  900080            MOV     DPTR,#labTimeout
   \   1234  E0                MOVX    A,@DPTR
   \   1235  6009              JZ      ?0377
   \   1237            ?0376:
    847          //            SendStringEOLRS232("Codeentering timed out");
    848                      GotoLabel(labTimeout);
   \   1237  7D80              MOV     R5,#LOW(labTimeout)
   \   1239  7E00              MOV     R6,#HIGH(labTimeout)
   \   123B  7F01              MOV     R7,#1
   \   123D  120000            LCALL   $REFFN GotoLabel
   \   1240            ?0377:
   \   1240  8038              SJMP    ?0378
   \   1242            ?0375:
    849                  }
    850              } else if (abort == 3) {
   \   1242  B40323            CJNE    A,#3,?0380
   \   1245            ?0379:
    851                  if (labIncorrectc[0] != 0x00) {                 //Too many keypresses / Code not OK
   \   1245  900078            MOV     DPTR,#labIncorrectc
   \   1248  E0                MOVX    A,@DPTR
   \   1249  601B              JZ      ?0382
   \   124B            ?0381:
    852                      GotoLabel(labIncorrectc);
   \   124B  7D78              MOV     R5,#LOW(labIncorrectc)
   \   124D  7E00              MOV     R6,#HIGH(labIncorrectc)
   \   124F  7F01              MOV     R7,#1
   \   1251  120000            LCALL   $REFFN GotoLabel
    853                      LogMessage("CNO", NULL);
   \   1254  900000            MOV     DPTR,#$PRMBX LogMessage+3
   \   1257  E4                CLR     A
   \   1258  F0                MOVX    @DPTR,A
   \   1259  A3                INC     DPTR
   \   125A  F0                MOVX    @DPTR,A
   \   125B  A3                INC     DPTR
   \   125C  F0                MOVX    @DPTR,A
   \   125D  7D9C              MOV     R5,#LOW(?0372)
   \   125F  7E01              MOV     R6,#HIGH(?0372)
   \   1261  7F02              MOV     R7,#2
   \   1263  120000            LCALL   $REFFN LogMessage
   \   1266            ?0382:
   \   1266  8012              SJMP    ?0383
   \   1268            ?0380:
    854                  }
    855              } else if (abort == 4) {
   \   1268  B4040F            CJNE    A,#4,?0385
   \   126B            ?0384:
    856                  if (labHungUp[0] != 0x00) {                     //Caller hung up
   \   126B  900088            MOV     DPTR,#labHungUp
   \   126E  E0                MOVX    A,@DPTR
   \   126F  6009              JZ      ?0387
   \   1271            ?0386:
    857                      GotoLabel(labHungUp);
   \   1271  7D88              MOV     R5,#LOW(labHungUp)
   \   1273  7E00              MOV     R6,#HIGH(labHungUp)
   \   1275  7F01              MOV     R7,#1
   \   1277  120000            LCALL   $REFFN GotoLabel
   \   127A            ?0387:
   \   127A            ?0385:
   \   127A            ?0383:
   \   127A            ?0378:
   \   127A            ?0373:
    858                  }
    859              }
    860                  
    861              KillTimer(timer);
   \   127A  900000            MOV     DPTR,#$LOCBX EnterCode+21
   \   127D  E0                MOVX    A,@DPTR
   \   127E  FC                MOV     R4,A
   \   127F  120000            LCALL   $REFFN KillTimer
    862          
    863          }
   \   1282  900000            MOV     DPTR,#$LOCBX EnterCode+27
   \   1285  E0                MOVX    A,@DPTR
   \   1286  F8                MOV     R0,A
   \   1287  A3                INC     DPTR
   \   1288  E0                MOVX    A,@DPTR
   \   1289  C0E0              PUSH    ACC
   \   128B  E8                MOV     A,R0
   \   128C  C0E0              PUSH    ACC
   \   128E  22                RET
    864          
    865          void    SetupUpQLabels( void )
    866          {
   \   128F            SetupUpQLabels:
   \   128F  900000            MOV     DPTR,#$LOCBX SetupUpQLabels+4
   \   1292  D0E0              POP     ACC
   \   1294  F0                MOVX    @DPTR,A
   \   1295  A3                INC     DPTR
   \   1296  D0E0              POP     ACC
   \   1298  F0                MOVX    @DPTR,A
    867              xdata char    i;
    868              xdata char*    str;
    869          
    870              labDTMF[0] = 0x00;
   \   1299  E4                CLR     A
   \   129A  900008            MOV     DPTR,#labDTMF
   \   129D  F0                MOVX    @DPTR,A
    871              lab0[0] = 0x00;
   \   129E  900010            MOV     DPTR,#lab0
   \   12A1  F0                MOVX    @DPTR,A
    872              lab1[0] = 0x00;
   \   12A2  900018            MOV     DPTR,#lab1
   \   12A5  F0                MOVX    @DPTR,A
    873              lab2[0] = 0x00;
   \   12A6  900020            MOV     DPTR,#lab2
   \   12A9  F0                MOVX    @DPTR,A
    874              lab3[0] = 0x00;
   \   12AA  900028            MOV     DPTR,#lab3
   \   12AD  F0                MOVX    @DPTR,A
    875              lab4[0] = 0x00;
   \   12AE  900030            MOV     DPTR,#lab4
   \   12B1  F0                MOVX    @DPTR,A
    876              lab5[0] = 0x00;
   \   12B2  900038            MOV     DPTR,#lab5
   \   12B5  F0                MOVX    @DPTR,A
    877              lab6[0] = 0x00;
   \   12B6  900040            MOV     DPTR,#lab6
   \   12B9  F0                MOVX    @DPTR,A
    878              lab7[0] = 0x00;
   \   12BA  900048            MOV     DPTR,#lab7
   \   12BD  F0                MOVX    @DPTR,A
    879              lab8[0] = 0x00;
   \   12BE  900050            MOV     DPTR,#lab8
   \   12C1  F0                MOVX    @DPTR,A
    880              lab9[0] = 0x00;
   \   12C2  900058            MOV     DPTR,#lab9
   \   12C5  F0                MOVX    @DPTR,A
    881              labStar[0] = 0x00;
   \   12C6  900068            MOV     DPTR,#labStar
   \   12C9  F0                MOVX    @DPTR,A
    882              labPound[0] = 0x00;
   \   12CA  900060            MOV     DPTR,#labPound
   \   12CD  F0                MOVX    @DPTR,A
    883              labCorrectc[0] = 0x00;
   \   12CE  900070            MOV     DPTR,#labCorrectc
   \   12D1  F0                MOVX    @DPTR,A
    884              labIncorrectc[0] = 0x00;
   \   12D2  900078            MOV     DPTR,#labIncorrectc
   \   12D5  F0                MOVX    @DPTR,A
    885              labTimeout[0] = 0x00;
   \   12D6  900080            MOV     DPTR,#labTimeout
   \   12D9  F0                MOVX    @DPTR,A
    886              labHungUp[0] = 0x00;
   \   12DA  900088            MOV     DPTR,#labHungUp
   \   12DD  F0                MOVX    @DPTR,A
    887          
    888              for (i=1 ; i<nrCommandParameters ; i++) {
   \   12DE  04                INC     A
   \   12DF  900000            MOV     DPTR,#$LOCBX SetupUpQLabels
   \   12E2  F0                MOVX    @DPTR,A
   \   12E3            ?0389:
   \   12E3  900000            MOV     DPTR,#$LOCBX SetupUpQLabels
   \   12E6  E0                MOVX    A,@DPTR
   \   12E7  7D00              MOV     R5,#0
   \   12E9  FC                MOV     R4,A
   \   12EA  900001            MOV     DPTR,#nrCommandParameters+1
   \   12ED  E0                MOVX    A,@DPTR
   \   12EE  D3                SETB    C
   \   12EF  9C                SUBB    A,R4
   \   12F0  900000            MOV     DPTR,#nrCommandParameters
   \   12F3  E0                MOVX    A,@DPTR
   \   12F4  6480              XRL     A,#128
   \   12F6  CD                XCH     A,R5
   \   12F7  6480              XRL     A,#128
   \   12F9  CD                XCH     A,R5
   \   12FA  9D                SUBB    A,R5
   \   12FB  5003              JNC     $+5
   \   12FD  021558            LJMP    ?0388
   \   1300            ?0390:
    889                  str = commandLine[i];
   \   1300  EC                MOV     A,R4
   \   1301  75F010            MOV     B,#16
   \   1304  A4                MUL     AB
   \   1305  2400              ADD     A,#LOW(commandLine)
   \   1307  FC                MOV     R4,A
   \   1308  E5F0              MOV     A,B
   \   130A  3400              ADDC    A,#HIGH(commandLine)
   \   130C  FE                MOV     R6,A
   \   130D  EC                MOV     A,R4
   \   130E  FD                MOV     R5,A
   \   130F  7F01              MOV     R7,#1
    890                  if (str[2] == '=') {
   \   1311  900000            MOV     DPTR,#$LOCBX SetupUpQLabels+1
   \   1314  EF                MOV     A,R7
   \   1315  F0                MOVX    @DPTR,A
   \   1316  A3                INC     DPTR
   \   1317  EE                MOV     A,R6
   \   1318  F0                MOVX    @DPTR,A
   \   1319  A3                INC     DPTR
   \   131A  ED                MOV     A,R5
   \   131B  F0                MOVX    @DPTR,A
   \   131C  900002            MOV     DPTR,#2
   \   131F  120000            LCALL   ?LD_A_R567_DISP_L17
   \   1322  B43D02            CJNE    A,#61,$+5
   \   1325  8003              SJMP    $+5
   \   1327  02154F            LJMP    ?0393
   \   132A            ?0392:
    891                      if (str[0] == 'L') {
   \   132A  120000            LCALL   ?LD_A_R567_L17
   \   132D  B44C02            CJNE    A,#76,$+5
   \   1330  8003              SJMP    $+5
   \   1332  02152E            LJMP    ?0395
   \   1335            ?0394:
    892                          if (str[1] == '0') {
   \   1335  900001            MOV     DPTR,#1
   \   1338  120000            LCALL   ?LD_A_R567_DISP_L17
   \   133B  B43015            CJNE    A,#48,?0397
   \   133E            ?0396:
    893                              LabelCopy(lab0, str);
   \   133E  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   1341  EF                MOV     A,R7
   \   1342  F0                MOVX    @DPTR,A
   \   1343  A3                INC     DPTR
   \   1344  EE                MOV     A,R6
   \   1345  F0                MOVX    @DPTR,A
   \   1346  A3                INC     DPTR
   \   1347  ED                MOV     A,R5
   \   1348  F0                MOVX    @DPTR,A
   \   1349  7D10              MOV     R5,#LOW(lab0)
   \   134B  7E00              MOV     R6,#HIGH(lab0)
   \   134D  120000            LCALL   $REFFN LabelCopy
   \   1350  02152C            LJMP    ?0398
   \   1353            ?0397:
    894                          } else if (str[1] == '1') {
   \   1353  900001            MOV     DPTR,#1
   \   1356  120000            LCALL   ?LD_A_R567_DISP_L17
   \   1359  B43115            CJNE    A,#49,?0400
   \   135C            ?0399:
    895                              LabelCopy(lab1, str);
   \   135C  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   135F  EF                MOV     A,R7
   \   1360  F0                MOVX    @DPTR,A
   \   1361  A3                INC     DPTR
   \   1362  EE                MOV     A,R6
   \   1363  F0                MOVX    @DPTR,A
   \   1364  A3                INC     DPTR
   \   1365  ED                MOV     A,R5
   \   1366  F0                MOVX    @DPTR,A
   \   1367  7D18              MOV     R5,#LOW(lab1)
   \   1369  7E00              MOV     R6,#HIGH(lab1)
   \   136B  120000            LCALL   $REFFN LabelCopy
   \   136E  02152C            LJMP    ?0401
   \   1371            ?0400:
    896                          } else if (str[1] == '2') {
   \   1371  900001            MOV     DPTR,#1
   \   1374  120000            LCALL   ?LD_A_R567_DISP_L17
   \   1377  B43215            CJNE    A,#50,?0403
   \   137A            ?0402:
    897                              LabelCopy(lab2, str);
   \   137A  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   137D  EF                MOV     A,R7
   \   137E  F0                MOVX    @DPTR,A
   \   137F  A3                INC     DPTR
   \   1380  EE                MOV     A,R6
   \   1381  F0                MOVX    @DPTR,A
   \   1382  A3                INC     DPTR
   \   1383  ED                MOV     A,R5
   \   1384  F0                MOVX    @DPTR,A
   \   1385  7D20              MOV     R5,#LOW(lab2)
   \   1387  7E00              MOV     R6,#HIGH(lab2)
   \   1389  120000            LCALL   $REFFN LabelCopy
   \   138C  02152C            LJMP    ?0404
   \   138F            ?0403:
    898                          } else if (str[1] == '3') {
   \   138F  900001            MOV     DPTR,#1
   \   1392  120000            LCALL   ?LD_A_R567_DISP_L17
   \   1395  B43315            CJNE    A,#51,?0406
   \   1398            ?0405:
    899                              LabelCopy(lab3, str);
   \   1398  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   139B  EF                MOV     A,R7
   \   139C  F0                MOVX    @DPTR,A
   \   139D  A3                INC     DPTR
   \   139E  EE                MOV     A,R6
   \   139F  F0                MOVX    @DPTR,A
   \   13A0  A3                INC     DPTR
   \   13A1  ED                MOV     A,R5
   \   13A2  F0                MOVX    @DPTR,A
   \   13A3  7D28              MOV     R5,#LOW(lab3)
   \   13A5  7E00              MOV     R6,#HIGH(lab3)
   \   13A7  120000            LCALL   $REFFN LabelCopy
   \   13AA  02152C            LJMP    ?0407
   \   13AD            ?0406:
    900                          } else if (str[1] == '4') {
   \   13AD  900001            MOV     DPTR,#1
   \   13B0  120000            LCALL   ?LD_A_R567_DISP_L17
   \   13B3  B43415            CJNE    A,#52,?0409
   \   13B6            ?0408:
    901                              LabelCopy(lab4, str);
   \   13B6  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   13B9  EF                MOV     A,R7
   \   13BA  F0                MOVX    @DPTR,A
   \   13BB  A3                INC     DPTR
   \   13BC  EE                MOV     A,R6
   \   13BD  F0                MOVX    @DPTR,A
   \   13BE  A3                INC     DPTR
   \   13BF  ED                MOV     A,R5
   \   13C0  F0                MOVX    @DPTR,A
   \   13C1  7D30              MOV     R5,#LOW(lab4)
   \   13C3  7E00              MOV     R6,#HIGH(lab4)
   \   13C5  120000            LCALL   $REFFN LabelCopy
   \   13C8  02152C            LJMP    ?0410
   \   13CB            ?0409:
    902                          } else if (str[1] == '5') {
   \   13CB  900001            MOV     DPTR,#1
   \   13CE  120000            LCALL   ?LD_A_R567_DISP_L17
   \   13D1  B43515            CJNE    A,#53,?0412
   \   13D4            ?0411:
    903                              LabelCopy(lab5, str);
   \   13D4  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   13D7  EF                MOV     A,R7
   \   13D8  F0                MOVX    @DPTR,A
   \   13D9  A3                INC     DPTR
   \   13DA  EE                MOV     A,R6
   \   13DB  F0                MOVX    @DPTR,A
   \   13DC  A3                INC     DPTR
   \   13DD  ED                MOV     A,R5
   \   13DE  F0                MOVX    @DPTR,A
   \   13DF  7D38              MOV     R5,#LOW(lab5)
   \   13E1  7E00              MOV     R6,#HIGH(lab5)
   \   13E3  120000            LCALL   $REFFN LabelCopy
   \   13E6  02152C            LJMP    ?0413
   \   13E9            ?0412:
    904                          } else if (str[1] == '6') {
   \   13E9  900001            MOV     DPTR,#1
   \   13EC  120000            LCALL   ?LD_A_R567_DISP_L17
   \   13EF  B43615            CJNE    A,#54,?0415
   \   13F2            ?0414:
    905                              LabelCopy(lab6, str);
   \   13F2  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   13F5  EF                MOV     A,R7
   \   13F6  F0                MOVX    @DPTR,A
   \   13F7  A3                INC     DPTR
   \   13F8  EE                MOV     A,R6
   \   13F9  F0                MOVX    @DPTR,A
   \   13FA  A3                INC     DPTR
   \   13FB  ED                MOV     A,R5
   \   13FC  F0                MOVX    @DPTR,A
   \   13FD  7D40              MOV     R5,#LOW(lab6)
   \   13FF  7E00              MOV     R6,#HIGH(lab6)
   \   1401  120000            LCALL   $REFFN LabelCopy
   \   1404  02152C            LJMP    ?0416
   \   1407            ?0415:
    906                          } else if (str[1] == '7') {
   \   1407  900001            MOV     DPTR,#1
   \   140A  120000            LCALL   ?LD_A_R567_DISP_L17
   \   140D  B43715            CJNE    A,#55,?0418
   \   1410            ?0417:
    907                              LabelCopy(lab7, str);
   \   1410  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   1413  EF                MOV     A,R7
   \   1414  F0                MOVX    @DPTR,A
   \   1415  A3                INC     DPTR
   \   1416  EE                MOV     A,R6
   \   1417  F0                MOVX    @DPTR,A
   \   1418  A3                INC     DPTR
   \   1419  ED                MOV     A,R5
   \   141A  F0                MOVX    @DPTR,A
   \   141B  7D48              MOV     R5,#LOW(lab7)
   \   141D  7E00              MOV     R6,#HIGH(lab7)
   \   141F  120000            LCALL   $REFFN LabelCopy
   \   1422  02152C            LJMP    ?0419
   \   1425            ?0418:
    908                          } else if (str[1] == '8') {
   \   1425  900001            MOV     DPTR,#1
   \   1428  120000            LCALL   ?LD_A_R567_DISP_L17
   \   142B  B43815            CJNE    A,#56,?0421
   \   142E            ?0420:
    909                              LabelCopy(lab8, str);
   \   142E  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   1431  EF                MOV     A,R7
   \   1432  F0                MOVX    @DPTR,A
   \   1433  A3                INC     DPTR
   \   1434  EE                MOV     A,R6
   \   1435  F0                MOVX    @DPTR,A
   \   1436  A3                INC     DPTR
   \   1437  ED                MOV     A,R5
   \   1438  F0                MOVX    @DPTR,A
   \   1439  7D50              MOV     R5,#LOW(lab8)
   \   143B  7E00              MOV     R6,#HIGH(lab8)
   \   143D  120000            LCALL   $REFFN LabelCopy
   \   1440  02152C            LJMP    ?0422
   \   1443            ?0421:
    910                          } else if (str[1] == '9') {
   \   1443  900001            MOV     DPTR,#1
   \   1446  120000            LCALL   ?LD_A_R567_DISP_L17
   \   1449  B43915            CJNE    A,#57,?0424
   \   144C            ?0423:
    911                              LabelCopy(lab9, str);
   \   144C  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   144F  EF                MOV     A,R7
   \   1450  F0                MOVX    @DPTR,A
   \   1451  A3                INC     DPTR
   \   1452  EE                MOV     A,R6
   \   1453  F0                MOVX    @DPTR,A
   \   1454  A3                INC     DPTR
   \   1455  ED                MOV     A,R5
   \   1456  F0                MOVX    @DPTR,A
   \   1457  7D58              MOV     R5,#LOW(lab9)
   \   1459  7E00              MOV     R6,#HIGH(lab9)
   \   145B  120000            LCALL   $REFFN LabelCopy
   \   145E  02152C            LJMP    ?0425
   \   1461            ?0424:
    912                          } else if (str[1] == 'S') {
   \   1461  900001            MOV     DPTR,#1
   \   1464  120000            LCALL   ?LD_A_R567_DISP_L17
   \   1467  B45315            CJNE    A,#83,?0427
   \   146A            ?0426:
    913                              LabelCopy(labStar, str);
   \   146A  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   146D  EF                MOV     A,R7
   \   146E  F0                MOVX    @DPTR,A
   \   146F  A3                INC     DPTR
   \   1470  EE                MOV     A,R6
   \   1471  F0                MOVX    @DPTR,A
   \   1472  A3                INC     DPTR
   \   1473  ED                MOV     A,R5
   \   1474  F0                MOVX    @DPTR,A
   \   1475  7D68              MOV     R5,#LOW(labStar)
   \   1477  7E00              MOV     R6,#HIGH(labStar)
   \   1479  120000            LCALL   $REFFN LabelCopy
   \   147C  02152C            LJMP    ?0428
   \   147F            ?0427:
    914                          } else if (str[1] == 'P') {
   \   147F  900001            MOV     DPTR,#1
   \   1482  120000            LCALL   ?LD_A_R567_DISP_L17
   \   1485  B45015            CJNE    A,#80,?0430
   \   1488            ?0429:
    915                              LabelCopy(labPound, str);
   \   1488  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   148B  EF                MOV     A,R7
   \   148C  F0                MOVX    @DPTR,A
   \   148D  A3                INC     DPTR
   \   148E  EE                MOV     A,R6
   \   148F  F0                MOVX    @DPTR,A
   \   1490  A3                INC     DPTR
   \   1491  ED                MOV     A,R5
   \   1492  F0                MOVX    @DPTR,A
   \   1493  7D60              MOV     R5,#LOW(labPound)
   \   1495  7E00              MOV     R6,#HIGH(labPound)
   \   1497  120000            LCALL   $REFFN LabelCopy
   \   149A  02152C            LJMP    ?0431
   \   149D            ?0430:
    916                          } else if (str[1] == 'C') {
   \   149D  900001            MOV     DPTR,#1
   \   14A0  120000            LCALL   ?LD_A_R567_DISP_L17
   \   14A3  B44314            CJNE    A,#67,?0433
   \   14A6            ?0432:
    917                              LabelCopy(labCorrectc, str);
   \   14A6  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   14A9  EF                MOV     A,R7
   \   14AA  F0                MOVX    @DPTR,A
   \   14AB  A3                INC     DPTR
   \   14AC  EE                MOV     A,R6
   \   14AD  F0                MOVX    @DPTR,A
   \   14AE  A3                INC     DPTR
   \   14AF  ED                MOV     A,R5
   \   14B0  F0                MOVX    @DPTR,A
   \   14B1  7D70              MOV     R5,#LOW(labCorrectc)
   \   14B3  7E00              MOV     R6,#HIGH(labCorrectc)
   \   14B5  120000            LCALL   $REFFN LabelCopy
   \   14B8  8072              SJMP    ?0434
   \   14BA            ?0433:
    918                          } else if (str[1] == 'I') {
   \   14BA  900001            MOV     DPTR,#1
   \   14BD  120000            LCALL   ?LD_A_R567_DISP_L17
   \   14C0  B44914            CJNE    A,#73,?0436
   \   14C3            ?0435:
    919                              LabelCopy(labIncorrectc, str);
   \   14C3  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   14C6  EF                MOV     A,R7
   \   14C7  F0                MOVX    @DPTR,A
   \   14C8  A3                INC     DPTR
   \   14C9  EE                MOV     A,R6
   \   14CA  F0                MOVX    @DPTR,A
   \   14CB  A3                INC     DPTR
   \   14CC  ED                MOV     A,R5
   \   14CD  F0                MOVX    @DPTR,A
   \   14CE  7D78              MOV     R5,#LOW(labIncorrectc)
   \   14D0  7E00              MOV     R6,#HIGH(labIncorrectc)
   \   14D2  120000            LCALL   $REFFN LabelCopy
   \   14D5  8055              SJMP    ?0437
   \   14D7            ?0436:
    920                          } else if (str[1] == 'T') {
   \   14D7  900001            MOV     DPTR,#1
   \   14DA  120000            LCALL   ?LD_A_R567_DISP_L17
   \   14DD  B45414            CJNE    A,#84,?0439
   \   14E0            ?0438:
    921                              LabelCopy(labTimeout, str);
   \   14E0  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   14E3  EF                MOV     A,R7
   \   14E4  F0                MOVX    @DPTR,A
   \   14E5  A3                INC     DPTR
   \   14E6  EE                MOV     A,R6
   \   14E7  F0                MOVX    @DPTR,A
   \   14E8  A3                INC     DPTR
   \   14E9  ED                MOV     A,R5
   \   14EA  F0                MOVX    @DPTR,A
   \   14EB  7D80              MOV     R5,#LOW(labTimeout)
   \   14ED  7E00              MOV     R6,#HIGH(labTimeout)
   \   14EF  120000            LCALL   $REFFN LabelCopy
   \   14F2  8038              SJMP    ?0440
   \   14F4            ?0439:
    922                          } else if (str[1] == 'H') {
   \   14F4  900001            MOV     DPTR,#1
   \   14F7  120000            LCALL   ?LD_A_R567_DISP_L17
   \   14FA  B44814            CJNE    A,#72,?0442
   \   14FD            ?0441:
    923                              LabelCopy(labHungUp, str);
   \   14FD  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   1500  EF                MOV     A,R7
   \   1501  F0                MOVX    @DPTR,A
   \   1502  A3                INC     DPTR
   \   1503  EE                MOV     A,R6
   \   1504  F0                MOVX    @DPTR,A
   \   1505  A3                INC     DPTR
   \   1506  ED                MOV     A,R5
   \   1507  F0                MOVX    @DPTR,A
   \   1508  7D88              MOV     R5,#LOW(labHungUp)
   \   150A  7E00              MOV     R6,#HIGH(labHungUp)
   \   150C  120000            LCALL   $REFFN LabelCopy
   \   150F  801B              SJMP    ?0443
   \   1511            ?0442:
    924                          } else if (str[1] == 'D') {
   \   1511  900001            MOV     DPTR,#1
   \   1514  120000            LCALL   ?LD_A_R567_DISP_L17
   \   1517  B44412            CJNE    A,#68,?0445
   \   151A            ?0444:
    925                              LabelCopy(labDTMF, str);
   \   151A  900000            MOV     DPTR,#$PRMBX LabelCopy+3
   \   151D  EF                MOV     A,R7
   \   151E  F0                MOVX    @DPTR,A
   \   151F  A3                INC     DPTR
   \   1520  EE                MOV     A,R6
   \   1521  F0                MOVX    @DPTR,A
   \   1522  A3                INC     DPTR
   \   1523  ED                MOV     A,R5
   \   1524  F0                MOVX    @DPTR,A
   \   1525  7D08              MOV     R5,#LOW(labDTMF)
   \   1527  7E00              MOV     R6,#HIGH(labDTMF)
   \   1529  120000            LCALL   $REFFN LabelCopy
   \   152C            ?0445:
   \   152C            ?0443:
   \   152C            ?0440:
   \   152C            ?0437:
   \   152C            ?0434:
   \   152C            ?0431:
   \   152C            ?0428:
   \   152C            ?0425:
   \   152C            ?0422:
   \   152C            ?0419:
   \   152C            ?0416:
   \   152C            ?0413:
   \   152C            ?0410:
   \   152C            ?0407:
   \   152C            ?0404:
   \   152C            ?0401:
   \   152C            ?0398:
   \   152C  8021              SJMP    ?0446
   \   152E            ?0395:
    926                          }
    927                      } else if ((str[0] == 'T') && (str[1] == 'V')) {
   \   152E  120000            LCALL   ?LD_A_R567_L17
   \   1531  B4541B            CJNE    A,#84,?0448
   \   1534  900001            MOV     DPTR,#1
   \   1537  120000            LCALL   ?LD_A_R567_DISP_L17
   \   153A  B45612            CJNE    A,#86,?0448
   \   153D            ?0450:
   \   153D            ?0449:
   \   153D            ?0447:
    928                          timeoutValue = myStr2Int((char*) str + 3);
   \   153D  ED                MOV     A,R5
   \   153E  2403              ADD     A,#3
   \   1540  FD                MOV     R5,A
   \   1541  5001              JNC     ?0558
   \   1543  0E                INC     R6
   \   1544            ?0558:
   \   1544  120000            LCALL   $REFFN myStr2Int
   \   1547  900090            MOV     DPTR,#timeoutValue
   \   154A  ED                MOV     A,R5
   \   154B  F0                MOVX    @DPTR,A
   \   154C  A3                INC     DPTR
   \   154D  EC                MOV     A,R4
   \   154E  F0                MOVX    @DPTR,A
   \   154F            ?0448:
   \   154F            ?0446:
   \   154F            ?0393:
   \   154F  900000            MOV     DPTR,#$LOCBX SetupUpQLabels
   \   1552  E0                MOVX    A,@DPTR
   \   1553  04                INC     A
   \   1554  F0                MOVX    @DPTR,A
    929                      }
    930                  }
    931              }
    932          }
   \   1555  0212E3            LJMP    ?0389
   \   1558            ?0388:
   \   1558  900000            MOV     DPTR,#$LOCBX SetupUpQLabels+4
   \   155B  E0                MOVX    A,@DPTR
   \   155C  F8                MOV     R0,A
   \   155D  A3                INC     DPTR
   \   155E  E0                MOVX    A,@DPTR
   \   155F  C0E0              PUSH    ACC
   \   1561  E8                MOV     A,R0
   \   1562  C0E0              PUSH    ACC
   \   1564  22                RET
    933                  
    934          void    LabelCopy(char* dest, const char* src)
    935          {
   \   1565            LabelCopy:
    936              xdata char i;
    937              
    938              i = 0;
   \   1565  E4                CLR     A
   \   1566  900000            MOV     DPTR,#$LOCBX LabelCopy
   \   1569  F0                MOVX    @DPTR,A
   \   156A  A3                INC     DPTR
   \   156B  EF                MOV     A,R7
   \   156C  F0                MOVX    @DPTR,A
   \   156D  A3                INC     DPTR
   \   156E  EE                MOV     A,R6
   \   156F  F0                MOVX    @DPTR,A
   \   1570  A3                INC     DPTR
   \   1571  ED                MOV     A,R5
   \   1572  F0                MOVX    @DPTR,A
   \   1573            ?0452:
    939              
    940              while (src[i+3] != 0x00) {
   \   1573  900000            MOV     DPTR,#$LOCBX LabelCopy+4
   \   1576  E0                MOVX    A,@DPTR
   \   1577  FF                MOV     R7,A
   \   1578  A3                INC     DPTR
   \   1579  E0                MOVX    A,@DPTR
   \   157A  FE                MOV     R6,A
   \   157B  A3                INC     DPTR
   \   157C  E0                MOVX    A,@DPTR
   \   157D  FD                MOV     R5,A
   \   157E  900000            MOV     DPTR,#$LOCBX LabelCopy
   \   1581  E0                MOVX    A,@DPTR
   \   1582  F582              MOV     DPL,A
   \   1584  758300            MOV     DPH,#0
   \   1587  A3                INC     DPTR
   \   1588  A3                INC     DPTR
   \   1589  A3                INC     DPTR
   \   158A  120000            LCALL   ?LD_A_R567_DISP_L17
   \   158D  602D              JZ      ?0451
   \   158F            ?0453:
    941                  dest[i] = src[i+3];
   \   158F  900000            MOV     DPTR,#$LOCBX LabelCopy
   \   1592  E0                MOVX    A,@DPTR
   \   1593  FC                MOV     R4,A
   \   1594  F582              MOV     DPL,A
   \   1596  758300            MOV     DPH,#0
   \   1599  A3                INC     DPTR
   \   159A  A3                INC     DPTR
   \   159B  A3                INC     DPTR
   \   159C  120000            LCALL   ?LD_A_R567_DISP_L17
   \   159F  FA                MOV     R2,A
   \   15A0  900000            MOV     DPTR,#$LOCBX LabelCopy+1
   \   15A3  E0                MOVX    A,@DPTR
   \   15A4  FF                MOV     R7,A
   \   15A5  A3                INC     DPTR
   \   15A6  E0                MOVX    A,@DPTR
   \   15A7  FE                MOV     R6,A
   \   15A8  A3                INC     DPTR
   \   15A9  E0                MOVX    A,@DPTR
   \   15AA  FD                MOV     R5,A
   \   15AB  8C82              MOV     DPL,R4
   \   15AD  758300            MOV     DPH,#0
   \   15B0  EA                MOV     A,R2
   \   15B1  120000            LCALL   ?ST_A_R567_DISP_L17
    942                  i++;
   \   15B4  0C                INC     R4
   \   15B5  EC                MOV     A,R4
   \   15B6  900000            MOV     DPTR,#$LOCBX LabelCopy
   \   15B9  F0                MOVX    @DPTR,A
   \   15BA  80B7              SJMP    ?0452
   \   15BC            ?0451:
    943              }
    944              dest[i] = 0x00;
   \   15BC  900000            MOV     DPTR,#$LOCBX LabelCopy+1
   \   15BF  E0                MOVX    A,@DPTR
   \   15C0  FF                MOV     R7,A
   \   15C1  A3                INC     DPTR
   \   15C2  E0                MOVX    A,@DPTR
   \   15C3  FE                MOV     R6,A
   \   15C4  A3                INC     DPTR
   \   15C5  E0                MOVX    A,@DPTR
   \   15C6  FD                MOV     R5,A
   \   15C7  900000            MOV     DPTR,#$LOCBX LabelCopy
   \   15CA  E0                MOVX    A,@DPTR
   \   15CB  F582              MOV     DPL,A
   \   15CD  758300            MOV     DPH,#0
   \   15D0  E4                CLR     A
   \   15D1  020000            LJMP    ?ST_A_R567_DISP_L17
    945          }
    946                  
    947          
    948          
    949          
    950          
    951          
    952          void    CreateUniqueFilename(char* str)
    953          /*
    954          Skapat namn blir ABCDEFGH.WAW där:
    955          
    956            A = 'M', huvud
    957            B = År enl 0-9
    958            C = Månad enl A-K (motsv 1-12)
    959            D = Dag enl A-Z, a-e (mostv 1-31)
    960            E = Timme enl 0-9, A-N (motsv 0-23)
    961            F = Minut enl 0-5 (tiotal motsv 0-50)
    962            G = Minut enl 0-9 (ental)
    963            H = Ordning enl 0-9, A-Z, a-z (motsv 0-62)
    964          
    965            A är alltid 'M' och B-G skapas från calendern. H prövas fram. Först testas '0', om det
    966            är upptaget prövas '1' osv. 
    967          */
    968          {
   \   15D4            CreateUniqueFilename:
   \   15D4  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+12
   \   15D7  D0E0              POP     ACC
   \   15D9  F0                MOVX    @DPTR,A
   \   15DA  A3                INC     DPTR
   \   15DB  D0E0              POP     ACC
   \   15DD  F0                MOVX    @DPTR,A
    969              xdata TIME    tv;
    970              xdata DATE    dv;
    971              xdata char    order;
    972              xdata char    tmp;
    973              xdata FILE*   fp;
    974          
    975              GetTimeNow(&tv);
   \   15DE  A3                INC     DPTR
   \   15DF  EF                MOV     A,R7
   \   15E0  F0                MOVX    @DPTR,A
   \   15E1  A3                INC     DPTR
   \   15E2  EE                MOV     A,R6
   \   15E3  F0                MOVX    @DPTR,A
   \   15E4  A3                INC     DPTR
   \   15E5  ED                MOV     A,R5
   \   15E6  F0                MOVX    @DPTR,A
   \   15E7  7D00              MOV     R5,#LOW $LOCBX CreateUniqueFilename
   \   15E9  7E00              MOV     R6,#HIGH $LOCBX CreateUniqueFilename
   \   15EB  7F01              MOV     R7,#1
   \   15ED  120000            LCALL   $REFFN GetTimeNow
    976              GetDateNow(&dv);
   \   15F0  7D00              MOV     R5,#LOW ($LOCBX CreateUniqueFilename+3)
   \   15F2  7E00              MOV     R6,#HIGH ($LOCBX CreateUniqueFilename+3)
   \   15F4  7F01              MOV     R7,#1
   \   15F6  120000            LCALL   $REFFN GetDateNow
    977          
    978              str[0] = 'M';
   \   15F9  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+14
   \   15FC  E0                MOVX    A,@DPTR
   \   15FD  FF                MOV     R7,A
   \   15FE  A3                INC     DPTR
   \   15FF  E0                MOVX    A,@DPTR
   \   1600  FE                MOV     R6,A
   \   1601  A3                INC     DPTR
   \   1602  E0                MOVX    A,@DPTR
   \   1603  FD                MOV     R5,A
   \   1604  744D              MOV     A,#77
   \   1606  120000            LCALL   ?ST_A_R567_L17
    979              str[1] = (dv.year & 0x0F) + '0';
   \   1609  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+6
   \   160C  E0                MOVX    A,@DPTR
   \   160D  540F              ANL     A,#15
   \   160F  2430              ADD     A,#48
   \   1611  900001            MOV     DPTR,#1
   \   1614  120000            LCALL   ?ST_A_R567_DISP_L17
    980              if (dv.month <= 9) {
   \   1617  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+5
   \   161A  E0                MOVX    A,@DPTR
   \   161B  24F6              ADD     A,#246
   \   161D  400E              JC      ?0455
   \   161F            ?0454:
    981                  str[2] = dv.month + 'A' - 1;
   \   161F  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+5
   \   1622  E0                MOVX    A,@DPTR
   \   1623  2440              ADD     A,#64
   \   1625  900002            MOV     DPTR,#2
   \   1628  120000            LCALL   ?ST_A_R567_DISP_L17
    982              } else {
   \   162B  800C              SJMP    ?0456
   \   162D            ?0455:
    983                  str[2] = dv.month + 'A' - 1 -  16;
   \   162D  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+5
   \   1630  E0                MOVX    A,@DPTR
   \   1631  2430              ADD     A,#48
   \   1633  900002            MOV     DPTR,#2
   \   1636  120000            LCALL   ?ST_A_R567_DISP_L17
   \   1639            ?0456:
    984              }
    985              
    986              tmp = ((dv.date >> 4) & 0x03) * 10 + (dv.date & 0x0F);
   \   1639  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+4
   \   163C  E0                MOVX    A,@DPTR
   \   163D  C4                SWAP    A
   \   163E  5403              ANL     A,#3
   \   1640  75F00A            MOV     B,#10
   \   1643  A4                MUL     AB
   \   1644  FC                MOV     R4,A
   \   1645  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+4
   \   1648  E0                MOVX    A,@DPTR
   \   1649  540F              ANL     A,#15
   \   164B  2C                ADD     A,R4
   \   164C  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+8
   \   164F  F0                MOVX    @DPTR,A
    987          
    988              if (tmp <= 26) {
   \   1650  E0                MOVX    A,@DPTR
   \   1651  24E5              ADD     A,#229
   \   1653  400B              JC      ?0458
   \   1655            ?0457:
    989                  str[3] = tmp + 'A' - 1;
   \   1655  E0                MOVX    A,@DPTR
   \   1656  2440              ADD     A,#64
   \   1658  900003            MOV     DPTR,#3
   \   165B  120000            LCALL   ?ST_A_R567_DISP_L17
    990              } else {
   \   165E  8009              SJMP    ?0459
   \   1660            ?0458:
    991                  str[3] = tmp + 'a' - 27;
   \   1660  E0                MOVX    A,@DPTR
   \   1661  2446              ADD     A,#70
   \   1663  900003            MOV     DPTR,#3
   \   1666  120000            LCALL   ?ST_A_R567_DISP_L17
   \   1669            ?0459:
    992              }
    993          
    994              tmp = ((tv.hours >> 4) & 0x03) * 10 + (tv.hours & 0x0F);
   \   1669  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+2
   \   166C  E0                MOVX    A,@DPTR
   \   166D  C4                SWAP    A
   \   166E  5403              ANL     A,#3
   \   1670  75F00A            MOV     B,#10
   \   1673  A4                MUL     AB
   \   1674  FC                MOV     R4,A
   \   1675  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+2
   \   1678  E0                MOVX    A,@DPTR
   \   1679  540F              ANL     A,#15
   \   167B  2C                ADD     A,R4
   \   167C  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+8
   \   167F  F0                MOVX    @DPTR,A
    995          
    996              if (tmp <= 9) {
   \   1680  E0                MOVX    A,@DPTR
   \   1681  24F6              ADD     A,#246
   \   1683  400B              JC      ?0461
   \   1685            ?0460:
    997                  str[4] = tmp + '0';
   \   1685  E0                MOVX    A,@DPTR
   \   1686  2430              ADD     A,#48
   \   1688  900004            MOV     DPTR,#4
   \   168B  120000            LCALL   ?ST_A_R567_DISP_L17
    998              } else {
   \   168E  8009              SJMP    ?0462
   \   1690            ?0461:
    999                  str[4] = tmp + 'A' - 10;
   \   1690  E0                MOVX    A,@DPTR
   \   1691  2437              ADD     A,#55
   \   1693  900004            MOV     DPTR,#4
   \   1696  120000            LCALL   ?ST_A_R567_DISP_L17
   \   1699            ?0462:
   1000              }
   1001              str[5] = ((tv.minutes >> 4) & 0x07) + '0';
   \   1699  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+1
   \   169C  E0                MOVX    A,@DPTR
   \   169D  C4                SWAP    A
   \   169E  5407              ANL     A,#7
   \   16A0  2430              ADD     A,#48
   \   16A2  900005            MOV     DPTR,#5
   \   16A5  120000            LCALL   ?ST_A_R567_DISP_L17
   1002              str[6] = (tv.minutes & 0x0F) + '0';
   \   16A8  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+1
   \   16AB  E0                MOVX    A,@DPTR
   \   16AC  540F              ANL     A,#15
   \   16AE  2430              ADD     A,#48
   \   16B0  900006            MOV     DPTR,#6
   \   16B3  120000            LCALL   ?ST_A_R567_DISP_L17
   1003          
   1004              str[8] = '.';
   \   16B6  742E              MOV     A,#46
   \   16B8  900008            MOV     DPTR,#8
   \   16BB  120000            LCALL   ?ST_A_R567_DISP_L17
   1005              str[9] = 'W';
   \   16BE  7457              MOV     A,#87
   \   16C0  900009            MOV     DPTR,#9
   \   16C3  120000            LCALL   ?ST_A_R567_DISP_L17
   1006              str[10] = 'A';
   \   16C6  7441              MOV     A,#65
   \   16C8  90000A            MOV     DPTR,#10
   \   16CB  120000            LCALL   ?ST_A_R567_DISP_L17
   1007              str[11] = 'W';
   \   16CE  7457              MOV     A,#87
   \   16D0  90000B            MOV     DPTR,#11
   \   16D3  120000            LCALL   ?ST_A_R567_DISP_L17
   1008              str[12] = 0x00;
   1009          
   \   16D6  E4                CLR     A
   \   16D7  90000C            MOV     DPTR,#12
   \   16DA  120000            LCALL   ?ST_A_R567_DISP_L17
   1010              order = '0';
   1011              str[7] = '0';
   \   16DD  7430              MOV     A,#48
   \   16DF  900007            MOV     DPTR,#7
   \   16E2  120000            LCALL   ?ST_A_R567_DISP_L17
   \   16E5  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+7
   \   16E8  F0                MOVX    @DPTR,A
   \   16E9            ?0464:
   1012              while (fp = fopen(str, "r")) {
   \   16E9  7402              MOV     A,#2
   \   16EB  900000            MOV     DPTR,#$PRMBX fopen+3
   \   16EE  F0                MOVX    @DPTR,A
   \   16EF  A3                INC     DPTR
   \   16F0  7401              MOV     A,#HIGH(?0172)
   \   16F2  F0                MOVX    @DPTR,A
   \   16F3  A3                INC     DPTR
   \   16F4  741D              MOV     A,#LOW(?0172)
   \   16F6  F0                MOVX    @DPTR,A
   \   16F7  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+14
   \   16FA  E0                MOVX    A,@DPTR
   \   16FB  FF                MOV     R7,A
   \   16FC  A3                INC     DPTR
   \   16FD  E0                MOVX    A,@DPTR
   \   16FE  FE                MOV     R6,A
   \   16FF  A3                INC     DPTR
   \   1700  E0                MOVX    A,@DPTR
   \   1701  FD                MOV     R5,A
   \   1702  120000            LCALL   $REFFN fopen
   \   1705  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+9
   \   1708  EF                MOV     A,R7
   \   1709  F0                MOVX    @DPTR,A
   \   170A  A3                INC     DPTR
   \   170B  EE                MOV     A,R6
   \   170C  F0                MOVX    @DPTR,A
   \   170D  A3                INC     DPTR
   \   170E  ED                MOV     A,R5
   \   170F  F0                MOVX    @DPTR,A
   \   1710  4E                ORL     A,R6
   \   1711  602F              JZ      ?0463
   \   1713            ?0465:
   1013                  fclose(fp);
   \   1713  120000            LCALL   $REFFN fclose
   1014                  order++;
   \   1716  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+7
   \   1719  E0                MOVX    A,@DPTR
   \   171A  04                INC     A
   \   171B  F0                MOVX    @DPTR,A
   1015                  if (order > '9') order = 'A';
   \   171C  E0                MOVX    A,@DPTR
   \   171D  24C6              ADD     A,#198
   \   171F  5003              JNC     ?0467
   \   1721            ?0466:
   \   1721  7441              MOV     A,#65
   \   1723  F0                MOVX    @DPTR,A
   \   1724            ?0467:
   1016                  if (order > 'Z') order = 'a';
   \   1724  E0                MOVX    A,@DPTR
   \   1725  24A5              ADD     A,#165
   \   1727  5003              JNC     ?0469
   \   1729            ?0468:
   \   1729  7461              MOV     A,#97
   \   172B  F0                MOVX    @DPTR,A
   \   172C            ?0469:
   1017                  str[7] = order;
   \   172C  E0                MOVX    A,@DPTR
   \   172D  FC                MOV     R4,A
   \   172E  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+14
   \   1731  E0                MOVX    A,@DPTR
   \   1732  FF                MOV     R7,A
   \   1733  A3                INC     DPTR
   \   1734  E0                MOVX    A,@DPTR
   \   1735  FE                MOV     R6,A
   \   1736  A3                INC     DPTR
   \   1737  E0                MOVX    A,@DPTR
   \   1738  FD                MOV     R5,A
   \   1739  EC                MOV     A,R4
   \   173A  900007            MOV     DPTR,#7
   \   173D  120000            LCALL   ?ST_A_R567_DISP_L17
   \   1740  80A7              SJMP    ?0464
   \   1742            ?0463:
   1018              }
   1019              if (error == EM_FILENOTEXISTS) error = 0x00;
   \   1742  900001            MOV     DPTR,#error+1
   \   1745  E0                MOVX    A,@DPTR
   \   1746  6411              XRL     A,#17
   \   1748  7004              JNZ     ?0559
   \   174A  900000            MOV     DPTR,#error
   \   174D  E0                MOVX    A,@DPTR
   \   174E            ?0559:
   \   174E  7007              JNZ     ?0471
   \   1750            ?0470:
   \   1750  900000            MOV     DPTR,#error
   \   1753  E4                CLR     A
   \   1754  F0                MOVX    @DPTR,A
   \   1755  A3                INC     DPTR
   \   1756  F0                MOVX    @DPTR,A
   \   1757            ?0471:
   1020          }
   \   1757  900000            MOV     DPTR,#$LOCBX CreateUniqueFilename+12
   \   175A  E0                MOVX    A,@DPTR
   \   175B  F8                MOV     R0,A
   \   175C  A3                INC     DPTR
   \   175D  E0                MOVX    A,@DPTR
   \   175E  C0E0              PUSH    ACC
   \   1760  E8                MOV     A,R0
   \   1761  C0E0              PUSH    ACC
   \   1763  22                RET
   1021          
   1022          
   1023          //-----------------------------------------
   1024          // Phone Book grejor
   1025          
   1026          void    ReadPhoneBookFile( void )
   1027          {
   \   1764            ReadPhoneBookFile:
   \   1764  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+10
   \   1767  D0E0              POP     ACC
   \   1769  F0                MOVX    @DPTR,A
   \   176A  A3                INC     DPTR
   \   176B  D0E0              POP     ACC
   \   176D  F0                MOVX    @DPTR,A
   1028              xdata FILE*     fp;
   1029              xdata int       i, j;
   1030              xdata char*     ptr;
   1031              
   1032              SendStringEOLRS232("Reading Phone book file..."); 
   \   176E  7DA0              MOV     R5,#LOW(?0472)
   \   1770  7E01              MOV     R6,#HIGH(?0472)
   \   1772  7F02              MOV     R7,#2
   \   1774  120000            LCALL   $REFFN SendStringEOLRS232
   1033              DispInfoBox("Reading Phone Book", "Please wait...");
   \   1777  7F02              MOV     R7,#2
   \   1779  900000            MOV     DPTR,#$PRMBX DispInfoBox+3
   \   177C  EF                MOV     A,R7
   \   177D  F0                MOVX    @DPTR,A
   \   177E  A3                INC     DPTR
   \   177F  7400              MOV     A,#HIGH(?0002)
   \   1781  F0                MOVX    @DPTR,A
   \   1782  A3                INC     DPTR
   \   1783  7430              MOV     A,#LOW(?0002)
   \   1785  F0                MOVX    @DPTR,A
   \   1786  7DBB              MOV     R5,#LOW(?0473)
   \   1788  7E01              MOV     R6,#HIGH(?0473)
   \   178A  120000            LCALL   $REFFN DispInfoBox
   1034              
   1035              ptr = PBSpace;
   \   178D  7F01              MOV     R7,#1
   \   178F  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+7
   \   1792  EF                MOV     A,R7
   \   1793  F0                MOVX    @DPTR,A
   \   1794  A3                INC     DPTR
   \   1795  7400              MOV     A,#HIGH(PBSpace)
   \   1797  F0                MOVX    @DPTR,A
   \   1798  A3                INC     DPTR
   \   1799  74A3              MOV     A,#LOW(PBSpace)
   \   179B  F0                MOVX    @DPTR,A
   1036              
   1037              fp = fopen("PB.tpb", "r");
   \   179C  0F                INC     R7
   \   179D  900000            MOV     DPTR,#$PRMBX fopen+3
   \   17A0  EF                MOV     A,R7
   \   17A1  F0                MOVX    @DPTR,A
   \   17A2  A3                INC     DPTR
   \   17A3  7401              MOV     A,#HIGH(?0172)
   \   17A5  F0                MOVX    @DPTR,A
   \   17A6  A3                INC     DPTR
   \   17A7  741D              MOV     A,#LOW(?0172)
   \   17A9  F0                MOVX    @DPTR,A
   \   17AA  7DCE              MOV     R5,#LOW(?0474)
   \   17AC  7E01              MOV     R6,#HIGH(?0474)
   \   17AE  120000            LCALL   $REFFN fopen
   1038              
   1039              if (fp) {
   \   17B1  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile
   \   17B4  EF                MOV     A,R7
   \   17B5  F0                MOVX    @DPTR,A
   \   17B6  A3                INC     DPTR
   \   17B7  EE                MOV     A,R6
   \   17B8  F0                MOVX    @DPTR,A
   \   17B9  A3                INC     DPTR
   \   17BA  ED                MOV     A,R5
   \   17BB  F0                MOVX    @DPTR,A
   \   17BC  4E                ORL     A,R6
   \   17BD  7003              JNZ     $+5
   \   17BF  0218A6            LJMP    ?0476
   \   17C2            ?0475:
   1040                  i = fgetc(fp);
   \   17C2  120000            LCALL   $REFFN fgetc
   1041                  pbNEntries = i * 256;
   \   17C5  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+3
   \   17C8  ED                MOV     A,R5
   \   17C9  F0                MOVX    @DPTR,A
   \   17CA  A3                INC     DPTR
   \   17CB  EC                MOV     A,R4
   \   17CC  F0                MOVX    @DPTR,A
   1042                  i = fgetc(fp);
   \   17CD  9040A3            MOV     DPTR,#pbNEntries
   \   17D0  F0                MOVX    @DPTR,A
   \   17D1  A3                INC     DPTR
   \   17D2  E4                CLR     A
   \   17D3  F0                MOVX    @DPTR,A
   \   17D4  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile
   \   17D7  E0                MOVX    A,@DPTR
   \   17D8  FF                MOV     R7,A
   \   17D9  A3                INC     DPTR
   \   17DA  E0                MOVX    A,@DPTR
   \   17DB  FE                MOV     R6,A
   \   17DC  A3                INC     DPTR
   \   17DD  E0                MOVX    A,@DPTR
   \   17DE  FD                MOV     R5,A
   \   17DF  120000            LCALL   $REFFN fgetc
   1043                  pbNEntries += i;
   \   17E2  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+3
   \   17E5  ED                MOV     A,R5
   \   17E6  F0                MOVX    @DPTR,A
   \   17E7  A3                INC     DPTR
   \   17E8  EC                MOV     A,R4
   \   17E9  F0                MOVX    @DPTR,A
   \   17EA  9040A4            MOV     DPTR,#pbNEntries+1
   \   17ED  E0                MOVX    A,@DPTR
   \   17EE  2C                ADD     A,R4
   \   17EF  F0                MOVX    @DPTR,A
   \   17F0  9040A3            MOV     DPTR,#pbNEntries
   \   17F3  E0                MOVX    A,@DPTR
   \   17F4  3D                ADDC    A,R5
   \   17F5  F0                MOVX    @DPTR,A
   1044                  if (pbNEntries > PB_MAXENTRIES) pbNEntries = PB_MAXENTRIES;
   \   17F6  D3                SETB    C
   \   17F7  A3                INC     DPTR
   \   17F8  E0                MOVX    A,@DPTR
   \   17F9  9400              SUBB    A,#0
   \   17FB  9040A3            MOV     DPTR,#pbNEntries
   \   17FE  E0                MOVX    A,@DPTR
   \   17FF  6480              XRL     A,#128
   \   1801  9482              SUBB    A,#130
   \   1803  4006              JC      ?0478
   \   1805            ?0477:
   \   1805  7402              MOV     A,#2
   \   1807  F0                MOVX    @DPTR,A
   \   1808  A3                INC     DPTR
   \   1809  E4                CLR     A
   \   180A  F0                MOVX    @DPTR,A
   \   180B            ?0478:
   1045                  for (i=0 ; i<pbNEntries ; i++) {
   \   180B  E4                CLR     A
   \   180C  FC                MOV     R4,A
   \   180D  FD                MOV     R5,A
   \   180E  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+3
   \   1811  F0                MOVX    @DPTR,A
   \   1812  A3                INC     DPTR
   \   1813  F0                MOVX    @DPTR,A
   \   1814            ?0480:
   \   1814  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+3
   \   1817  E0                MOVX    A,@DPTR
   \   1818  FD                MOV     R5,A
   \   1819  A3                INC     DPTR
   \   181A  E0                MOVX    A,@DPTR
   \   181B  FC                MOV     R4,A
   \   181C  9040A4            MOV     DPTR,#pbNEntries+1
   \   181F  E0                MOVX    A,@DPTR
   \   1820  D3                SETB    C
   \   1821  9C                SUBB    A,R4
   \   1822  9040A3            MOV     DPTR,#pbNEntries
   \   1825  E0                MOVX    A,@DPTR
   \   1826  6480              XRL     A,#128
   \   1828  CD                XCH     A,R5
   \   1829  6480              XRL     A,#128
   \   182B  CD                XCH     A,R5
   \   182C  9D                SUBB    A,R5
   \   182D  4067              JC      ?0479
   \   182F            ?0481:
   1046                      WDT = 1;
   \   182F  D2AE              SETB    IE.6
   1047                      SWDT = 1;
   \   1831  D2BE              SETB    IP.6
   1048                      for (j=0 ; j<PB_POSTSIZE ; j++) *(ptr++) = fgetc(fp);
   \   1833  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+5
   \   1836  E4                CLR     A
   \   1837  F0                MOVX    @DPTR,A
   \   1838  A3                INC     DPTR
   \   1839  F0                MOVX    @DPTR,A
   \   183A            ?0484:
   \   183A  C3                CLR     C
   \   183B  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+6
   \   183E  E0                MOVX    A,@DPTR
   \   183F  9420              SUBB    A,#32
   \   1841  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+5
   \   1844  E0                MOVX    A,@DPTR
   \   1845  6480              XRL     A,#128
   \   1847  9480              SUBB    A,#128
   \   1849  503A              JNC     ?0483
   \   184B            ?0485:
   \   184B  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile
   \   184E  E0                MOVX    A,@DPTR
   \   184F  FF                MOV     R7,A
   \   1850  A3                INC     DPTR
   \   1851  E0                MOVX    A,@DPTR
   \   1852  FE                MOV     R6,A
   \   1853  A3                INC     DPTR
   \   1854  E0                MOVX    A,@DPTR
   \   1855  FD                MOV     R5,A
   \   1856  120000            LCALL   $REFFN fgetc
   \   1859  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+7
   \   185C  E0                MOVX    A,@DPTR
   \   185D  FF                MOV     R7,A
   \   185E  A3                INC     DPTR
   \   185F  E0                MOVX    A,@DPTR
   \   1860  FE                MOV     R6,A
   \   1861  C083              PUSH    DPH
   \   1863  A3                INC     DPTR
   \   1864  E0                MOVX    A,@DPTR
   \   1865  FD                MOV     R5,A
   \   1866  04                INC     A
   \   1867  F0                MOVX    @DPTR,A
   \   1868  1582              DEC     DPL
   \   186A  D083              POP     DPH
   \   186C  7003              JNZ     ?0560
   \   186E  EE                MOV     A,R6
   \   186F  04                INC     A
   \   1870  F0                MOVX    @DPTR,A
   \   1871            ?0560:
   \   1871  EC                MOV     A,R4
   \   1872  120000            LCALL   ?ST_A_R567_L17
   \   1875  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+6
   \   1878  E0                MOVX    A,@DPTR
   \   1879  04                INC     A
   \   187A  F0                MOVX    @DPTR,A
   \   187B  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+5
   \   187E  7003              JNZ     ?0561
   \   1880  E0                MOVX    A,@DPTR
   \   1881  04                INC     A
   \   1882  F0                MOVX    @DPTR,A
   \   1883            ?0561:
   1049                  }
   \   1883  80B5              SJMP    ?0484
   \   1885            ?0483:
   \   1885  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+4
   \   1888  E0                MOVX    A,@DPTR
   \   1889  04                INC     A
   \   188A  F0                MOVX    @DPTR,A
   \   188B  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+3
   \   188E  7003              JNZ     ?0562
   \   1890  E0                MOVX    A,@DPTR
   \   1891  04                INC     A
   \   1892  F0                MOVX    @DPTR,A
   \   1893            ?0562:
   \   1893  021814            LJMP    ?0480
   \   1896            ?0479:
   1050                          fclose(fp);
   \   1896  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile
   \   1899  E0                MOVX    A,@DPTR
   \   189A  FF                MOV     R7,A
   \   189B  A3                INC     DPTR
   \   189C  E0                MOVX    A,@DPTR
   \   189D  FE                MOV     R6,A
   \   189E  A3                INC     DPTR
   \   189F  E0                MOVX    A,@DPTR
   \   18A0  FD                MOV     R5,A
   \   18A1  120000            LCALL   $REFFN fclose
   1051              } else {
   \   18A4  8007              SJMP    ?0487
   \   18A6            ?0476:
   1052                  pbNEntries = 0;
   \   18A6  9040A3            MOV     DPTR,#pbNEntries
   \   18A9  E4                CLR     A
   \   18AA  F0                MOVX    @DPTR,A
   \   18AB  A3                INC     DPTR
   \   18AC  F0                MOVX    @DPTR,A
   \   18AD            ?0487:
   1053              }
   1054          } 
   \   18AD  900000            MOV     DPTR,#$LOCBX ReadPhoneBookFile+10
   \   18B0  E0                MOVX    A,@DPTR
   \   18B1  F8                MOV     R0,A
   \   18B2  A3                INC     DPTR
   \   18B3  E0                MOVX    A,@DPTR
   \   18B4  C0E0              PUSH    ACC
   \   18B6  E8                MOV     A,R0
   \   18B7  C0E0              PUSH    ACC
   \   18B9  22                RET
   1055          
   1056          
   1057          void    LookUpCaller(char* number, char* name,  char* category)
   1058          {
   \   18BA            LookUpCaller:
   \   18BA  900000            MOV     DPTR,#$LOCBX LookUpCaller
   \   18BD  D0E0              POP     ACC
   \   18BF  F0                MOVX    @DPTR,A
   \   18C0  A3                INC     DPTR
   \   18C1  D0E0              POP     ACC
   \   18C3  F0                MOVX    @DPTR,A
   1059              idata char* ptr;
   1060              idata int   numberIndex;
   1061              idata char  match = 0;
   1062              idata char  c;
   1063              idata int   currentPost = 0;
   1064              
   1065              for (currentPost = 0 ; currentPost < pbNEntries ; currentPost++) {
   \   18C4  7800              MOV     R0,#$LOCBI LookUpCaller+5
   \   18C6  7600              MOV     @R0,#0
   \   18C8  08                INC     R0
   \   18C9  08                INC     R0
   \   18CA  E4                CLR     A
   \   18CB  F6                MOV     @R0,A
   \   18CC  08                INC     R0
   \   18CD  F6                MOV     @R0,A
   \   18CE  A3                INC     DPTR
   \   18CF  EF                MOV     A,R7
   \   18D0  F0                MOVX    @DPTR,A
   \   18D1  A3                INC     DPTR
   \   18D2  EE                MOV     A,R6
   \   18D3  F0                MOVX    @DPTR,A
   \   18D4  A3                INC     DPTR
   \   18D5  ED                MOV     A,R5
   \   18D6  F0                MOVX    @DPTR,A
   \   18D7            ?0489:
   \   18D7  7800              MOV     R0,#$LOCBI LookUpCaller+7
   \   18D9  E6                MOV     A,@R0
   \   18DA  FD                MOV     R5,A
   \   18DB  08                INC     R0
   \   18DC  E6                MOV     A,@R0
   \   18DD  FC                MOV     R4,A
   \   18DE  9040A4            MOV     DPTR,#pbNEntries+1
   \   18E1  E0                MOVX    A,@DPTR
   \   18E2  D3                SETB    C
   \   18E3  9C                SUBB    A,R4
   \   18E4  9040A3            MOV     DPTR,#pbNEntries
   \   18E7  E0                MOVX    A,@DPTR
   \   18E8  6480              XRL     A,#128
   \   18EA  CD                XCH     A,R5
   \   18EB  6480              XRL     A,#128
   \   18ED  CD                XCH     A,R5
   \   18EE  9D                SUBB    A,R5
   \   18EF  5003              JNC     $+5
   \   18F1  0219D1            LJMP    ?0488
   \   18F4            ?0490:
   1066                  ptr = PBSpace + currentPost * PB_POSTSIZE;
   \   18F4  18                DEC     R0
   \   18F5  E6                MOV     A,@R0
   \   18F6  FD                MOV     R5,A
   \   18F7  08                INC     R0
   \   18F8  E6                MOV     A,@R0
   \   18F9  7C05              MOV     R4,#5
   \   18FB            ?0563:
   \   18FB  25E0              ADD     A,ACC
   \   18FD  CD                XCH     A,R5
   \   18FE  33                RLC     A
   \   18FF  CD                XCH     A,R5
   \   1900  DCF9              DJNZ    R4,?0563
   \   1902  24A3              ADD     A,#LOW(PBSpace)
   \   1904  FC                MOV     R4,A
   \   1905  ED                MOV     A,R5
   \   1906  3400              ADDC    A,#HIGH(PBSpace)
   \   1908  FE                MOV     R6,A
   \   1909  EC                MOV     A,R4
   \   190A  FD                MOV     R5,A
   \   190B  7F01              MOV     R7,#1
   \   190D  7800              MOV     R0,#$LOCBI LookUpCaller
   \   190F  EF                MOV     A,R7
   \   1910  F6                MOV     @R0,A
   \   1911  08                INC     R0
   \   1912  EE                MOV     A,R6
   \   1913  F6                MOV     @R0,A
   \   1914  08                INC     R0
   \   1915  ED                MOV     A,R5
   \   1916  F6                MOV     @R0,A
   1067                  numberIndex = 0;
   \   1917  08                INC     R0
   \   1918  E4                CLR     A
   \   1919  F6                MOV     @R0,A
   \   191A  08                INC     R0
   \   191B  F6                MOV     @R0,A
   \   191C            ?0493:
   1068                  while (( (c = *(ptr++)) ==number[numberIndex++]) && (c != 0)) {
   \   191C  7800              MOV     R0,#$LOCBI LookUpCaller
   \   191E  E6                MOV     A,@R0
   \   191F  FF                MOV     R7,A
   \   1920  08                INC     R0
   \   1921  E6                MOV     A,@R0
   \   1922  FE                MOV     R6,A
   \   1923  08                INC     R0
   \   1924  E6                MOV     A,@R0
   \   1925  FD                MOV     R5,A
   \   1926  04                INC     A
   \   1927  F6                MOV     @R0,A
   \   1928  18                DEC     R0
   \   1929  7001              JNZ     ?0564
   \   192B  06                INC     @R0
   \   192C            ?0564:
   \   192C  120000            LCALL   ?LD_A_R567_L17
   \   192F  7800              MOV     R0,#$LOCBI LookUpCaller+6
   \   1931  F6                MOV     @R0,A
   \   1932  FC                MOV     R4,A
   \   1933  900000            MOV     DPTR,#$LOCBX LookUpCaller+2
   \   1936  E0                MOVX    A,@DPTR
   \   1937  FF                MOV     R7,A
   \   1938  A3                INC     DPTR
   \   1939  E0                MOVX    A,@DPTR
   \   193A  FE                MOV     R6,A
   \   193B  A3                INC     DPTR
   \   193C  E0                MOVX    A,@DPTR
   \   193D  FD                MOV     R5,A
   \   193E  7800              MOV     R0,#$LOCBI LookUpCaller+3
   \   1940  E6                MOV     A,@R0
   \   1941  FB                MOV     R3,A
   \   1942  08                INC     R0
   \   1943  E6                MOV     A,@R0
   \   1944  FA                MOV     R2,A
   \   1945  06                INC     @R0
   \   1946  E6                MOV     A,@R0
   \   1947  18                DEC     R0
   \   1948  7001              JNZ     ?0565
   \   194A  06                INC     @R0
   \   194B            ?0565:
   \   194B  8A82              MOV     DPL,R2
   \   194D  8B83              MOV     DPH,R3
   \   194F  120000            LCALL   ?LD_A_R567_DISP_L17
   \   1952  6C                XRL     A,R4
   \   1953  7009              JNZ     ?0492
   \   1955  EC                MOV     A,R4
   \   1956  6006              JZ      ?0492
   \   1958            ?0496:
   \   1958            ?0495:
   \   1958            ?0494:
   1069                      WDT = 1;
   \   1958  D2AE              SETB    IE.6
   1070                      SWDT = 1;
   \   195A  D2BE              SETB    IP.6
   \   195C  80BE              SJMP    ?0493
   \   195E            ?0492:
   1071                  }
   1072                  if ((c == 0) && (number[numberIndex-1] == 0)) {
   \   195E  EC                MOV     A,R4
   \   195F  7065              JNZ     ?0498
   \   1961  7800              MOV     R0,#$LOCBI LookUpCaller+4
   \   1963  ED                MOV     A,R5
   \   1964  26                ADD     A,@R0
   \   1965  FD                MOV     R5,A
   \   1966  EE                MOV     A,R6
   \   1967  18                DEC     R0
   \   1968  36                ADDC    A,@R0
   \   1969  FE                MOV     R6,A
   \   196A  90FFFF            MOV     DPTR,#65535
   \   196D  120000            LCALL   ?LD_A_R567_DISP_L17
   \   1970  7054              JNZ     ?0498
   \   1972            ?0500:
   \   1972            ?0499:
   \   1972            ?0497:
   \   1972            ?0503:
   1073                      do {              
   1074                          c = *(ptr++);
   \   1972  7800              MOV     R0,#$LOCBI LookUpCaller
   \   1974  E6                MOV     A,@R0
   \   1975  FF                MOV     R7,A
   \   1976  08                INC     R0
   \   1977  E6                MOV     A,@R0
   \   1978  FE                MOV     R6,A
   \   1979  08                INC     R0
   \   197A  E6                MOV     A,@R0
   \   197B  FD                MOV     R5,A
   \   197C  04                INC     A
   \   197D  F6                MOV     @R0,A
   \   197E  18                DEC     R0
   \   197F  7001              JNZ     ?0566
   \   1981  06                INC     @R0
   \   1982            ?0566:
   \   1982  120000            LCALL   ?LD_A_R567_L17
   1075                          *(name++) = c;
   \   1985  FC                MOV     R4,A
   \   1986  900000            MOV     DPTR,#$LOCBX LookUpCaller+5
   \   1989  E0                MOVX    A,@DPTR
   \   198A  FF                MOV     R7,A
   \   198B  A3                INC     DPTR
   \   198C  E0                MOVX    A,@DPTR
   \   198D  FE                MOV     R6,A
   \   198E  C083              PUSH    DPH
   \   1990  A3                INC     DPTR
   \   1991  E0                MOVX    A,@DPTR
   \   1992  FD                MOV     R5,A
   \   1993  04                INC     A
   \   1994  F0                MOVX    @DPTR,A
   \   1995  1582              DEC     DPL
   \   1997  D083              POP     DPH
   \   1999  7003              JNZ     ?0567
   \   199B  EE                MOV     A,R6
   \   199C  04                INC     A
   \   199D  F0                MOVX    @DPTR,A
   \   199E            ?0567:
   \   199E  EC                MOV     A,R4
   \   199F  120000            LCALL   ?ST_A_R567_L17
   1076                      } while (c != 0);
   \   19A2  7800              MOV     R0,#$LOCBI LookUpCaller+6
   \   19A4  F6                MOV     @R0,A
   \   19A5  70CB              JNZ     ?0503
   \   19A7            ?0501:
   1077                      *category = *ptr;
   \   19A7  7800              MOV     R0,#$LOCBI LookUpCaller
   \   19A9  E6                MOV     A,@R0
   \   19AA  FF                MOV     R7,A
   \   19AB  08                INC     R0
   \   19AC  E6                MOV     A,@R0
   \   19AD  FE                MOV     R6,A
   \   19AE  08                INC     R0
   \   19AF  E6                MOV     A,@R0
   \   19B0  FD                MOV     R5,A
   \   19B1  120000            LCALL   ?LD_A_R567_L17
   \   19B4  FC                MOV     R4,A
   \   19B5  900000            MOV     DPTR,#$LOCBX LookUpCaller+8
   \   19B8  E0                MOVX    A,@DPTR
   \   19B9  FF                MOV     R7,A
   \   19BA  A3                INC     DPTR
   \   19BB  E0                MOVX    A,@DPTR
   \   19BC  FE                MOV     R6,A
   \   19BD  A3                INC     DPTR
   \   19BE  E0                MOVX    A,@DPTR
   \   19BF  FD                MOV     R5,A
   \   19C0  EC                MOV     A,R4
   \   19C1  120000            LCALL   ?ST_A_R567_L17
   1078                      return;
   1079                  }
   \   19C4  8036              SJMP    ?0504
   \   19C6            ?0498:
   \   19C6  7800              MOV     R0,#$LOCBI LookUpCaller+8
   \   19C8  06                INC     @R0
   \   19C9  E6                MOV     A,@R0
   \   19CA  18                DEC     R0
   \   19CB  7001              JNZ     ?0568
   \   19CD  06                INC     @R0
   \   19CE            ?0568:
   \   19CE  0218D7            LJMP    ?0489
   \   19D1            ?0488:
   1080              }
   1081              strcpy(name, number);
   \   19D1  900000            MOV     DPTR,#$LOCBX LookUpCaller+5
   \   19D4  E0                MOVX    A,@DPTR
   \   19D5  FF                MOV     R7,A
   \   19D6  A3                INC     DPTR
   \   19D7  E0                MOVX    A,@DPTR
   \   19D8  FE                MOV     R6,A
   \   19D9  A3                INC     DPTR
   \   19DA  E0                MOVX    A,@DPTR
   \   19DB  FD                MOV     R5,A
   \   19DC  900000            MOV     DPTR,#$LOCBX LookUpCaller+2
   \   19DF  E0                MOVX    A,@DPTR
   \   19E0  FB                MOV     R3,A
   \   19E1  A3                INC     DPTR
   \   19E2  E0                MOVX    A,@DPTR
   \   19E3  FA                MOV     R2,A
   \   19E4  A3                INC     DPTR
   \   19E5  E0                MOVX    A,@DPTR
   \   19E6  F9                MOV     R1,A
   \   19E7  75F003            MOV     B,#3
   \   19EA  120000            LCALL   ?BYTE_COPY_L08
   1082              *category = 0;
   1083              return;
   \   19ED  900000            MOV     DPTR,#$LOCBX LookUpCaller+8
   \   19F0  E0                MOVX    A,@DPTR
   \   19F1  FF                MOV     R7,A
   \   19F2  A3                INC     DPTR
   \   19F3  E0                MOVX    A,@DPTR
   \   19F4  FE                MOV     R6,A
   \   19F5  A3                INC     DPTR
   \   19F6  E0                MOVX    A,@DPTR
   \   19F7  FD                MOV     R5,A
   \   19F8  E4                CLR     A
   \   19F9  120000            LCALL   ?ST_A_R567_L17
   1084          }
   \   19FC            ?0504:
   \   19FC  900000            MOV     DPTR,#$LOCBX LookUpCaller
   \   19FF  E0                MOVX    A,@DPTR
   \   1A00  F8                MOV     R0,A
   \   1A01  A3                INC     DPTR
   \   1A02  E0                MOVX    A,@DPTR
   \   1A03  C0E0              PUSH    ACC
   \   1A05  E8                MOV     A,R0
   \   1A06  C0E0              PUSH    ACC
   \   1A08  22                RET
   1085                          
   1086          
   1087          
   1088          
   1089          
   1090          char    CategoryHit(char* str, char category)
   1091          //OBS: Hoppar inte till label, kollar bara om category finns i den tolkade strängen "str"
   1092          {
   \   1A09            CategoryHit:
   \   1A09  900000            MOV     DPTR,#$LOCBX CategoryHit+15
   \   1A0C  D0E0              POP     ACC
   \   1A0E  F0                MOVX    @DPTR,A
   \   1A0F  A3                INC     DPTR
   \   1A10  D0E0              POP     ACC
   \   1A12  F0                MOVX    @DPTR,A
   1093              xdata char  tmpStr[5];
   1094              xdata int   rangeStart;
   1095              xdata int   rangeEnd;
   1096              xdata char  c;
   1097              xdata int   i = 0;  //Index i strängen som skall tolkas
   1098              xdata int   j = 0;  //Index i den tilfälliga värdes-strängen (tmpStr)
   1099              xdata char  categoryHit = 0;
   1100              
   1101              tmpStr[0] = 0;      //Termineringsnolla
   \   1A13  E4                CLR     A
   \   1A14  900000            MOV     DPTR,#$LOCBX CategoryHit
   \   1A17  F0                MOVX    @DPTR,A
   1102              
   1103              rangeStart = -1;    //Indikerar ingen "range" (x-y) på lut
   \   1A18  900000            MOV     DPTR,#$LOCBX CategoryHit+10
   \   1A1B  F0                MOVX    @DPTR,A
   \   1A1C  A3                INC     DPTR
   \   1A1D  F0                MOVX    @DPTR,A
   \   1A1E  A3                INC     DPTR
   \   1A1F  F0                MOVX    @DPTR,A
   \   1A20  A3                INC     DPTR
   \   1A21  F0                MOVX    @DPTR,A
   \   1A22  A3                INC     DPTR
   \   1A23  F0                MOVX    @DPTR,A
   \   1A24  900000            MOV     DPTR,#$LOCBX CategoryHit+5
   \   1A27  14                DEC     A
   \   1A28  F0                MOVX    @DPTR,A
   \   1A29  A3                INC     DPTR
   \   1A2A  F0                MOVX    @DPTR,A
   \   1A2B  EC                MOV     A,R4
   \   1A2C  900000            MOV     DPTR,#$LOCBX CategoryHit+20
   \   1A2F  F0                MOVX    @DPTR,A
   \   1A30  900000            MOV     DPTR,#$LOCBX CategoryHit+17
   \   1A33  EF                MOV     A,R7
   \   1A34  F0                MOVX    @DPTR,A
   \   1A35  A3                INC     DPTR
   \   1A36  EE                MOV     A,R6
   \   1A37  F0                MOVX    @DPTR,A
   \   1A38  A3                INC     DPTR
   \   1A39  ED                MOV     A,R5
   \   1A3A  F0                MOVX    @DPTR,A
   \   1A3B            ?0507:
   1104          
   1105          //    SendStringEOLRS232("Checking this string:"); 
   1106          //    SendStringEOLRS232(str); 
   1107          
   1108              do {
   1109                  WDT = 1;
   \   1A3B  D2AE              SETB    IE.6
   1110                  SWDT = 1;
   \   1A3D  D2BE              SETB    IP.6
   1111                  c = str[i++];
   \   1A3F  900000            MOV     DPTR,#$LOCBX CategoryHit+17
   \   1A42  E0                MOVX    A,@DPTR
   \   1A43  FF                MOV     R7,A
   \   1A44  A3                INC     DPTR
   \   1A45  E0                MOVX    A,@DPTR
   \   1A46  FE                MOV     R6,A
   \   1A47  A3                INC     DPTR
   \   1A48  E0                MOVX    A,@DPTR
   \   1A49  FD                MOV     R5,A
   \   1A4A  900000            MOV     DPTR,#$LOCBX CategoryHit+10
   \   1A4D  E0                MOVX    A,@DPTR
   \   1A4E  FB                MOV     R3,A
   \   1A4F  A3                INC     DPTR
   \   1A50  E0                MOVX    A,@DPTR
   \   1A51  FA                MOV     R2,A
   \   1A52  E0                MOVX    A,@DPTR
   \   1A53  04                INC     A
   \   1A54  F0                MOVX    @DPTR,A
   \   1A55  900000            MOV     DPTR,#$LOCBX CategoryHit+10
   \   1A58  7003              JNZ     ?0569
   \   1A5A  E0                MOVX    A,@DPTR
   \   1A5B  04                INC     A
   \   1A5C  F0                MOVX    @DPTR,A
   \   1A5D            ?0569:
   \   1A5D  8A82              MOV     DPL,R2
   \   1A5F  8B83              MOV     DPH,R3
   \   1A61  120000            LCALL   ?LD_A_R567_DISP_L17
   1112          //              SendRS232(c); 
   1113                  if ((c == ',') || (c == 0)) {
   \   1A64  900000            MOV     DPTR,#$LOCBX CategoryHit+9
   \   1A67  F0                MOVX    @DPTR,A
   \   1A68  642C              XRL     A,#44
   \   1A6A  6006              JZ      ?0508
   \   1A6C  E0                MOVX    A,@DPTR
   \   1A6D  6003              JZ      $+5
   \   1A6F  021AF3            LJMP    ?0509
   \   1A72            ?0510:
   \   1A72            ?0511:
   \   1A72            ?0508:
   1114                      if (rangeStart != -1) {
   \   1A72  900000            MOV     DPTR,#$LOCBX CategoryHit+6
   \   1A75  E0                MOVX    A,@DPTR
   \   1A76  04                INC     A
   \   1A77  7007              JNZ     ?0570
   \   1A79  900000            MOV     DPTR,#$LOCBX CategoryHit+5
   \   1A7C  E0                MOVX    A,@DPTR
   \   1A7D  04                INC     A
   \   1A7E  6048              JZ      ?0513
   \   1A80            ?0570:
   \   1A80            ?0512:
   1115                          rangeEnd = myStr2Int(tmpStr);
   \   1A80  7D00              MOV     R5,#LOW $LOCBX CategoryHit
   \   1A82  7E00              MOV     R6,#HIGH $LOCBX CategoryHit
   \   1A84  7F01              MOV     R7,#1
   \   1A86  120000            LCALL   $REFFN myStr2Int
   \   1A89  900000            MOV     DPTR,#$LOCBX CategoryHit+7
   \   1A8C  ED                MOV     A,R5
   \   1A8D  F0                MOVX    @DPTR,A
   \   1A8E  A3                INC     DPTR
   \   1A8F  EC                MOV     A,R4
   \   1A90  F0                MOVX    @DPTR,A
   1116                          if ((category >= rangeStart) && (category <= rangeEnd)) {
   \   1A91  900000            MOV     DPTR,#$LOCBX CategoryHit+20
   \   1A94  E0                MOVX    A,@DPTR
   \   1A95  7D00              MOV     R5,#0
   \   1A97  FC                MOV     R4,A
   \   1A98  900000            MOV     DPTR,#$LOCBX CategoryHit+6
   \   1A9B  E0                MOVX    A,@DPTR
   \   1A9C  D3                SETB    C
   \   1A9D  9C                SUBB    A,R4
   \   1A9E  900000            MOV     DPTR,#$LOCBX CategoryHit+5
   \   1AA1  E0                MOVX    A,@DPTR
   \   1AA2  6480              XRL     A,#128
   \   1AA4  CD                XCH     A,R5
   \   1AA5  6480              XRL     A,#128
   \   1AA7  CD                XCH     A,R5
   \   1AA8  9D                SUBB    A,R5
   \   1AA9  501B              JNC     ?0515
   \   1AAB  7D00              MOV     R5,#0
   \   1AAD  900000            MOV     DPTR,#$LOCBX CategoryHit+8
   \   1AB0  E0                MOVX    A,@DPTR
   \   1AB1  C3                CLR     C
   \   1AB2  9C                SUBB    A,R4
   \   1AB3  900000            MOV     DPTR,#$LOCBX CategoryHit+7
   \   1AB6  E0                MOVX    A,@DPTR
   \   1AB7  6480              XRL     A,#128
   \   1AB9  CD                XCH     A,R5
   \   1ABA  6480              XRL     A,#128
   \   1ABC  CD                XCH     A,R5
   \   1ABD  9D                SUBB    A,R5
   \   1ABE  4006              JC      ?0515
   \   1AC0            ?0517:
   \   1AC0            ?0516:
   \   1AC0            ?0514:
   1117                              categoryHit = 1;
   \   1AC0  7401              MOV     A,#1
   \   1AC2  900000            MOV     DPTR,#$LOCBX CategoryHit+14
   \   1AC5  F0                MOVX    @DPTR,A
   \   1AC6            ?0515:
   1118                          }
   1119                      } else {
   \   1AC6  801E              SJMP    ?0518
   \   1AC8            ?0513:
   1120                          if (category == myStr2Int(tmpStr)) categoryHit = 1;
   \   1AC8  7D00              MOV     R5,#LOW $LOCBX CategoryHit
   \   1ACA  7E00              MOV     R6,#HIGH $LOCBX CategoryHit
   \   1ACC  7F01              MOV     R7,#1
   \   1ACE  120000            LCALL   $REFFN myStr2Int
   \   1AD1  900000            MOV     DPTR,#$LOCBX CategoryHit+20
   \   1AD4  E0                MOVX    A,@DPTR
   \   1AD5  7F00              MOV     R7,#0
   \   1AD7  FE                MOV     R6,A
   \   1AD8  EC                MOV     A,R4
   \   1AD9  6E                XRL     A,R6
   \   1ADA  7002              JNZ     ?0571
   \   1ADC  ED                MOV     A,R5
   \   1ADD  6F                XRL     A,R7
   \   1ADE            ?0571:
   \   1ADE  7006              JNZ     ?0520
   \   1AE0            ?0519:
   \   1AE0  7401              MOV     A,#1
   \   1AE2  900000            MOV     DPTR,#$LOCBX CategoryHit+14
   \   1AE5  F0                MOVX    @DPTR,A
   \   1AE6            ?0520:
   \   1AE6            ?0518:
   1121                      }
   1122                      tmpStr[0] = 0;
   \   1AE6  E4                CLR     A
   \   1AE7  900000            MOV     DPTR,#$LOCBX CategoryHit
   \   1AEA  F0                MOVX    @DPTR,A
   1123                      j = 0;
   \   1AEB  900000            MOV     DPTR,#$LOCBX CategoryHit+12
   \   1AEE  F0                MOVX    @DPTR,A
   \   1AEF  A3                INC     DPTR
   \   1AF0  F0                MOVX    @DPTR,A
   \   1AF1  805A              SJMP    ?0521
   \   1AF3            ?0509:
   1124                  } else if (c == '-') {
   \   1AF3  B42D1E            CJNE    A,#45,?0523
   \   1AF6            ?0522:
   1125                      rangeStart = myStr2Int(tmpStr);
   \   1AF6  7D00              MOV     R5,#LOW $LOCBX CategoryHit
   \   1AF8  7E00              MOV     R6,#HIGH $LOCBX CategoryHit
   \   1AFA  7F01              MOV     R7,#1
   \   1AFC  120000            LCALL   $REFFN myStr2Int
   \   1AFF  900000            MOV     DPTR,#$LOCBX CategoryHit+5
   \   1B02  ED                MOV     A,R5
   \   1B03  F0                MOVX    @DPTR,A
   \   1B04  A3                INC     DPTR
   \   1B05  EC                MOV     A,R4
   \   1B06  F0                MOVX    @DPTR,A
   1126                      tmpStr[0] = 0;
   \   1B07  E4                CLR     A
   \   1B08  900000            MOV     DPTR,#$LOCBX CategoryHit
   \   1B0B  F0                MOVX    @DPTR,A
   1127                      j = 0;
   \   1B0C  900000            MOV     DPTR,#$LOCBX CategoryHit+12
   \   1B0F  F0                MOVX    @DPTR,A
   \   1B10  A3                INC     DPTR
   \   1B11  F0                MOVX    @DPTR,A
   \   1B12  8039              SJMP    ?0524
   \   1B14            ?0523:
   1128                  } else if ((c >= '0') && (c <= '9')) {
   \   1B14  24D0              ADD     A,#208
   \   1B16  5035              JNC     ?0526
   \   1B18  E0                MOVX    A,@DPTR
   \   1B19  24C6              ADD     A,#198
   \   1B1B  4030              JC      ?0526
   \   1B1D            ?0528:
   \   1B1D            ?0527:
   \   1B1D            ?0525:
   1129                      tmpStr[j++] = c;
   \   1B1D  E0                MOVX    A,@DPTR
   \   1B1E  900000            MOV     DPTR,#$LOCBX CategoryHit+12
   \   1B21  FE                MOV     R6,A
   \   1B22  E0                MOVX    A,@DPTR
   \   1B23  FD                MOV     R5,A
   \   1B24  A3                INC     DPTR
   \   1B25  E0                MOVX    A,@DPTR
   \   1B26  FC                MOV     R4,A
   \   1B27  E0                MOVX    A,@DPTR
   \   1B28  04                INC     A
   \   1B29  F0                MOVX    @DPTR,A
   \   1B2A  900000            MOV     DPTR,#$LOCBX CategoryHit+12
   \   1B2D  7003              JNZ     ?0572
   \   1B2F  E0                MOVX    A,@DPTR
   \   1B30  04                INC     A
   \   1B31  F0                MOVX    @DPTR,A
   \   1B32            ?0572:
   \   1B32  EC                MOV     A,R4
   \   1B33  2400              ADD     A,#LOW $LOCBX CategoryHit
   \   1B35  F582              MOV     DPL,A
   \   1B37  E4                CLR     A
   \   1B38  3400              ADDC    A,#HIGH $LOCBX CategoryHit
   \   1B3A  F583              MOV     DPH,A
   \   1B3C  EE                MOV     A,R6
   \   1B3D  F0                MOVX    @DPTR,A
   1130                      tmpStr[j] = 0;
   \   1B3E  900000            MOV     DPTR,#$LOCBX CategoryHit+13
   \   1B41  E0                MOVX    A,@DPTR
   \   1B42  2400              ADD     A,#LOW $LOCBX CategoryHit
   \   1B44  F582              MOV     DPL,A
   \   1B46  E4                CLR     A
   \   1B47  3400              ADDC    A,#HIGH $LOCBX CategoryHit
   \   1B49  F583              MOV     DPH,A
   \   1B4B  E4                CLR     A
   \   1B4C  F0                MOVX    @DPTR,A
   \   1B4D            ?0526:
   \   1B4D            ?0524:
   \   1B4D            ?0521:
   1131                  }
   1132              } while ((c != 0) && (!categoryHit));
   \   1B4D  900000            MOV     DPTR,#$LOCBX CategoryHit+9
   \   1B50  E0                MOVX    A,@DPTR
   \   1B51  6009              JZ      ?0505
   \   1B53  900000            MOV     DPTR,#$LOCBX CategoryHit+14
   \   1B56  E0                MOVX    A,@DPTR
   \   1B57  7003              JNZ     $+5
   \   1B59  021A3B            LJMP    ?0507
   \   1B5C            ?0505:
   1133          
   1134          //      if (categoryHit)        SendStringEOLRS232("Category hit"); 
   1135          //      else                            SendStringEOLRS232("Category miss"); 
   1136          
   1137              return categoryHit;
   \   1B5C  900000            MOV     DPTR,#$LOCBX CategoryHit+14
   \   1B5F  E0                MOVX    A,@DPTR
   \   1B60  FC                MOV     R4,A
   1138          }
   \   1B61  900000            MOV     DPTR,#$LOCBX CategoryHit+15
   \   1B64  E0                MOVX    A,@DPTR
   \   1B65  F8                MOV     R0,A
   \   1B66  A3                INC     DPTR
   \   1B67  E0                MOVX    A,@DPTR
   \   1B68  C0E0              PUSH    ACC
   \   1B6A  E8                MOV     A,R0
   \   1B6B  C0E0              PUSH    ACC
   \   1B6D  22                RET
   1139          
   1140          //-----------------------------------------------------------------------
   1141          //Memo fil grejor:
   1142          
   1143          
   1144          void    IntitializeMemo( void )
   1145          //OBS: Kräver att antal memo max är 255
   1146          {
   \   1B6E            IntitializeMemo:
   \   1B6E  900000            MOV     DPTR,#$LOCBX IntitializeMemo+19
   \   1B71  D0E0              POP     ACC
   \   1B73  F0                MOVX    @DPTR,A
   \   1B74  A3                INC     DPTR
   \   1B75  D0E0              POP     ACC
   \   1B77  F0                MOVX    @DPTR,A
   1147              xdata char  fileStr[15];
   1148              xdata char  found = 0;
   1149              xdata FILE* fp;
   1150          
   1151              nextMemoIndex = 0;
   \   1B78  900006            MOV     DPTR,#nextMemoIndex
   \   1B7B  E4                CLR     A
   \   1B7C  F0                MOVX    @DPTR,A
   \   1B7D  A3                INC     DPTR
   \   1B7E  F0                MOVX    @DPTR,A
   \   1B7F  900000            MOV     DPTR,#$LOCBX IntitializeMemo+15
   \   1B82  F0                MOVX    @DPTR,A
   \   1B83            ?0532:
   1152          
   1153              while ((!found) && (nextMemoIndex < 256)) {
   \   1B83  900000            MOV     DPTR,#$LOCBX IntitializeMemo+15
   \   1B86  E0                MOVX    A,@DPTR
   \   1B87  7068              JNZ     ?0531
   \   1B89  900006            MOV     DPTR,#nextMemoIndex
   \   1B8C  E0                MOVX    A,@DPTR
   \   1B8D  6480              XRL     A,#128
   \   1B8F  C3                CLR     C
   \   1B90  9481              SUBB    A,#129
   \   1B92  505D              JNC     ?0531
   \   1B94            ?0535:
   \   1B94            ?0534:
   \   1B94            ?0533:
   1154                  WDT = 1;
   \   1B94  D2AE              SETB    IE.6
   1155                  SWDT = 1;
   \   1B96  D2BE              SETB    IP.6
   1156                  CreateMemoFileName(nextMemoIndex, fileStr);
   \   1B98  7401              MOV     A,#1
   \   1B9A  900000            MOV     DPTR,#$PRMBX CreateMemoFileName+2
   \   1B9D  F0                MOVX    @DPTR,A
   \   1B9E  A3                INC     DPTR
   \   1B9F  7400              MOV     A,#HIGH $LOCBX IntitializeMemo
   \   1BA1  F0                MOVX    @DPTR,A
   \   1BA2  A3                INC     DPTR
   \   1BA3  7400              MOV     A,#LOW $LOCBX IntitializeMemo
   \   1BA5  F0                MOVX    @DPTR,A
   \   1BA6  900006            MOV     DPTR,#nextMemoIndex
   \   1BA9  E0                MOVX    A,@DPTR
   \   1BAA  FD                MOV     R5,A
   \   1BAB  A3                INC     DPTR
   \   1BAC  E0                MOVX    A,@DPTR
   \   1BAD  FC                MOV     R4,A
   \   1BAE  120000            LCALL   $REFFN CreateMemoFileName
   1157                  fp = fopen(fileStr, "r");
   \   1BB1  7F02              MOV     R7,#2
   \   1BB3  900000            MOV     DPTR,#$PRMBX fopen+3
   \   1BB6  EF                MOV     A,R7
   \   1BB7  F0                MOVX    @DPTR,A
   \   1BB8  A3                INC     DPTR
   \   1BB9  7401              MOV     A,#HIGH(?0172)
   \   1BBB  F0                MOVX    @DPTR,A
   \   1BBC  A3                INC     DPTR
   \   1BBD  741D              MOV     A,#LOW(?0172)
   \   1BBF  F0                MOVX    @DPTR,A
   \   1BC0  7D00              MOV     R5,#LOW $LOCBX IntitializeMemo
   \   1BC2  7E00              MOV     R6,#HIGH $LOCBX IntitializeMemo
   \   1BC4  1F                DEC     R7
   \   1BC5  120000            LCALL   $REFFN fopen
   1158                  if (fp) {
   \   1BC8  900000            MOV     DPTR,#$LOCBX IntitializeMemo+16
   \   1BCB  EF                MOV     A,R7
   \   1BCC  F0                MOVX    @DPTR,A
   \   1BCD  A3                INC     DPTR
   \   1BCE  EE                MOV     A,R6
   \   1BCF  F0                MOVX    @DPTR,A
   \   1BD0  A3                INC     DPTR
   \   1BD1  ED                MOV     A,R5
   \   1BD2  F0                MOVX    @DPTR,A
   \   1BD3  4E                ORL     A,R6
   \   1BD4  6013              JZ      ?0537
   \   1BD6            ?0536:
   1159                      nextMemoIndex++;
   \   1BD6  900007            MOV     DPTR,#nextMemoIndex+1
   \   1BD9  E0                MOVX    A,@DPTR
   \   1BDA  04                INC     A
   \   1BDB  F0                MOVX    @DPTR,A
   \   1BDC  900006            MOV     DPTR,#nextMemoIndex
   \   1BDF  7003              JNZ     ?0573
   \   1BE1  E0                MOVX    A,@DPTR
   \   1BE2  04                INC     A
   \   1BE3  F0                MOVX    @DPTR,A
   \   1BE4            ?0573:
   1160                      fclose(fp);
   \   1BE4  120000            LCALL   $REFFN fclose
   1161                  } else {
   \   1BE7  8006              SJMP    ?0538
   \   1BE9            ?0537:
   1162                      found = 1;
   \   1BE9  7401              MOV     A,#1
   \   1BEB  900000            MOV     DPTR,#$LOCBX IntitializeMemo+15
   \   1BEE  F0                MOVX    @DPTR,A
   \   1BEF            ?0538:
   1163                  }
   1164              }
   1165          }
   \   1BEF  8092              SJMP    ?0532
   \   1BF1            ?0531:
   \   1BF1  900000            MOV     DPTR,#$LOCBX IntitializeMemo+19
   \   1BF4  E0                MOVX    A,@DPTR
   \   1BF5  F8                MOV     R0,A
   \   1BF6  A3                INC     DPTR
   \   1BF7  E0                MOVX    A,@DPTR
   \   1BF8  C0E0              PUSH    ACC
   \   1BFA  E8                MOV     A,R0
   \   1BFB  C0E0              PUSH    ACC
   \   1BFD  22                RET
   1166          
   1167          
   1168          void    RecordMemo( void )
   1169          //OBS: Funkar bäst om det finns ett ljud som heter "tone.waw". Annars
   1170          //går inspelningen ingång direkt efter knapptryckningen.
   1171          {
   \   1BFE            RecordMemo:
   \   1BFE  900000            MOV     DPTR,#$LOCBX RecordMemo+15
   \   1C01  D0E0              POP     ACC
   \   1C03  F0                MOVX    @DPTR,A
   \   1C04  A3                INC     DPTR
   \   1C05  D0E0              POP     ACC
   \   1C07  F0                MOVX    @DPTR,A
   1172              xdata char memoName[15];
   1173           
   1174              WDT = 1;
   \   1C08  D2AE              SETB    IE.6
   1175              SWDT = 1;
   \   1C0A  D2BE              SETB    IP.6
   1176              if (nextMemoIndex < 256) {    
   \   1C0C  900006            MOV     DPTR,#nextMemoIndex
   \   1C0F  E0                MOVX    A,@DPTR
   \   1C10  6480              XRL     A,#128
   \   1C12  C3                CLR     C
   \   1C13  9481              SUBB    A,#129
   \   1C15  506F              JNC     ?0540
   \   1C17            ?0539:
   1177                  CreateMemoFileName(nextMemoIndex++, memoName);
   \   1C17  7E00              MOV     R6,#HIGH $LOCBX RecordMemo
   \   1C19  7F01              MOV     R7,#1
   \   1C1B  900000            MOV     DPTR,#$PRMBX CreateMemoFileName+2
   \   1C1E  EF                MOV     A,R7
   \   1C1F  F0                MOVX    @DPTR,A
   \   1C20  A3                INC     DPTR
   \   1C21  EE                MOV     A,R6
   \   1C22  F0                MOVX    @DPTR,A
   \   1C23  A3                INC     DPTR
   \   1C24  7400              MOV     A,#LOW $LOCBX RecordMemo
   \   1C26  F0                MOVX    @DPTR,A
   \   1C27  900006            MOV     DPTR,#nextMemoIndex
   \   1C2A  E0                MOVX    A,@DPTR
   \   1C2B  FD                MOV     R5,A
   \   1C2C  A3                INC     DPTR
   \   1C2D  E0                MOVX    A,@DPTR
   \   1C2E  FC                MOV     R4,A
   \   1C2F  E0                MOVX    A,@DPTR
   \   1C30  04                INC     A
   \   1C31  F0                MOVX    @DPTR,A
   \   1C32  900006            MOV     DPTR,#nextMemoIndex
   \   1C35  7003              JNZ     ?0574
   \   1C37  E0                MOVX    A,@DPTR
   \   1C38  04                INC     A
   \   1C39  F0                MOVX    @DPTR,A
   \   1C3A            ?0574:
   \   1C3A  120000            LCALL   $REFFN CreateMemoFileName
   1178                  DispInfoBox("Now recording:", memoName);
   \   1C3D  7F01              MOV     R7,#1
   \   1C3F  900000            MOV     DPTR,#$PRMBX DispInfoBox+3
   \   1C42  EF                MOV     A,R7
   \   1C43  F0                MOVX    @DPTR,A
   \   1C44  A3                INC     DPTR
   \   1C45  7400              MOV     A,#HIGH $LOCBX RecordMemo
   \   1C47  F0                MOVX    @DPTR,A
   \   1C48  A3                INC     DPTR
   \   1C49  7400              MOV     A,#LOW $LOCBX RecordMemo
   \   1C4B  F0                MOVX    @DPTR,A
   \   1C4C  7DD5              MOV     R5,#LOW(?0541)
   \   1C4E  7E01              MOV     R6,#HIGH(?0541)
   \   1C50  0F                INC     R7
   \   1C51  120000            LCALL   $REFFN DispInfoBox
   1179                  DisplayMenu("                   STOP                   ");
   \   1C54  7DE4              MOV     R5,#LOW(?0542)
   \   1C56  7E01              MOV     R6,#HIGH(?0542)
   \   1C58  7F02              MOV     R7,#2
   \   1C5A  120000            LCALL   $REFFN DisplayMenu
   1180                  SpeakerVolume(speakerVolume);
   \   1C5D  900000            MOV     DPTR,#speakerVolume
   \   1C60  E0                MOVX    A,@DPTR
   \   1C61  FC                MOV     R4,A
   \   1C62  120000            LCALL   $REFFN SpeakerVolume
   1181                  PhoneInVolume(0);
   \   1C65  7C00              MOV     R4,#0
   \   1C67  120000            LCALL   $REFFN PhoneInVolume
   1182                  PlayFile("tone.waw");
   \   1C6A  7D0F              MOV     R5,#LOW(?0543)
   \   1C6C  7E02              MOV     R6,#HIGH(?0543)
   \   1C6E  7F02              MOV     R7,#2
   \   1C70  120000            LCALL   $REFFN PlayFile
   1183                  SpeakerVolume(0);
   \   1C73  7C00              MOV     R4,#0
   \   1C75  120000            LCALL   $REFFN SpeakerVolume
   1184                  PhoneInVolume(63);
   \   1C78  7C3F              MOV     R4,#63
   \   1C7A  120000            LCALL   $REFFN PhoneInVolume
   1185                  RecMicFile(memoName);
   \   1C7D  7D00              MOV     R5,#LOW $LOCBX RecordMemo
   \   1C7F  7E00              MOV     R6,#HIGH $LOCBX RecordMemo
   \   1C81  7F01              MOV     R7,#1
   \   1C83  120000            LCALL   $REFFN RecMicFile
   \   1C86            ?0540:
   1186              }
   1187          }
   \   1C86  900000            MOV     DPTR,#$LOCBX RecordMemo+15
   \   1C89  E0                MOVX    A,@DPTR
   \   1C8A  F8                MOV     R0,A
   \   1C8B  A3                INC     DPTR
   \   1C8C  E0                MOVX    A,@DPTR
   \   1C8D  C0E0              PUSH    ACC
   \   1C8F  E8                MOV     A,R0
   \   1C90  C0E0              PUSH    ACC
   \   1C92  22                RET
   1188          
   1189          void    PlayMemo( void )
   1190          {
   \   1C93            PlayMemo:
   \   1C93  900000            MOV     DPTR,#$LOCBX PlayMemo+15
   \   1C96  D0E0              POP     ACC
   \   1C98  F0                MOVX    @DPTR,A
   \   1C99  A3                INC     DPTR
   \   1C9A  D0E0              POP     ACC
   \   1C9C  F0                MOVX    @DPTR,A
   1191              xdata char memoName[15];
   1192          
   1193              WDT = 1;
   \   1C9D  D2AE              SETB    IE.6
   1194              SWDT = 1;
   \   1C9F  D2BE              SETB    IP.6
   1195          
   1196              if ((nextMemoIndex > 0) && (nextMemoIndex < 256)) {
   \   1CA1  D3                SETB    C
   \   1CA2  900007            MOV     DPTR,#nextMemoIndex+1
   \   1CA5  E0                MOVX    A,@DPTR
   \   1CA6  9400              SUBB    A,#0
   \   1CA8  900006            MOV     DPTR,#nextMemoIndex
   \   1CAB  E0                MOVX    A,@DPTR
   \   1CAC  6480              XRL     A,#128
   \   1CAE  9480              SUBB    A,#128
   \   1CB0  405E              JC      ?0545
   \   1CB2  E0                MOVX    A,@DPTR
   \   1CB3  6480              XRL     A,#128
   \   1CB5  C3                CLR     C
   \   1CB6  9481              SUBB    A,#129
   \   1CB8  5056              JNC     ?0545
   \   1CBA            ?0547:
   \   1CBA            ?0546:
   \   1CBA            ?0544:
   1197                  CreateMemoFileName(nextMemoIndex - 1, memoName);
   \   1CBA  7401              MOV     A,#1
   \   1CBC  900000            MOV     DPTR,#$PRMBX CreateMemoFileName+2
   \   1CBF  F0                MOVX    @DPTR,A
   \   1CC0  A3                INC     DPTR
   \   1CC1  7400              MOV     A,#HIGH $LOCBX PlayMemo
   \   1CC3  F0                MOVX    @DPTR,A
   \   1CC4  A3                INC     DPTR
   \   1CC5  7400              MOV     A,#LOW $LOCBX PlayMemo
   \   1CC7  F0                MOVX    @DPTR,A
   \   1CC8  900007            MOV     DPTR,#nextMemoIndex+1
   \   1CCB  E0                MOVX    A,@DPTR
   \   1CCC  24FF              ADD     A,#255
   \   1CCE  FC                MOV     R4,A
   \   1CCF  900006            MOV     DPTR,#nextMemoIndex
   \   1CD2  E0                MOVX    A,@DPTR
   \   1CD3  34FF              ADDC    A,#255
   \   1CD5  FD                MOV     R5,A
   \   1CD6  120000            LCALL   $REFFN CreateMemoFileName
   1198                  DispInfoBox("Now playing:", memoName);
   \   1CD9  7F01              MOV     R7,#1
   \   1CDB  900000            MOV     DPTR,#$PRMBX DispInfoBox+3
   \   1CDE  EF                MOV     A,R7
   \   1CDF  F0                MOVX    @DPTR,A
   \   1CE0  A3                INC     DPTR
   \   1CE1  7400              MOV     A,#HIGH $LOCBX PlayMemo
   \   1CE3  F0                MOVX    @DPTR,A
   \   1CE4  A3                INC     DPTR
   \   1CE5  7400              MOV     A,#LOW $LOCBX PlayMemo
   \   1CE7  F0                MOVX    @DPTR,A
   \   1CE8  7D18              MOV     R5,#LOW(?0548)
   \   1CEA  7E02              MOV     R6,#HIGH(?0548)
   \   1CEC  0F                INC     R7
   \   1CED  120000            LCALL   $REFFN DispInfoBox
   1199                  SpeakerVolume(speakerVolume);
   \   1CF0  900000            MOV     DPTR,#speakerVolume
   \   1CF3  E0                MOVX    A,@DPTR
   \   1CF4  FC                MOV     R4,A
   \   1CF5  120000            LCALL   $REFFN SpeakerVolume
   1200                  PhoneInVolume(0);
   \   1CF8  7C00              MOV     R4,#0
   \   1CFA  120000            LCALL   $REFFN PhoneInVolume
   1201                  PlayFile(memoName);
   \   1CFD  7D00              MOV     R5,#LOW $LOCBX PlayMemo
   \   1CFF  7E00              MOV     R6,#HIGH $LOCBX PlayMemo
   \   1D01  7F01              MOV     R7,#1
   \   1D03  120000            LCALL   $REFFN PlayFile
   1202                  SpeakerVolume(0);
   \   1D06  7C00              MOV     R4,#0
   \   1D08  120000            LCALL   $REFFN SpeakerVolume
   1203                  PhoneInVolume(63);
   \   1D0B  7C3F              MOV     R4,#63
   \   1D0D  120000            LCALL   $REFFN PhoneInVolume
   \   1D10            ?0545:
   1204              }
   1205          }
   \   1D10  900000            MOV     DPTR,#$LOCBX PlayMemo+15
   \   1D13  E0                MOVX    A,@DPTR
   \   1D14  F8                MOV     R0,A
   \   1D15  A3                INC     DPTR
   \   1D16  E0                MOVX    A,@DPTR
   \   1D17  C0E0              PUSH    ACC
   \   1D19  E8                MOV     A,R0
   \   1D1A  C0E0              PUSH    ACC
   \   1D1C  22                RET
   1206          
   1207          
   1208          
   1209          void    CreateMemoFileName(int index, char* str)
   1210          {
   \   1D1D            CreateMemoFileName:
   \   1D1D  900000            MOV     DPTR,#$LOCBX CreateMemoFileName+8
   \   1D20  D0E0              POP     ACC
   \   1D22  F0                MOVX    @DPTR,A
   \   1D23  A3                INC     DPTR
   \   1D24  D0E0              POP     ACC
   \   1D26  F0                MOVX    @DPTR,A
   1211              xdata char  indexStr[5];
   1212              xdata char  c;
   1213              xdata int   i = 0;
   1214          
   1215              myInt2DecStr(index, indexStr);
   \   1D27  A3                INC     DPTR
   \   1D28  ED                MOV     A,R5
   \   1D29  F0                MOVX    @DPTR,A
   \   1D2A  A3                INC     DPTR
   \   1D2B  EC                MOV     A,R4
   \   1D2C  F0                MOVX    @DPTR,A
   \   1D2D  7401              MOV     A,#1
   \   1D2F  900000            MOV     DPTR,#$PRMBX myInt2DecStr+2
   \   1D32  F0                MOVX    @DPTR,A
   \   1D33  A3                INC     DPTR
   \   1D34  7400              MOV     A,#HIGH $LOCBX CreateMemoFileName
   \   1D36  F0                MOVX    @DPTR,A
   \   1D37  A3                INC     DPTR
   \   1D38  7400              MOV     A,#LOW $LOCBX CreateMemoFileName
   \   1D3A  F0                MOVX    @DPTR,A
   \   1D3B  120000            LCALL   $REFFN myInt2DecStr
   1216          
   1217              myStrCpy(str, "Memo");
   \   1D3E  7402              MOV     A,#2
   \   1D40  900000            MOV     DPTR,#$PRMBX myStrCpy+3
   \   1D43  F0                MOVX    @DPTR,A
   \   1D44  A3                INC     DPTR
   \   1D45  7402              MOV     A,#HIGH(?0549)
   \   1D47  F0                MOVX    @DPTR,A
   \   1D48  A3                INC     DPTR
   \   1D49  7425              MOV     A,#LOW(?0549)
   \   1D4B  F0                MOVX    @DPTR,A
   \   1D4C  900000            MOV     DPTR,#$LOCBX CreateMemoFileName+12
   \   1D4F  E0                MOVX    A,@DPTR
   \   1D50  FF                MOV     R7,A
   \   1D51  A3                INC     DPTR
   \   1D52  E0                MOVX    A,@DPTR
   \   1D53  FE                MOV     R6,A
   \   1D54  A3                INC     DPTR
   \   1D55  E0                MOVX    A,@DPTR
   \   1D56  FD                MOV     R5,A
   \   1D57  120000            LCALL   $REFFN myStrCpy
   1218              str = str + 4;
   \   1D5A  900000            MOV     DPTR,#$LOCBX CreateMemoFileName+14
   \   1D5D  E0                MOVX    A,@DPTR
   \   1D5E  2404              ADD     A,#4
   \   1D60  F0                MOVX    @DPTR,A
   \   1D61  900000            MOV     DPTR,#$LOCBX CreateMemoFileName+13
   \   1D64  E0                MOVX    A,@DPTR
   \   1D65  3400              ADDC    A,#0
   \   1D67  F0                MOVX    @DPTR,A
   \   1D68  900000            MOV     DPTR,#$LOCBX CreateMemoFileName+6
   \   1D6B  E4                CLR     A
   \   1D6C  F0                MOVX    @DPTR,A
   \   1D6D  A3                INC     DPTR
   \   1D6E  F0                MOVX    @DPTR,A
   \   1D6F            ?0552:
   1219              
   1220              do {
   1221                  c = indexStr[i++];
   \   1D6F  900000            MOV     DPTR,#$LOCBX CreateMemoFileName+6
   \   1D72  E0                MOVX    A,@DPTR
   \   1D73  FD                MOV     R5,A
   \   1D74  A3                INC     DPTR
   \   1D75  E0                MOVX    A,@DPTR
   \   1D76  FC                MOV     R4,A
   \   1D77  E0                MOVX    A,@DPTR
   \   1D78  04                INC     A
   \   1D79  F0                MOVX    @DPTR,A
   \   1D7A  900000            MOV     DPTR,#$LOCBX CreateMemoFileName+6
   \   1D7D  7003              JNZ     ?0575
   \   1D7F  E0                MOVX    A,@DPTR
   \   1D80  04                INC     A
   \   1D81  F0                MOVX    @DPTR,A
   \   1D82            ?0575:
   \   1D82  EC                MOV     A,R4
   \   1D83  2400              ADD     A,#LOW $LOCBX CreateMemoFileName
   \   1D85  F582              MOV     DPL,A
   \   1D87  E4                CLR     A
   \   1D88  3400              ADDC    A,#HIGH $LOCBX CreateMemoFileName
   \   1D8A  F583              MOV     DPH,A
   \   1D8C  E0                MOVX    A,@DPTR
   1222                  *(str++) = c;
   \   1D8D  FC                MOV     R4,A
   \   1D8E  900000            MOV     DPTR,#$LOCBX CreateMemoFileName+12
   \   1D91  E0                MOVX    A,@DPTR
   \   1D92  FF                MOV     R7,A
   \   1D93  A3                INC     DPTR
   \   1D94  E0                MOVX    A,@DPTR
   \   1D95  FE                MOV     R6,A
   \   1D96  C083              PUSH    DPH
   \   1D98  A3                INC     DPTR
   \   1D99  E0                MOVX    A,@DPTR
   \   1D9A  FD                MOV     R5,A
   \   1D9B  04                INC     A
   \   1D9C  F0                MOVX    @DPTR,A
   \   1D9D  1582              DEC     DPL
   \   1D9F  D083              POP     DPH
   \   1DA1  7003              JNZ     ?0576
   \   1DA3  EE                MOV     A,R6
   \   1DA4  04                INC     A
   \   1DA5  F0                MOVX    @DPTR,A
   \   1DA6            ?0576:
   \   1DA6  EC                MOV     A,R4
   \   1DA7  120000            LCALL   ?ST_A_R567_L17
   1223              } while (c != 0);
   \   1DAA  900000            MOV     DPTR,#$LOCBX CreateMemoFileName+5
   \   1DAD  F0                MOVX    @DPTR,A
   \   1DAE  70BF              JNZ     ?0552
   \   1DB0            ?0550:
   1224              *(str-1) = '.';
   \   1DB0  900000            MOV     DPTR,#$LOCBX CreateMemoFileName+12
   \   1DB3  E0                MOVX    A,@DPTR
   \   1DB4  FF                MOV     R7,A
   \   1DB5  A3                INC     DPTR
   \   1DB6  E0                MOVX    A,@DPTR
   \   1DB7  FE                MOV     R6,A
   \   1DB8  A3                INC     DPTR
   \   1DB9  E0                MOVX    A,@DPTR
   \   1DBA  FD                MOV     R5,A
   \   1DBB  742E              MOV     A,#46
   \   1DBD  90FFFF            MOV     DPTR,#65535
   \   1DC0  120000            LCALL   ?ST_A_R567_DISP_L17
   1225              *(str++) = 'W';
   \   1DC3  120000            LCALL   ?PINC1_R567_TO_R123_L20
   \   1DC6  7457              MOV     A,#87
   \   1DC8  120000            LCALL   ?ST_A_R123_L17
   1226              *(str++) = 'A';
   \   1DCB  120000            LCALL   ?PINC1_R567_TO_R123_L20
   \   1DCE  7441              MOV     A,#65
   \   1DD0  120000            LCALL   ?ST_A_R123_L17
   1227              *(str++) = 'W';
   \   1DD3  120000            LCALL   ?PINC1_R567_TO_R123_L20
   \   1DD6  7457              MOV     A,#87
   \   1DD8  120000            LCALL   ?ST_A_R123_L17
   1228              *(str++) = 0;
   1229          }    
   \   1DDB  120000            LCALL   ?PINC1_R567_TO_R123_L20
   \   1DDE  900000            MOV     DPTR,#$LOCBX CreateMemoFileName+12
   \   1DE1  EF                MOV     A,R7
   \   1DE2  F0                MOVX    @DPTR,A
   \   1DE3  A3                INC     DPTR
   \   1DE4  EE                MOV     A,R6
   \   1DE5  F0                MOVX    @DPTR,A
   \   1DE6  A3                INC     DPTR
   \   1DE7  ED                MOV     A,R5
   \   1DE8  F0                MOVX    @DPTR,A
   \   1DE9  E4                CLR     A
   \   1DEA  120000            LCALL   ?ST_A_R123_L17
   \   1DED  900000            MOV     DPTR,#$LOCBX CreateMemoFileName+8
   \   1DF0  E0                MOVX    A,@DPTR
   \   1DF1  F8                MOV     R0,A
   \   1DF2  A3                INC     DPTR
   \   1DF3  E0                MOVX    A,@DPTR
   \   1DF4  C0E0              PUSH    ACC
   \   1DF6  E8                MOV     A,R0
   \   1DF7  C0E0              PUSH    ACC
   \   1DF9  22                RET
   1230          
   1231          
   1232          
   1233          
   1234          
   1235           
   1236           
   1237           
   1238           
   1239           
   1240           
   1241           
   1242           
   \   0000                    RSEG    CSTR
   \   0000            ?0000:
   \   0000  496E6974          DB      'Init waitcall...',0
   \   0004  20776169
   \   0008  7463616C
   \   000C  6C2E2E2E
   \   0010  00
   \   0011            ?0001:
   \   0011  496E6974          DB      'Initializing answering machine',0
   \   0015  69616C69
   \   0019  7A696E67
   \   001D  20616E73
   \   0021  77657269
   \   0025  6E67206D
   \   0029  61636869
   \   002D  6E6500
   \   0030            ?0002:
   \   0030  506C6561          DB      'Please wait...',0
   \   0034  73652077
   \   0038  6169742E
   \   003C  2E2E00
   \   003F            ?0011:
   \   003F  496E6974          DB      'Init waitcall done',0
   \   0043  20776169
   \   0047  7463616C
   \   004B  6C20646F
   \   004F  6E6500
   \   0052            ?0012:
   \   0052  2020504C          DB      '  PLAY     UP     DOWN    MENU   PLAY NEW',0
   \   0056  41592020
   \   005A  20202055
   \   005E  50202020
   \   0062  2020444F
   \   0066  574E2020
   \   006A  20204D45
   \   006E  4E552020
   \   0072  20504C41
   \   0076  59204E45
   \   007A  5700
   \   007C            ?0041:
   \   007C  20204E45          DB      '  NEXT     UP     DOWN    BACK',0
   \   0080  58542020
   \   0084  20202055
   \   0088  50202020
   \   008C  2020444F
   \   0090  574E2020
   \   0094  20204241
   \   0098  434B00
   \   009B            ?0056:
   \   009B  20204E45          DB      '  NEXT   SELECT           BACK',0
   \   009F  58542020
   \   00A3  2053454C
   \   00A7  45435420
   \   00AB  20202020
   \   00AF  20202020
   \   00B3  20204241
   \   00B7  434B00
   \   00BA            ?0070:
   \   00BA  2020504C          DB      '  PLAY   RECORD            BACK',0
   \   00BE  41592020
   \   00C2  20524543
   \   00C6  4F524420
   \   00CA  20202020
   \   00CE  20202020
   \   00D2  20202042
   \   00D6  41434B00
   \   00DA            ?0074:
   \   00DA  20204E45          DB      '  NEXT    UP      DOWN      DONE   CANCEL',0
   \   00DE  58542020
   \   00E2  20205550
   \   00E6  20202020
   \   00EA  2020444F
   \   00EE  574E2020
   \   00F2  20202020
   \   00F6  444F4E45
   \   00FA  20202043
   \   00FE  414E4345
   \   0102  4C00
   \   0104            ?0170:
   \   0104  45726173          DB      'Erasing messages',0
   \   0108  696E6720
   \   010C  6D657373
   \   0110  61676573
   \   0114  00
   \   0115            ?0171:
   \   0115  4C6F672E          DB      'Log.txt',0
   \   0119  74787400
   \   011D            ?0172:
   \   011D  7200              DB      'r',0
   \   011F            ?0208:
   \   011F  4E6F7720          DB      'Now calling:',0
   \   0123  63616C6C
   \   0127  696E673A
   \   012B  00
   \   012C            ?0212:
   \   012C  4E574300          DB      'NWC',0
   \   0130            ?0213:
   \   0130  54494D00          DB      'TIM',0
   \   0134            ?0216:
   \   0134  44534300          DB      'DSC',0
   \   0138            ?0245:
   \   0138  52434D00          DB      'RCM',0
   \   013C            ?0248:
   \   013C  44544D00          DB      'DTM',0
   \   0140            ?0265:
   \   0140  44544D20          DB      'DTM 0',0
   \   0144  3000
   \   0146            ?0271:
   \   0146  44544D20          DB      'DTM 1',0
   \   014A  3100
   \   014C            ?0277:
   \   014C  44544D20          DB      'DTM 2',0
   \   0150  3200
   \   0152            ?0283:
   \   0152  44544D20          DB      'DTM 3',0
   \   0156  3300
   \   0158            ?0289:
   \   0158  44544D20          DB      'DTM 4',0
   \   015C  3400
   \   015E            ?0295:
   \   015E  44544D20          DB      'DTM 5',0
   \   0162  3500
   \   0164            ?0301:
   \   0164  44544D20          DB      'DTM 6',0
   \   0168  3600
   \   016A            ?0307:
   \   016A  44544D20          DB      'DTM 7',0
   \   016E  3700
   \   0170            ?0313:
   \   0170  44544D20          DB      'DTM 8',0
   \   0174  3800
   \   0176            ?0319:
   \   0176  44544D20          DB      'DTM 9',0
   \   017A  3900
   \   017C            ?0325:
   \   017C  44544D20          DB      'DTM *',0
   \   0180  2A00
   \   0182            ?0331:
   \   0182  44544D20          DB      'DTM #',0
   \   0186  2300
   \   0188            ?0345:
   \   0188  51756573          DB      'Quest timed out',0
   \   018C  74207469
   \   0190  6D656420
   \   0194  6F757400
   \   0198            ?0368:
   \   0198  434F4B00          DB      'COK',0
   \   019C            ?0372:
   \   019C  434E4F00          DB      'CNO',0
   \   01A0            ?0472:
   \   01A0  52656164          DB      'Reading Phone book file...',0
   \   01A4  696E6720
   \   01A8  50686F6E
   \   01AC  6520626F
   \   01B0  6F6B2066
   \   01B4  696C652E
   \   01B8  2E2E00
   \   01BB            ?0473:
   \   01BB  52656164          DB      'Reading Phone Book',0
   \   01BF  696E6720
   \   01C3  50686F6E
   \   01C7  6520426F
   \   01CB  6F6B00
   \   01CE            ?0474:
   \   01CE  50422E74          DB      'PB.tpb',0
   \   01D2  706200
   \   01D5            ?0541:
   \   01D5  4E6F7720          DB      'Now recording:',0
   \   01D9  7265636F
   \   01DD  7264696E
   \   01E1  673A00
   \   01E4            ?0542:
   \   01E4  20202020          DB      '                   STOP                   ',0
   \   01E8  20202020
   \   01EC  20202020
   \   01F0  20202020
   \   01F4  20202053
   \   01F8  544F5020
   \   01FC  20202020
   \   0200  20202020
   \   0204  20202020
   \   0208  20202020
   \   020C  202000
   \   020F            ?0543:
   \   020F  746F6E65          DB      'tone.waw',0
   \   0213  2E776177
   \   0217  00
   \   0218            ?0548:
   \   0218  4E6F7720          DB      'Now playing:',0
   \   021C  706C6179
   \   0220  696E673A
   \   0224  00
   \   0225            ?0549:
   \   0225  4D656D6F          DB      'Memo',0
   \   0229  00
   \   0000                    RSEG    X_UDATA
   \   0000            answerOn:
   \   0001                    DS      1
   \   0001            numOfCalls:
   \   0003                    DS      2
   \   0003            lastPlayed:
   \   0005                    DS      2
   \   0005            callerCategory:
   \   0006                    DS      1
   \   0006            nextMemoIndex:
   \   0008                    DS      2
   \   0008            labDTMF:
   \   0010                    DS      8
   \   0010            lab0:
   \   0018                    DS      8
   \   0018            lab1:
   \   0020                    DS      8
   \   0020            lab2:
   \   0028                    DS      8
   \   0028            lab3:
   \   0030                    DS      8
   \   0030            lab4:
   \   0038                    DS      8
   \   0038            lab5:
   \   0040                    DS      8
   \   0040            lab6:
   \   0048                    DS      8
   \   0048            lab7:
   \   0050                    DS      8
   \   0050            lab8:
   \   0058                    DS      8
   \   0058            lab9:
   \   0060                    DS      8
   \   0060            labPound:
   \   0068                    DS      8
   \   0068            labStar:
   \   0070                    DS      8
   \   0070            labCorrectc:
   \   0078                    DS      8
   \   0078            labIncorrectc:
   \   0080                    DS      8
   \   0080            labTimeout:
   \   0088                    DS      8
   \   0088            labHungUp:
   \   0090                    DS      8
   \   0090            timeoutValue:
   \   0092                    DS      2
   \   0092            cursor:
   \   0094                    DS      2
   \   0094            menuSelection:
   \   0095                    DS      1
   \   0095            numSignals:
   \   0096                    DS      1
   \   0096            dateNow:
   \   009A                    DS      4
   \   009A            year:
   \   009B                    DS      1
   \   009B            month:
   \   009C                    DS      1
   \   009C            date:
   \   009D                    DS      1
   \   009D            timeNow:
   \   00A0                    DS      3
   \   00A0            hour:
   \   00A1                    DS      1
   \   00A1            minute:
   \   00A2                    DS      1
   \   00A2            timCur:
   \   00A3                    DS      1
   \   00A3            PBSpace:
   \   40A3                    DS      16384
   \   40A3            pbNEntries:
   \   40A5                    DS      2
   \   40A5            callerName:
   \   40B9                    DS      20
   \   40B9                    END


                                       S Y M B O L - T A B L E
                                       =======================


            #include file(s):

       [1]       c:\iar\ew\8051\inc\io517a.h
       [2]       c:\iar\ew\8051\inc\stdio.h
       [3]       c:\iar\ew\8051\inc\stdlib.h
       [4]       c:\iar\ew\8051\inc\string.h
       [5]       phoneans.h
       [6]       main.h
       [7]       filesystem.h
       [8]       calender.h
       [9]       calender.h
      [10]       main.h
      [11]       filesystem.h
      [12]       errorcodes.h
      [13]       rs232.h
      [14]       wav.h
      [15]       dtmf.h
      [16]       phone.h
      [17]       timer.h
      [18]       dpot.h
      [19]       lcd.h
      [20]       logfile.h
      [21]       filesystem.h
      [22]       keyboard.h


            Symbol                     Type     Mem     Class   Defline   Refline(s)
            ------                     ----     ---     -----   -------   ----------

?0000                                 array    code    static      185        185
?0001                                 array    code    static      187        187      455
?0002                                 array    code    static      187        187      439      455     1033
?0011                                 array    code    static      221        221
?0012                                 array    code    static      232        232      357      474
?0041                                 array    code    static      270        270      287
?0056                                 array    code    static      291        291      429      434      451
                                                                              480      485      502
?0070                                 array    code    static      309        309      492      497
?0074                                 array    code    static      321        321
?0170                                 array    code    static      439        439
?0171                                 array    code    static      445        445
?0172                                 array    code    static      445        445     1012     1037     1157
?0208                                 array    code    static      580        580
?0212                                 array    code    static      586        586
?0213                                 array    code    static      587        587
?0216                                 array    code    static      590        590
?0245                                 array    code    static      645        645
?0248                                 array    code    static      652        652      743
?0265                                 array    code    static      707        707
?0271                                 array    code    static      710        710
?0277                                 array    code    static      713        713
?0283                                 array    code    static      716        716
?0289                                 array    code    static      719        719
?0295                                 array    code    static      722        722
?0301                                 array    code    static      725        725
?0307                                 array    code    static      728        728
?0313                                 array    code    static      731        731
?0319                                 array    code    static      734        734
?0325                                 array    code    static      737        737
?0331                                 array    code    static      740        740
?0345                                 array    code    static      756        756
?0368                                 array    code    static      835        835
?0372                                 array    code    static      842        842      853
?0472                                 array    code    static     1032       1032
?0473                                 array    code    static     1033       1033
?0474                                 array    code    static     1037       1037
?0541                                 array    code    static     1178       1178
?0542                                 array    code    static     1179       1179
?0543                                 array    code    static     1182       1182
?0548                                 array    code    static     1198       1198
?0549                                 array    code    static     1217       1217
AC                                      bit             ---      166:1  
ACC                                     sfr             ---       14:1  
ADCON0                                  sfr             ---       99:1  
ADCON1                                  sfr             ---      100:1  
ADDATH                                  sfr             ---      101:1  
ADDATL                                  sfr             ---      102:1  
ADEX                                    bit             ---      133:1  
ADM                                     bit             ---      135:1  
ARCON                                   sfr             ---      105:1  
AskQuestionMsg                     function    code    public      680       50:5
B                                       sfr             ---       15:1  
BD                                      bit             ---      131:1  
BSY                                     bit             ---      134:1  
BuildCallerList                    function    code    extern    44:20        189      457
CC4EN                                   sfr             ---       34:1  
CCEN                                    sfr             ---       33:1  
CCH1                                    sfr             ---       36:1  
CCH2                                    sfr             ---       38:1  
CCH3                                    sfr             ---       40:1  
CCH4                                    sfr             ---       42:1  
CCL1                                    sfr             ---       35:1  
CCL2                                    sfr             ---       37:1  
CCL3                                    sfr             ---       39:1  
CCL4                                    sfr             ---       41:1  
CLK                                     bit             ---      132:1  
CLRMSK                                  sfr             ---       74:1  
CMEN                                    sfr             ---       43:1  
CMH0                                    sfr             ---       45:1  
CMH1                                    sfr             ---       47:1  
CMH2                                    sfr             ---       49:1  
CMH3                                    sfr             ---       51:1  
CMH4                                    sfr             ---       53:1  
CMH5                                    sfr             ---       55:1  
CMH6                                    sfr             ---       57:1  
CMH7                                    sfr             ---       59:1  
CML0                                    sfr             ---       44:1  
CML1                                    sfr             ---       46:1  
CML2                                    sfr             ---       48:1  
CML3                                    sfr             ---       50:1  
CML4                                    sfr             ---       52:1  
CML5                                    sfr             ---       54:1  
CML6                                    sfr             ---       56:1  
CML7                                    sfr             ---       58:1  
CMSEL                                   sfr             ---       60:1  
COMCLRH                                 sfr             ---       72:1  
COMCLRL                                 sfr             ---       71:1  
COMSETH                                 sfr             ---       70:1  
COMSETL                                 sfr             ---       69:1  
CRCH                                    sfr             ---       62:1  
CRCL                                    sfr             ---       61:1  
CTCON                                   sfr             ---       63:1  
CTRELH                                  sfr             ---       65:1  
CTRELL                                  sfr             ---       64:1  
CY                                      bit             ---      165:1  
CategoryHit                        function    code    public     1092       63:5
ClearDisp                          function    code    extern    66:19        186      226      468
CorrectDate                        function    code    public      602        370      375      379      394
                                                                              399      403     48:5
CreateDateString2                  function    code    extern     74:8        557
CreateLog                          function    code    extern    42:20        200      453
CreateMemoFileName                 function    code    public     1210       1156     1177     1197     62:5
CreateTimeString                   function    code    extern     72:8        565
CreateUniqueFilename               function    code    public      968        638     54:5
DPH                                     sfr             ---       18:1  
DPL                                     sfr             ---       17:1  
DPSEL                                   sfr             ---       19:1  
DecodeReceivedDTMF                 function    code    extern    46:15        516      704      796
DispEraseQuest                     function    code    extern    78:19        332
DispInfoBox                        function    code    extern    71:19        187      439      455      580
                                                                             1033     1178     1198
DispMemUsage                       function    code    extern    73:19        231      473      496
DispMemoScreen                     function    code    extern    79:19        308      491      495
DispOptionsMenu                    function    code    extern    75:19        267      304      328      338
                                                                              353      427      432      449
                                                                              478      483      500
DispSetTimeDate                    function    code    extern    76:19        322      365      371      376
                                                                              380      384      388      395
                                                                              400      404      408      412
DispSetTimeDateHead                function    code    extern    77:19        320
DisplayMenu                        function    code    extern    72:19        232      270      287      291
                                                                              309      321      357      429
                                                                              434      451      474      480
                                                                              485      492      497      502
                                                                             1179
EADC                                    bit             ---      205:1  
EAL                                     bit             ---      187:1  
ES0                                     bit             ---      190:1  
ET0                                     bit             ---      193:1  
ET1                                     bit             ---      191:1  
ET2                                     bit             ---      189:1  
EX0                                     bit             ---      194:1  
EX1                                     bit             ---      192:1  
EX2                                     bit             ---      204:1  
EX3                                     bit             ---      203:1  
EX4                                     bit             ---      202:1  
EX5                                     bit             ---      201:1  
EX6                                     bit             ---      200:1  
EXEN2                                   bit             ---      198:1  
EXF2                                    bit             ---      143:1  
EnterCode                          function    code    public      777       51:5
EraseDynamic                       function    code    extern    111:7        440
F0                                      bit             ---      167:1  
F1                                      bit             ---      171:1  
FillDispBuffer                     function    code    extern    70:19        227      279      469
GetDateNow                         function    code    extern     71:8        312      556      976
GetNextDTMF                        function    code    extern    48:15        531      817
GetTimeNow                         function    code    extern     70:8        316      563      975
GotoLabel                          function    code    extern    122:6        592      596      656      660
                                                                              706      709      712      715
                                                                              718      721      724      727
                                                                              730      733      736      739
                                                                              742      750      757      834
                                                                              841      848      852      857
I2FR                                    bit             ---      156:1  
I3FR                                    bit             ---      155:1  
IADC                                    bit             ---      150:1  
IE0                                     bit             ---      182:1  
IE1                                     bit             ---      180:1  
IEN0                                    sfr             ---      114:1  
IEN1                                    sfr             ---      116:1  
IEN2                                    sfr             ---      118:1  
IEX2                                    bit             ---      149:1  
IEX3                                    bit             ---      148:1  
IEX4                                    bit             ---      147:1  
IEX5                                    bit             ---      146:1  
IEX6                                    bit             ---      145:1  
INT0                                    bit             ---      214:1  
INT1                                    bit             ---      213:1  
IP0                                     sfr             ---      115:1  
IP1                                     sfr             ---      117:1  
IRCON0                                  sfr             ---      119:1  
IRCON1                                  sfr             ---      120:1  
IT0                                     bit             ---      183:1  
IT1                                     bit             ---      181:1  
InitializePhoneAns                 function    code    public      153       46:5
IntitializeMemo                    function    code    public     1146       59:5
KeyboardOn                         function    code    extern    53:22        206
KillTimer                          function    code    extern    38:17        521      762      861
LabelCopy                          function    code    public      935        893      895      897      899
                                                                              901      903      905      907
                                                                              909      911      913      915
                                                                              917      919      921      923
                                                                              925     53:5
LogCursorAt                        function    code    extern    69:19        230      254      258      263
                                                                              280      356      472
LogMessage                         function    code    extern    43:20        586      587      590      645
                                                                              652      707      710      713
                                                                              716      719      722      725
                                                                              728      731      734      737
                                                                              740      743      835      842
                                                                              853
LookUpCaller                       function    code    public     1058        544     58:5
MD0                                     sfr             ---      106:1  
MD1                                     sfr             ---      107:1  
MD2                                     sfr             ---      108:1  
MD3                                     sfr             ---      109:1  
MD4                                     sfr             ---      110:1  
MD5                                     sfr             ---      111:1  
MS_ERASEQST                         #define             ---      32:20      32:20
MS_LOG                              #define             ---      29:20      29:20
MS_MENU                             #define             ---      30:20      30:20
MS_TIMEDATE                         #define             ---      31:20      31:20
MX0                                     bit             ---      138:1  
MX1                                     bit             ---      137:1  
MX2                                     bit             ---      136:1  
OV                                      bit             ---      170:1  
OptionCursorAt                     function    code    extern    74:19        269      293      305      329
                                                                              339      354      428      433
                                                                              450      479      484      501
P                                       bit             ---      172:1  
P0                                      sfr             ---       77:1  
P1                                      sfr             ---       78:1  
P2                                      sfr             ---       79:1  
P3                                      sfr             ---       80:1        209      210      298      301
P4                                      sfr             ---       81:1  
P5                                      sfr             ---       82:1  
P6                                      sfr             ---       83:1  
P7                                      sfr             ---       84:1  
P8                                      sfr             ---       85:1  
PBSpace                               array   xdata    public      143       1035     1066
PCON                                    sfr             ---       88:1  
PSW                                     sfr             ---       20:1  
PhoneInVolume                      function    code    extern    66:18        183     1181     1184     1200
                                                                             1203
PlayFile                           function    code    extern    52:14        689      787     1182     1201
PlayMemo                           function    code    public     1190        490     61:5
PlayNewMessages                    function    code    extern    49:20        272
PlayThisCall                       function    code    extern    48:20        251
RB80                                    bit             ---      225:1  
RD                                      bit             ---      209:1  
REN0                                    bit             ---      223:1  
RI0                                     bit             ---      227:1  
RS0                                     bit             ---      169:1  
RS1                                     bit             ---      168:1  
RXD                                     bit             ---      216:1  
ReadCalenderByte                   function    code    extern     69:8        190      192      208      211
                                                                              213      458      460      577
ReadPhoneBookFile                  function    code    public     1027        157     57:5
RecMicFile                         function    code    extern    49:14       1185
RecPhoneFile                       function    code    extern    50:14        643
RecordCallerMessage                function    code    public      631       49:5
RecordMemo                         function    code    public     1171        494     60:5
ResetDTMFIndex                     function    code    extern    47:15        236      253      278      790
S0BUF                                   sfr             ---       90:1  
S0CON                                   sfr             ---       89:1  
S0RELH                                  sfr             ---       94:1  
S0RELL                                  sfr             ---       93:1  
S1BUF                                   sfr             ---       92:1  
S1CON                                   sfr             ---       91:1  
S1RELH                                  sfr             ---       96:1  
S1RELL                                  sfr             ---       95:1  
SETMSK                                  sfr             ---       73:1  
SM0                                     bit             ---      220:1  
SM1                                     bit             ---      221:1  
SM20                                    bit             ---      222:1  
SP                                      sfr             ---       16:1  
SWDT                                    bit             ---      199:1        242      246      518      534
                                                                              547      554      561      568
                                                                              635      641      649      665
                                                                              702      807      820     1047
                                                                             1070     1110     1155     1175
                                                                             1194
SYSCON                                  sfr             ---       22:1  
SendRS232                          function    code    extern    36:13        801
SendStringEOLRS232                 function    code    extern    38:13        185      221      756     1032
SetupUpQLabels                     function    code    public      866        204      637      687      785
                                                                             52:5
SpeakerVolume                      function    code    extern    65:18       1180     1183     1199     1202
StartTimer                         function    code    extern    37:17        513      698      793
T0                                      bit             ---      212:1  
T1                                      bit             ---      211:1  
T2CM                                    bit             ---      159:1  
T2CON                                   sfr             ---       68:1  
T2I0                                    bit             ---      161:1  
T2I1                                    bit             ---      160:1  
T2PS                                    bit             ---      154:1  
T2R0                                    bit             ---      158:1  
T2R1                                    bit             ---      157:1  
TB80                                    bit             ---      224:1  
TCON                                    sfr             ---       25:1  
TF0                                     bit             ---      178:1  
TF1                                     bit             ---      176:1  
TF2                                     bit             ---      144:1  
TH0                                     sfr             ---       29:1  
TH1                                     sfr             ---       30:1  
TH2                                     sfr             ---       67:1  
TI0                                     bit             ---      226:1  
TL0                                     sfr             ---       27:1  
TL1                                     sfr             ---       28:1  
TL2                                     sfr             ---       66:1  
TMOD                                    sfr             ---       26:1  
TR0                                     bit             ---      179:1  
TR1                                     bit             ---      177:1  
TXD                                     bit             ---      215:1  
TimedOut                           function    code    extern    39:17        519      754      803
WDT                                     bit             ---      188:1        241      245      517      533
                                                                              546      553      560      567
                                                                              634      640      648      664
                                                                              701      806      819     1046
                                                                             1069     1109     1154     1174
                                                                             1193
WDTREL                                  sfr             ---      124:1  
WR                                      bit             ---      210:1  
WaitForCall                        function    code    public      170       47:5
WaitForRingSignals                 function    code    extern    89:16        584
WriteCalenderByte                  function    code    extern     68:8        197      198      199      274
                                                                              275      276      303      326
                                                                              336      345      350      417
                                                                              419      421      423      425
                                                                              426      441      442      578
                                                                              646
XPAGE                                   sfr             ---       21:1  
abort                              function    code    extern     92:3        682      778
answerOn                               char   xdata    public      103        208      209      267      296
                                                                              297      300      303      304
                                                                              328      338      353      427
                                                                              432      449      478      483
                                                                              500      582
callIndex                             array   xdata    extern       92        551
callerCategory                         char   xdata    public      107        543      544
callerName                            array   xdata    public      145        544      580      586
commandLine                           array   xdata    extern       96        689      787      791      889
cursor                                  int   xdata    public      132        229      251      254      256
                                                                              257      258      261      262
                                                                              263      280      356      471
date                                   char   xdata    public      138        315      322      365      371
                                                                              376      378      380      384
                                                                              388      395      400      402
                                                                              404      408      412      420
                                                                              421      614      614      615
                                                                              616      617
dateNow                              struct   xdata    public      135        177
div_t                                struct           typedef     38:3       96:3
error                                   int   xdata    extern      101       1019     1019
fclose                             function    code    extern    104:7        447     1013     1050     1160
fgetc                              function    code    extern    101:7       1040     1042     1048
fopen                              function    code    extern     96:7        445     1012     1037     1157
hour                                   char   xdata    public      140        317      322      365      371
                                                                              376      380      382      383
                                                                              383      384      388      395
                                                                              400      404      406      406
                                                                              407      408      412      422
                                                                              423
lab0                                  array   xdata    public      114        705      706      871      893
lab1                                  array   xdata    public      115        708      709      872      895
lab2                                  array   xdata    public      116        711      712      873      897
lab3                                  array   xdata    public      117        714      715      874      899
lab4                                  array   xdata    public      118        717      718      875      901
lab5                                  array   xdata    public      119        720      721      876      903
lab6                                  array   xdata    public      120        723      724      877      905
lab7                                  array   xdata    public      121        726      727      878      907
lab8                                  array   xdata    public      122        729      730      879      909
lab9                                  array   xdata    public      123        732      733      880      911
labCorrectc                           array   xdata    public      126        833      834      883      917
labDTMF                               array   xdata    public      113        655      656      741      742
                                                                              870      925
labHungUp                             array   xdata    public      129        659      660      749      750
                                                                              856      857      886      923
labIncorrectc                         array   xdata    public      127        840      841      851      852
                                                                              884      919
labPound                              array   xdata    public      124        738      739      882      915
labStar                               array   xdata    public      125        595      596      735      736
                                                                              881      913
labTimeout                            array   xdata    public      128        591      592      755      757
                                                                              846      848      885      921
lastKey                                char   xdata    extern       90        244      250      255      260
                                                                              265      271      284      294
                                                                              341      355      362      366
                                                                              390      414      430      438
                                                                              481      489      493      498
                                                                              507
lastPlayed                              int   xdata    public      105        191      193      194      194
                                                                              196      273      274      275
                                                                              443      459      461      462
                                                                              462
ldiv_t                               struct           typedef     44:3      100:3
logOffset                              long   xdata    extern       91        550
menuSelection                          char   xdata    public      133        223      268      269      285
                                                                              286      287      288      289
                                                                              290      291      292      292
                                                                              293      295      305      306
                                                                              310      323      329      330
                                                                              333      339      342      347
                                                                              354      428      433      450
                                                                              465      479      484      501
minute                                 char   xdata    public      141        318      322      365      371
                                                                              376      380      384      386
                                                                              387      387      388      395
                                                                              400      404      408      410
                                                                              410      411      412      424
                                                                              425
month                                  char   xdata    public      137        314      322      365      371
                                                                              373      374      374      376
                                                                              380      384      388      395
                                                                              397      398      398      400
                                                                              404      408      412      418
                                                                              419      605      605      605
                                                                              605      605      605      605
                                                                              606      606      606      606
msg                                   array   xdata    extern       95        557      558      570      571
                                                                              572      573      574      575
                                                                              587
myInt2DecStr                       function    code    extern    127:6       1215
myStr2Int                          function    code    extern    129:6        928     1115     1120     1125
myStrCmpNoCase                     function    code    extern    130:6        830
myStrCpy                           function    code    extern    124:6       1217
nextMemoIndex                           int   xdata    public      108        444     1151     1153     1156
                                                                             1159     1176     1177     1196
                                                                             1196     1197
nrCommandParameters                     int   xdata    extern       99        888
numOfCalls                              int   xdata    public      104        251      261      273      551
numSignals                             char   xdata    public      134        211      267      304      324
                                                                              325      326      328      338
                                                                              343      344      345      353
                                                                              427      432      449      478
                                                                              483      500      582
pbNEntries                              int   xdata    public      144       1041     1043     1044     1044
                                                                             1045     1052     1065
receivedDTMF                           char   xdata    extern       86        235      238      244      252
                                                                              277      651      653      703
                                                                              746      789      799
speakerVolume                          char   xdata    extern       85        213      334      335      336
                                                                              348      349      350     1180
                                                                             1199
strcpy                             function    code intrinsic     66:4       1081
terminateAnswer                        char   xdata    extern       84        202      658      747      805
timCur                                 char   xdata    public      142        319      322      363      364
                                                                              364      365      367      371
                                                                              372      376      377      380
                                                                              381      384      385      388
                                                                              391      395      396      400
                                                                              401      404      405      408
                                                                              409      412
timeNow                              struct   xdata    public      139        178
timeoutValue                          u_int   xdata    public      130        693      928
year                                   char   xdata    public      136        313      322      365      368
                                                                              369      369      371      376
                                                                              380      384      388      392
                                                                              392      393      395      400
                                                                              404      408      412      416
                                                                              417      608      608


Errors: none
Warnings: none
Code size: 7674
Constant size: 554
Static variable size: Data(0) Idata(0) Bit(0) Xdata(16569) Pdata(0) Bdata(0)

